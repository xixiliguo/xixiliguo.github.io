<!DOCTYPE html>
<html lang="en-US">
  <head>
    <link rel="icon" type="image/jpg" href="/img/coast.jpg"><title>使用Bandersnatch搭建私有Pypi源 | xixiliguo</title><meta name="description" content="stay hungry stay foolish"><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="generator" content="VuePress 2.0.0-beta.22">
    <link rel="preload" href="/assets/js/runtime~app.443127ae.js" as="script"><link rel="preload" href="/assets/css/styles.d5a7f181.css" as="style"><link rel="preload" href="/assets/js/838.91c535db.js" as="script"><link rel="preload" href="/assets/js/app.1ace75fc.js" as="script">
    <link rel="stylesheet" href="/assets/css/styles.d5a7f181.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><header class="navbar"><div class="toggle-sidebar-button"><svg class="icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><span><a href="/" class=""><!----><span class="site-name">xixiliguo</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><a href="/linux/atop.md" class="nav-link" aria-label="Linux运维"><!--[--><!--]--> Linux运维 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/network/tcpdump-wireshark.md" class="nav-link" aria-label="网络协议"><!--[--><!--]--> 网络协议 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/golang/golang-exec.md" class="nav-link" aria-label="Golang笔记"><!--[--><!--]--> Golang笔记 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/k8s/runc.md" class="nav-link" aria-label="容器与k8s"><!--[--><!--]--> 容器与k8s <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/algorithm/radix-tree.md" class="nav-link" aria-label="算法笔记"><!--[--><!--]--> 算法笔记 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/kernel/linux-trap.md" class="nav-link" aria-label="内核分析"><!--[--><!--]--> 内核分析 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/others/lua-implemention-gc.md" class="nav-link" aria-label="杂项"><!--[--><!--]--> 杂项 <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><div id="docsearch-container"></div></div></header><div class="sidebar-mask"></div><aside class="sidebar"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><a href="/linux/atop.md" class="nav-link" aria-label="Linux运维"><!--[--><!--]--> Linux运维 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/network/tcpdump-wireshark.md" class="nav-link" aria-label="网络协议"><!--[--><!--]--> 网络协议 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/golang/golang-exec.md" class="nav-link" aria-label="Golang笔记"><!--[--><!--]--> Golang笔记 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/k8s/runc.md" class="nav-link" aria-label="容器与k8s"><!--[--><!--]--> 容器与k8s <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/algorithm/radix-tree.md" class="nav-link" aria-label="算法笔记"><!--[--><!--]--> 算法笔记 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/kernel/linux-trap.md" class="nav-link" aria-label="内核分析"><!--[--><!--]--> 内核分析 <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/others/lua-implemention-gc.md" class="nav-link" aria-label="杂项"><!--[--><!--]--> 杂项 <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><p class="sidebar-heading sidebar-item active">Linux运维</p><ul class=""><li><!--[--><a href="/linux/atop.html" class="nav-link sidebar-item" aria-label="ATOP工作原理总结"><!--[--><!--]--> ATOP工作原理总结 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/linux/cloud-init.html" class="nav-link sidebar-item" aria-label="cloud-init学习笔记"><!--[--><!--]--> cloud-init学习笔记 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/linux/linux-shadow.html" class="nav-link sidebar-item" aria-label="Linux /etc/shadow 文件学习笔记"><!--[--><!--]--> Linux /etc/shadow 文件学习笔记 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/linux/bandersnatch-pypi.html" class="router-link-active router-link-exact-active nav-link router-link-active sidebar-item active" aria-label="使用Bandersnatch搭建私有Pypi源"><!--[--><!--]--> 使用Bandersnatch搭建私有Pypi源 <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/linux/bandersnatch-pypi.html#获取安装包" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="获取安装包"><!--[--><!--]--> 获取安装包 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/linux/bandersnatch-pypi.html#解压缩tar包" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="解压缩tar包"><!--[--><!--]--> 解压缩tar包 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/linux/bandersnatch-pypi.html#使用pip安装" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="使用pip安装"><!--[--><!--]--> 使用pip安装 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/linux/bandersnatch-pypi.html#首次运行创建配置文件" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="首次运行创建配置文件"><!--[--><!--]--> 首次运行创建配置文件 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/linux/bandersnatch-pypi.html#修改配置文件" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="修改配置文件"><!--[--><!--]--> 修改配置文件 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/linux/bandersnatch-pypi.html#启动同步" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="启动同步"><!--[--><!--]--> 启动同步 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a href="/linux/ntp.html" class="nav-link sidebar-item" aria-label="理解NTP协议"><!--[--><!--]--> 理解NTP协议 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/linux/dns.html" class="nav-link sidebar-item" aria-label="DNS学习总结"><!--[--><!--]--> DNS学习总结 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/linux/multi-queue.html" class="nav-link sidebar-item" aria-label="Linux 网卡多队列介绍"><!--[--><!--]--> Linux 网卡多队列介绍 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/linux/linux-boot.html" class="nav-link sidebar-item" aria-label="Linux Boot过程总结"><!--[--><!--]--> Linux Boot过程总结 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/linux/yum-update.html" class="nav-link sidebar-item" aria-label="使用Yum 升级OS"><!--[--><!--]--> 使用Yum 升级OS <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/linux/linux-common-commands.html" class="nav-link sidebar-item" aria-label="Linux 下常用命令与技巧汇总"><!--[--><!--]--> Linux 下常用命令与技巧汇总 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--]--></ul><!--[--><!--]--></aside><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><p>经常使用python的公司,考虑到pypi.python.org不稳定,都会自己搭建私有的Pypi源.这里简单介绍下方法.</p><p>现在流行使用Bandersnatch作为同步工具, 如下演示在centos7.4环境下通过</p><h1 id="安装virtualenv" tabindex="-1"><a class="header-anchor" href="#安装virtualenv" aria-hidden="true">#</a> 安装virtualenv</h1><p>virtualenv 可以为一个应用创建一套“隔离”的Python运行环境。所有依赖包在自己独立的环境,不会影响其他python程序,更不会放到系统默认的site-packages里</p><div class="language-bash ext-sh"><pre class="language-bash"><code>$ yum <span class="token function">install</span> python-virtualenv
</code></pre></div><h1 id="创建独立python环境" tabindex="-1"><a class="header-anchor" href="#创建独立python环境" aria-hidden="true">#</a> 创建独立Python环境</h1><div class="language-bash ext-sh"><pre class="language-bash"><code>$ virtualenv Bandersnatch
New python executable <span class="token keyword">in</span> Bandersnatch/bin/python
Please <span class="token function">make</span> sure you remove any previous custom paths from your /root/.pydistutils.cfg file.
Installing Setuptools<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.done.
Installing Pip<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>done.
$
</code></pre></div><h1 id="激活独立python环境" tabindex="-1"><a class="header-anchor" href="#激活独立python环境" aria-hidden="true">#</a> 激活独立Python环境</h1><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token punctuation">[</span>root@abc ~<span class="token punctuation">]</span>$ <span class="token builtin class-name">source</span> Bandersnatch/bin/activate
<span class="token punctuation">(</span>Bandersnatch<span class="token punctuation">)</span><span class="token punctuation">[</span>root@abc ~<span class="token punctuation">]</span><span class="token comment">#</span>
</code></pre></div><p>当指示符前显示 <code>(Bandersnatch)</code> 字样, 意味着所有python的操作,都只限于独立环境, 系统Python环境不受任何影响</p><h1 id="安装bandersnatch" tabindex="-1"><a class="header-anchor" href="#安装bandersnatch" aria-hidden="true">#</a> 安装Bandersnatch</h1><p>最新版的<code>Bandersnatch 2.0</code>支持python3, 但目前的环境是python2.7.5, 所以需要下载其他版本. 这里取<code>1.11</code>版</p><h2 id="获取安装包" tabindex="-1"><a class="header-anchor" href="#获取安装包" aria-hidden="true">#</a> 获取安装包</h2><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token punctuation">(</span>Bandersnatch<span class="token punctuation">)</span><span class="token punctuation">[</span>root@abc ~<span class="token punctuation">]</span>$ <span class="token function">wget</span> https://bitbucket.org/pypa/bandersnatch/get/1.11.tar.gz
--2018-01-02 <span class="token number">22</span>:39:22--  https://bitbucket.org/pypa/bandersnatch/get/1.11.tar.gz
Resolving bitbucket.org <span class="token punctuation">(</span>bitbucket.org<span class="token punctuation">)</span><span class="token punctuation">..</span>. <span class="token number">104.192</span>.143.3, <span class="token number">104.192</span>.143.2, <span class="token number">104.192</span>.143.1, <span class="token punctuation">..</span>.
Connecting to bitbucket.org <span class="token punctuation">(</span>bitbucket.org<span class="token punctuation">)</span><span class="token operator">|</span><span class="token number">104.192</span>.143.3<span class="token operator">|</span>:443<span class="token punctuation">..</span>. connected.
HTTP request sent, awaiting response<span class="token punctuation">..</span>. <span class="token number">200</span> OK
Length: <span class="token number">25988</span> <span class="token punctuation">(</span>25K<span class="token punctuation">)</span> <span class="token punctuation">[</span>application/x-tar-gz<span class="token punctuation">]</span>
Saving to: ‘1.11.tar.gz.1’

<span class="token number">100</span>%<span class="token punctuation">[</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token operator">&gt;</span><span class="token punctuation">]</span> <span class="token number">25,988</span>      <span class="token number">72</span>.9KB/s   <span class="token keyword">in</span> <span class="token number">0</span>.3s

<span class="token number">2018</span>-01-02 <span class="token number">22</span>:39:24 <span class="token punctuation">(</span><span class="token number">72.9</span> KB/s<span class="token punctuation">)</span> - ‘1.11.tar.gz.1’ saved <span class="token punctuation">[</span><span class="token number">25988</span>/25988<span class="token punctuation">]</span>
</code></pre></div><h2 id="解压缩tar包" tabindex="-1"><a class="header-anchor" href="#解压缩tar包" aria-hidden="true">#</a> 解压缩tar包</h2><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token punctuation">(</span>Bandersnatch<span class="token punctuation">)</span><span class="token punctuation">[</span>root@abc ~<span class="token punctuation">]</span>$ <span class="token function">tar</span> -xzvf <span class="token number">1.11</span>.tar.gz
pypa-bandersnatch-76b72f3ebd6c/.hg_archival.txt
pypa-bandersnatch-76b72f3ebd6c/.coveragerc
pypa-bandersnatch-76b72f3ebd6c/.hgignore
pypa-bandersnatch-76b72f3ebd6c/.hgtags
pypa-bandersnatch-76b72f3ebd6c/CHANGES.txt
pypa-bandersnatch-76b72f3ebd6c/DEVELOPMENT
pypa-bandersnatch-76b72f3ebd6c/LICENSE
pypa-bandersnatch-76b72f3ebd6c/MANIFEST.in
pypa-bandersnatch-76b72f3ebd6c/README
pypa-bandersnatch-76b72f3ebd6c/buildout.cfg
pypa-bandersnatch-76b72f3ebd6c/pytest.ini
pypa-bandersnatch-76b72f3ebd6c/requirements.txt
pypa-bandersnatch-76b72f3ebd6c/setup.py
pypa-bandersnatch-76b72f3ebd6c/src/bandersnatch/__init__.py
`````````````````````````<span class="token punctuation">(</span>此处省略若干字<span class="token punctuation">)</span>
</code></pre></div><h2 id="使用pip安装" tabindex="-1"><a class="header-anchor" href="#使用pip安装" aria-hidden="true">#</a> 使用pip安装</h2><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token punctuation">(</span>Bandersnatch<span class="token punctuation">)</span><span class="token punctuation">[</span>root@abc ~<span class="token punctuation">]</span>$ pip <span class="token function">install</span> -r pypa-bandersnatch-76b72f3ebd6c/requirements.txt
Downloading/unpacking <span class="token assign-left variable">coverage</span><span class="token operator">==</span><span class="token number">3.7</span>.1 <span class="token punctuation">(</span>from -r pypa-bandersnatch-76b72f3ebd6c/requirements.txt <span class="token punctuation">(</span>line <span class="token number">2</span><span class="token punctuation">))</span>
  Downloading coverage-3.7.1.tar.gz <span class="token punctuation">(</span>284kB<span class="token punctuation">)</span>: 284kB downloaded
  Running setup.py egg_info <span class="token keyword">for</span> package coverage

    warning: no previously-included files matching <span class="token string">&#39;*.pyc&#39;</span> found anywhere <span class="token keyword">in</span> distribution
Downloading/unpacking <span class="token assign-left variable">pyparsing</span><span class="token operator">==</span><span class="token number">2.1</span>.3 <span class="token punctuation">(</span>from -r pypa-bandersnatch-76b72f3ebd6c/requirements.txt <span class="token punctuation">(</span>line <span class="token number">3</span><span class="token punctuation">))</span>
  Downloading pyparsing-2.1.3.tar.gz <span class="token punctuation">(</span><span class="token number">1</span>.1MB<span class="token punctuation">)</span>: <span class="token number">1</span>.1MB downloaded
  Running setup.py egg_info <span class="token keyword">for</span> package pyparsing

Downloading/unpacking <span class="token assign-left variable">py</span><span class="token operator">==</span><span class="token number">1.4</span>.26 <span class="token punctuation">(</span>from -r pypa-bandersnatch-76b72f3ebd6c/requirements.txt <span class="token punctuation">(</span>line <span class="token number">4</span><span class="token punctuation">))</span>
  Downloading py-1.4.26.tar.gz <span class="token punctuation">(</span>190kB<span class="token punctuation">)</span>: 190kB downloaded
  Running setup.py egg_info <span class="token keyword">for</span> package py
<span class="token punctuation">(</span>此处省略若干字<span class="token punctuation">)</span>
      Installing bandersnatch script to /root/Bandersnatch/bin
  Could not <span class="token function">find</span> .egg-info directory <span class="token keyword">in</span> <span class="token function">install</span> record <span class="token keyword">for</span> <span class="token assign-left variable">bandersnatch</span><span class="token operator">==</span><span class="token number">1.11</span> <span class="token punctuation">(</span>from -r pypa-bandersnatch-76b72f3ebd6c/requirements.txt <span class="token punctuation">(</span>line <span class="token number">22</span><span class="token punctuation">))</span>
Successfully installed coverage pyparsing py pyflakes pep8 pytest cov-core execnet python-dateutil six setuptools mock packaging pytest-capturelog pytest-codecheckers pytest-cov pytest-timeout pytest-cache requests xmlrpc2 bandersnatch
Cleaning up<span class="token punctuation">..</span>.
<span class="token punctuation">(</span>Bandersnatch<span class="token punctuation">)</span><span class="token punctuation">[</span>root@abc ~<span class="token punctuation">]</span>$
</code></pre></div><h1 id="配置bandersnatch并运行" tabindex="-1"><a class="header-anchor" href="#配置bandersnatch并运行" aria-hidden="true">#</a> 配置Bandersnatch并运行</h1><h2 id="首次运行创建配置文件" tabindex="-1"><a class="header-anchor" href="#首次运行创建配置文件" aria-hidden="true">#</a> 首次运行创建配置文件</h2><div class="language-text ext-text"><pre class="language-text"><code>(Bandersnatch)[root@abc ~]$ bandersnatch mirror
2018-01-02 22:43:37,985 WARNING: Config file &#39;/etc/bandersnatch.conf&#39; missing, creating default config.
2018-01-02 22:43:37,985 WARNING: Please review the config file, then run &#39;bandersnatch&#39; again.
(Bandersnatch)[root@abc ~]$
</code></pre></div><p>这一步,会创建默认的配置文件/etc/bandersnatch.conf.</p><h2 id="修改配置文件" tabindex="-1"><a class="header-anchor" href="#修改配置文件" aria-hidden="true">#</a> 修改配置文件</h2><p><code>vi /etc/bandersnatch.conf</code><br> 修改directory为存放文件的目标文件夹. 其他选项通常不需要修改.</p><div class="language-ini ext-ini"><pre class="language-ini"><code><span class="token header"><span class="token punctuation">[</span><span class="token section-name selector">mirror</span><span class="token punctuation">]</span></span>
<span class="token comment">; The directory where the mirror data will be stored.</span>
<span class="token key attr-name">directory</span> <span class="token punctuation">=</span> <span class="token value attr-value">/srv/pypi</span>
</code></pre></div><h2 id="启动同步" tabindex="-1"><a class="header-anchor" href="#启动同步" aria-hidden="true">#</a> 启动同步</h2><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token punctuation">(</span>Bandersnatch<span class="token punctuation">)</span><span class="token punctuation">[</span>root@abc ~<span class="token punctuation">]</span>$ bandersnatch  mirror
<span class="token number">2018</span>-01-02 <span class="token number">22</span>:45:44,376 INFO: bandersnatch/1.11 <span class="token punctuation">(</span>CPython <span class="token number">2.7</span>.5-final0, Linux <span class="token number">3.10</span>.0-693.2.2.el7.x86_64 x86_64<span class="token punctuation">)</span>
<span class="token number">2018</span>-01-02 <span class="token number">22</span>:45:44,376 INFO: Status <span class="token function">file</span> missing. Starting over.
<span class="token number">2018</span>-01-02 <span class="token number">22</span>:45:44,376 INFO: Syncing with https://pypi.python.org.
<span class="token number">2018</span>-01-02 <span class="token number">22</span>:45:44,376 INFO: Current mirror serial: <span class="token number">0</span>
<span class="token number">2018</span>-01-02 <span class="token number">22</span>:45:44,376 INFO: Syncing all packages.
<span class="token punctuation">(</span>此处省略若干字<span class="token punctuation">)</span>
</code></pre></div><h1 id="其他说明" tabindex="-1"><a class="header-anchor" href="#其他说明" aria-hidden="true">#</a> 其他说明</h1><p>因为使用了<code>virtualenv</code>, 将程序移植也很方便, 使用<code>tar -czvf Bandersnatch.tar.gz Bandersnatch </code>将文件夹打包,在其他主机(需要有python2)的相同目录下解包即可直接运行</p><p>如果要系统定期自动同步, 则创建<code>/etc/cron.d/bandersnatch</code>文件, 将下面内容写入</p><div class="language-bash ext-sh"><pre class="language-bash"><code>*/2 * * * * root bandersnatch mirror <span class="token operator">|&amp;</span> logger -t bandersnatch<span class="token punctuation">[</span>mirror<span class="token punctuation">]</span>
</code></pre></div><p>该定时任务会将运行日志写入到系统日志里. <code>|&amp;</code> 代表 前者的标准输出和标准错误都作为后者的标准输入</p><p>本文主要参考了 https://pypi.python.org/pypi/bandersnatch</p><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><span class="meta-item-info">7/18/2021, 6:56:35 AM</span></div><!----></footer><nav class="page-nav"><p class="inner"><span class="prev"> ← <a href="/linux/linux-shadow.html" class="nav-link" aria-label="Linux /etc/shadow 文件学习笔记"><!--[--><!--]--> Linux /etc/shadow 文件学习笔记 <!--[--><!--]--></a></span><span class="next"><a href="/linux/ntp.html" class="nav-link" aria-label="理解NTP协议"><!--[--><!--]--> 理解NTP协议 <!--[--><!--]--></a> → </span></p></nav><!--[--><!--]--></main></div><!----><!--]--></div>
    <script src="/assets/js/runtime~app.443127ae.js" defer></script><script src="/assets/js/838.91c535db.js" defer></script><script src="/assets/js/app.1ace75fc.js" defer></script>
  </body>
</html>
