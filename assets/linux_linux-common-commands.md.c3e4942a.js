import{_ as s,c as a,o as n,a as l}from"./app.526dca4e.js";var p="/img/systemd_plot.svg",e="/img/iftop.png";const u=JSON.parse('{"title":"Linux \u4E0B\u5E38\u7528\u547D\u4EE4\u4E0E\u6280\u5DE7\u6C47\u603B","description":"","frontmatter":{"title":"Linux \u4E0B\u5E38\u7528\u547D\u4EE4\u4E0E\u6280\u5DE7\u6C47\u603B"},"headers":[{"level":2,"title":"1. \u67E5\u8BE2\u7CFB\u7EDF\u51C6\u786E\u7684\u542F\u52A8\u65F6\u95F4","slug":"_1-\u67E5\u8BE2\u7CFB\u7EDF\u51C6\u786E\u7684\u542F\u52A8\u65F6\u95F4"},{"level":2,"title":"2. \u67E5\u8BE2\u6240\u6709\u8FDB\u7A0B\u7684\u51C6\u786E\u542F\u52A8\u65F6\u95F4\u548C\u8FD0\u884C\u65F6\u957F","slug":"_2-\u67E5\u8BE2\u6240\u6709\u8FDB\u7A0B\u7684\u51C6\u786E\u542F\u52A8\u65F6\u95F4\u548C\u8FD0\u884C\u65F6\u957F"},{"level":2,"title":"3. \u8BBE\u7F6E\u65F6\u95F4","slug":"_3-\u8BBE\u7F6E\u65F6\u95F4"},{"level":2,"title":"4. \u540C\u6B65OS\u4E0E\u786C\u4EF6\u65F6\u95F4","slug":"_4-\u540C\u6B65os\u4E0E\u786C\u4EF6\u65F6\u95F4"},{"level":2,"title":"5. \u67E5\u770B\u786C\u4EF6\u4FE1\u606F","slug":"_5-\u67E5\u770B\u786C\u4EF6\u4FE1\u606F"},{"level":2,"title":"6 \u9501\u5B9A\u6587\u4EF6,\u4E0D\u88AB\u4EFB\u4F55\u7A0B\u5E8F\u4FEE\u6539","slug":"_6-\u9501\u5B9A\u6587\u4EF6-\u4E0D\u88AB\u4EFB\u4F55\u7A0B\u5E8F\u4FEE\u6539"},{"level":2,"title":"7. stat \u67E5\u770B\u6587\u4EF6\u8BE6\u7EC6\u5143\u6570\u636E\u4FE1\u606F, \u7279\u522B\u662Finode","slug":"_7-stat-\u67E5\u770B\u6587\u4EF6\u8BE6\u7EC6\u5143\u6570\u636E\u4FE1\u606F-\u7279\u522B\u662Finode"},{"level":2,"title":"8. xxd\u67E5\u770B\u4E8C\u8FDB\u5236\u6587\u4EF6","slug":"_8-xxd\u67E5\u770B\u4E8C\u8FDB\u5236\u6587\u4EF6"},{"level":2,"title":"9. \u6279\u91CF\u4FEE\u6539\u6587\u4EF6\u540D","slug":"_9-\u6279\u91CF\u4FEE\u6539\u6587\u4EF6\u540D"},{"level":2,"title":"10. df \u67E5\u8BE2\u6587\u4EF6\u7CFB\u7EDF\u6302\u8F7D\u70B9\u4FE1\u606F","slug":"_10-df-\u67E5\u8BE2\u6587\u4EF6\u7CFB\u7EDF\u6302\u8F7D\u70B9\u4FE1\u606F"},{"level":2,"title":"11. du \u547D\u4EE4","slug":"_11-du-\u547D\u4EE4"},{"level":2,"title":"12. find\u5220\u9664\u67E5\u627E\u5230\u7684\u6587\u4EF6","slug":"_12-find\u5220\u9664\u67E5\u627E\u5230\u7684\u6587\u4EF6"},{"level":2,"title":"13. xargs \u547D\u4EE4","slug":"_13-xargs-\u547D\u4EE4"},{"level":2,"title":"14. grep\u67E5\u8BE2\u6587\u672C","slug":"_14-grep\u67E5\u8BE2\u6587\u672C"},{"level":2,"title":"15. tail \u67E5\u770B\u6587\u4EF6\u6307\u5B9A\u884C\u4FE1\u606F","slug":"_15-tail-\u67E5\u770B\u6587\u4EF6\u6307\u5B9A\u884C\u4FE1\u606F"},{"level":2,"title":"16. \u6279\u91CF\u521B\u5EFA\u76EE\u5F55","slug":"_16-\u6279\u91CF\u521B\u5EFA\u76EE\u5F55"},{"level":2,"title":"17. echo \u76F8\u5173\u547D\u4EE4","slug":"_17-echo-\u76F8\u5173\u547D\u4EE4"},{"level":2,"title":"18. nohup\u4E0E\u6807\u51C6\u8F93\u51FA,\u6807\u51C6\u9519\u8BEF\u8F93\u51FA","slug":"_18-nohup\u4E0E\u6807\u51C6\u8F93\u51FA-\u6807\u51C6\u9519\u8BEF\u8F93\u51FA"},{"level":2,"title":"19. Linux\u6A21\u5757\u7684\u5B89\u88C5\u548C\u5378\u8F7D","slug":"_19-linux\u6A21\u5757\u7684\u5B89\u88C5\u548C\u5378\u8F7D"},{"level":2,"title":"20. column\u683C\u5F0F\u5316\u8F93\u51FA","slug":"_20-column\u683C\u5F0F\u5316\u8F93\u51FA"},{"level":2,"title":"21. \u901A\u8FC7pid\u67E5\u770B\u8FDB\u7A0B\u7684\u73AF\u5883\u53D8\u91CF\u4FE1\u606F","slug":"_21-\u901A\u8FC7pid\u67E5\u770B\u8FDB\u7A0B\u7684\u73AF\u5883\u53D8\u91CF\u4FE1\u606F"},{"level":2,"title":"22. \u901A\u8FC7pid\u67E5\u770B\u8FDB\u7A0B\u5BF9\u5E94\u53EF\u6267\u884C\u6587\u4EF6\u7684\u7EDD\u5BF9\u8DEF\u5F84","slug":"_22-\u901A\u8FC7pid\u67E5\u770B\u8FDB\u7A0B\u5BF9\u5E94\u53EF\u6267\u884C\u6587\u4EF6\u7684\u7EDD\u5BF9\u8DEF\u5F84"},{"level":2,"title":"23. \u901A\u8FC7pid\u67E5\u770B\u8FDB\u7A0B\u7684\u5F53\u524D\u5DE5\u4F5C\u76EE\u5F55","slug":"_23-\u901A\u8FC7pid\u67E5\u770B\u8FDB\u7A0B\u7684\u5F53\u524D\u5DE5\u4F5C\u76EE\u5F55"},{"level":2,"title":"24. lsof \u4E00\u5207\u7686\u6587\u4EF6","slug":"_24-lsof-\u4E00\u5207\u7686\u6587\u4EF6"},{"level":2,"title":"25. fuser \u67E5\u627E\u8BBF\u95EE\u6587\u4EF6\u7CFB\u7EDF\u7684\u8FDB\u7A0B","slug":"_25-fuser-\u67E5\u627E\u8BBF\u95EE\u6587\u4EF6\u7CFB\u7EDF\u7684\u8FDB\u7A0B"},{"level":2,"title":"26. dd \u6D4B\u8BD5\u78C1\u76D8\u6216\u8005\u6587\u4EF6\u8BFB\u5199","slug":"_26-dd-\u6D4B\u8BD5\u78C1\u76D8\u6216\u8005\u6587\u4EF6\u8BFB\u5199"},{"level":2,"title":"27. rpm \u5B89\u88C5/\u66F4\u65B0/\u5378\u8F7D\u8F6F\u4EF6\u5305","slug":"_27-rpm-\u5B89\u88C5-\u66F4\u65B0-\u5378\u8F7D\u8F6F\u4EF6\u5305"},{"level":2,"title":"28. yum \u5B89\u88C5/\u66F4\u65B0/\u5378\u8F7D\u8F6F\u4EF6\u5305","slug":"_28-yum-\u5B89\u88C5-\u66F4\u65B0-\u5378\u8F7D\u8F6F\u4EF6\u5305"},{"level":2,"title":"29. \u89E3\u538B\u7F29\u547D\u4EE4","slug":"_29-\u89E3\u538B\u7F29\u547D\u4EE4"},{"level":2,"title":"30. systemd \u7BA1\u7406\u547D\u4EE4","slug":"_30-systemd-\u7BA1\u7406\u547D\u4EE4"},{"level":2,"title":"31. Ubuntu/Debian \u68C0\u67E5\u5DF2\u7ECF\u5B89\u88C5\u597D\u7684\u8F6F\u4EF6\u5305\u7684\u66F4\u65B0\u65E5\u5FD7","slug":"_31-ubuntu-debian-\u68C0\u67E5\u5DF2\u7ECF\u5B89\u88C5\u597D\u7684\u8F6F\u4EF6\u5305\u7684\u66F4\u65B0\u65E5\u5FD7"},{"level":2,"title":"32. \u641C\u7D22\u542B\u6709\u6307\u5B9A\u5B57\u7B26\u7684\u624B\u518C\u9875","slug":"_32-\u641C\u7D22\u542B\u6709\u6307\u5B9A\u5B57\u7B26\u7684\u624B\u518C\u9875"},{"level":2,"title":"33. \u5FEB\u901F\u5220\u9664\u5927\u91CF\u5C0F\u6587\u4EF6","slug":"_33-\u5FEB\u901F\u5220\u9664\u5927\u91CF\u5C0F\u6587\u4EF6"},{"level":2,"title":"34. sysctl \u7BA1\u7406\u7CFB\u7EDF\u53C2\u6570","slug":"_34-sysctl-\u7BA1\u7406\u7CFB\u7EDF\u53C2\u6570"},{"level":2,"title":"35. \u6E05\u7A7A\u6587\u4EF6\u5185\u5BB9","slug":"_35-\u6E05\u7A7A\u6587\u4EF6\u5185\u5BB9"},{"level":2,"title":"36. \u67E5\u8BE2\u7CFB\u7EDF\u8C03\u7528","slug":"_36-\u67E5\u8BE2\u7CFB\u7EDF\u8C03\u7528"},{"level":2,"title":"37. \u67E5\u770B\u78C1\u76D8uuid\u548C\u6587\u4EF6\u7CFB\u7EDF\u7C7B\u578B","slug":"_37-\u67E5\u770B\u78C1\u76D8uuid\u548C\u6587\u4EF6\u7CFB\u7EDF\u7C7B\u578B"},{"level":2,"title":"38. \u521B\u5EFA\u8F6F\u8FDE\u63A5","slug":"_38-\u521B\u5EFA\u8F6F\u8FDE\u63A5"},{"level":2,"title":"39. history\u67E5\u770B\u5386\u53F2\u8BB0\u5F55","slug":"_39-history\u67E5\u770B\u5386\u53F2\u8BB0\u5F55"},{"level":2,"title":"40. \u67E5\u770B\u8FDB\u7A0B\u7684\u7236\u5B50\u8C03\u7528\u5173\u7CFB","slug":"_40-\u67E5\u770B\u8FDB\u7A0B\u7684\u7236\u5B50\u8C03\u7528\u5173\u7CFB"},{"level":2,"title":"41. rsync\u6587\u4EF6","slug":"_41-rsync\u6587\u4EF6"},{"level":2,"title":"42. \u67E5\u8BE2\u7684\u52A8\u6001\u5E93\u94FE\u63A5\u4FE1\u606F","slug":"_42-\u67E5\u8BE2\u7684\u52A8\u6001\u5E93\u94FE\u63A5\u4FE1\u606F"},{"level":2,"title":"43. \u67E5\u8BE2ascii\u7F16\u7801\u8868","slug":"_43-\u67E5\u8BE2ascii\u7F16\u7801\u8868"},{"level":2,"title":"44. iptable \u5185\u7F6E\u9632\u706B\u5899","slug":"_44-iptable-\u5185\u7F6E\u9632\u706B\u5899"},{"level":2,"title":"45. tcpdump \u6293\u5305","slug":"_45-tcpdump-\u6293\u5305"},{"level":2,"title":"46. DNS\u67E5\u8BE2\u5DE5\u5177","slug":"_46-dns\u67E5\u8BE2\u5DE5\u5177"},{"level":2,"title":"47. NTP\u65F6\u95F4\u540C\u6B65","slug":"_47-ntp\u65F6\u95F4\u540C\u6B65"},{"level":2,"title":"48. netstat\u67E5\u8BE2\u7F51\u7EDC\u8FDE\u63A5\u4FE1\u606F","slug":"_48-netstat\u67E5\u8BE2\u7F51\u7EDC\u8FDE\u63A5\u4FE1\u606F"},{"level":2,"title":"49. ethtool \u7F51\u5361\u67E5\u8BE2\u5DE5\u5177","slug":"_49-ethtool-\u7F51\u5361\u67E5\u8BE2\u5DE5\u5177"},{"level":2,"title":"50. ip \u7F51\u7EDC\u7EF4\u62A4","slug":"_50-ip-\u7F51\u7EDC\u7EF4\u62A4"},{"level":2,"title":"51. who \u67E5\u770B\u5F53\u524D\u767B\u5F55\u7528\u6237","slug":"_51-who-\u67E5\u770B\u5F53\u524D\u767B\u5F55\u7528\u6237"},{"level":2,"title":"52. \u4F7F\u7528iftop\u67E5\u770B\u4E3B\u673A\u5B9E\u65F6\u7F51\u7EDC\u6D41\u91CF","slug":"_52-\u4F7F\u7528iftop\u67E5\u770B\u4E3B\u673A\u5B9E\u65F6\u7F51\u7EDC\u6D41\u91CF"},{"level":2,"title":"53. Bash\u76F8\u5173\u73AF\u5883\u53D8\u91CF","slug":"_53-bash\u76F8\u5173\u73AF\u5883\u53D8\u91CF"},{"level":2,"title":"54. \u67E5\u672C\u673A\u7684\u516C\u7F51IP","slug":"_54-\u67E5\u672C\u673A\u7684\u516C\u7F51ip"},{"level":2,"title":"55. \u67E5\u8BE2linux\u7CFB\u7EDF\u7684\u4E00\u4E9B\u9650\u5236\u4FE1\u606F","slug":"_55-\u67E5\u8BE2linux\u7CFB\u7EDF\u7684\u4E00\u4E9B\u9650\u5236\u4FE1\u606F"},{"level":2,"title":"56. \u5224\u65AD\u865A\u62DF\u5316\u7C7B\u578B\u7684N\u79CD\u65B9\u6CD5","slug":"_56-\u5224\u65AD\u865A\u62DF\u5316\u7C7B\u578B\u7684n\u79CD\u65B9\u6CD5"},{"level":2,"title":"57. cpu\u4FE1\u606F\u89E3\u8BFB","slug":"_57-cpu\u4FE1\u606F\u89E3\u8BFB"},{"level":2,"title":"58. taskset\u6307\u5B9A\u8FDB\u7A0B\u7684CPU\u4EB2\u548C\u6027","slug":"_58-taskset\u6307\u5B9A\u8FDB\u7A0B\u7684cpu\u4EB2\u548C\u6027"},{"level":2,"title":"59. Linux\u7CFB\u7EDF\u6700\u5927\u6587\u4EF6\u6570\u91CF","slug":"_59-linux\u7CFB\u7EDF\u6700\u5927\u6587\u4EF6\u6570\u91CF"},{"level":2,"title":"60. ss \u67E5\u8BE2socket\u8FDE\u63A5\u4FE1\u606F","slug":"_60-ss-\u67E5\u8BE2socket\u8FDE\u63A5\u4FE1\u606F"},{"level":2,"title":"61. \u6D88\u9664\u7528\u6237\u88AB\u9501\u7684\u9519\u8BEF\u767B\u5F55\u8BB0\u5F55","slug":"_61-\u6D88\u9664\u7528\u6237\u88AB\u9501\u7684\u9519\u8BEF\u767B\u5F55\u8BB0\u5F55"},{"level":2,"title":"62. \u4F30\u8BA1RSS\u603B\u548C\u7684\u5927\u5C0F","slug":"_62-\u4F30\u8BA1rss\u603B\u548C\u7684\u5927\u5C0F"},{"level":2,"title":"63. \u6587\u4EF6\u7CFB\u7EDF\u4FEE\u590D","slug":"_63-\u6587\u4EF6\u7CFB\u7EDF\u4FEE\u590D"},{"level":2,"title":"64. \u975E\u4EA4\u4E92\u5F0F\u4FEE\u6539\u5BC6\u7801","slug":"_64-\u975E\u4EA4\u4E92\u5F0F\u4FEE\u6539\u5BC6\u7801"},{"level":2,"title":"66. udev\u7BA1\u7406","slug":"_66-udev\u7BA1\u7406"},{"level":2,"title":"67. \u4E00\u6761\u547D\u4EE4\u542F\u52A8web\u670D\u52A1\u5668","slug":"_67-\u4E00\u6761\u547D\u4EE4\u542F\u52A8web\u670D\u52A1\u5668"},{"level":2,"title":"68. dpkg,apt-get\u5305\u7BA1\u7406\u547D\u4EE4","slug":"_68-dpkg-apt-get\u5305\u7BA1\u7406\u547D\u4EE4"},{"level":2,"title":"69. \u4E3B\u673A\u5B89\u5168\u5165\u4FB5\u76D8\u67E5","slug":"_69-\u4E3B\u673A\u5B89\u5168\u5165\u4FB5\u76D8\u67E5"},{"level":2,"title":"70. top\u547D\u4EE4","slug":"_70-top\u547D\u4EE4"},{"level":2,"title":"71. ping\u547D\u4EE4","slug":"_71-ping\u547D\u4EE4"},{"level":2,"title":"72. ping\u548Ccurl\u5E38\u89C1\u7684\u7F51\u7EDC\u62A5\u9519","slug":"_72-ping\u548Ccurl\u5E38\u89C1\u7684\u7F51\u7EDC\u62A5\u9519"},{"level":2,"title":"73. \u4E00\u4E9B\u5E38\u7528\u7684\u5185\u5B58\u7EDF\u8BA1\u547D\u4EE4","slug":"_73-\u4E00\u4E9B\u5E38\u7528\u7684\u5185\u5B58\u7EDF\u8BA1\u547D\u4EE4"},{"level":2,"title":"74. \u4E0D\u540COS\u7684\u6587\u4EF6\u7F16\u7801","slug":"_74-\u4E0D\u540Cos\u7684\u6587\u4EF6\u7F16\u7801"},{"level":2,"title":"75. \u4E00\u4E9Bshell\u5FAA\u73AF\u547D\u4EE4","slug":"_75-\u4E00\u4E9Bshell\u5FAA\u73AF\u547D\u4EE4"},{"level":2,"title":"76. dhcp\u6301\u7EED\u8BF7\u6C42\u914D\u7F6E","slug":"_76-dhcp\u6301\u7EED\u8BF7\u6C42\u914D\u7F6E"},{"level":2,"title":"77. \u89E3\u6790/proc/[pid]/status\u91CC\u5173\u4E8E\u4FE1\u53F7\u7684\u5B57\u6BB5","slug":"_77-\u89E3\u6790-proc-pid-status\u91CC\u5173\u4E8E\u4FE1\u53F7\u7684\u5B57\u6BB5"},{"level":2,"title":"78. \u5BA1\u8BA1\u8C01\u6740\u4E86\u8FDB\u7A0B","slug":"_78-\u5BA1\u8BA1\u8C01\u6740\u4E86\u8FDB\u7A0B"},{"level":2,"title":"79. \u4FEE\u6539\u5B57\u7B26\u96C6\u7684\u547D\u4EE4","slug":"_79-\u4FEE\u6539\u5B57\u7B26\u96C6\u7684\u547D\u4EE4"},{"level":2,"title":"80. bash\u811A\u672C\u7684\u9000\u51FA\u7801","slug":"_80-bash\u811A\u672C\u7684\u9000\u51FA\u7801"},{"level":2,"title":"81. \u6A21\u62DF\u4E0D\u65AD\u589E\u52A0\u5185\u5B58\u81F4\u4F7F\u89E6\u53D1oom\u7684\u7A0B\u5E8F","slug":"_81-\u6A21\u62DF\u4E0D\u65AD\u589E\u52A0\u5185\u5B58\u81F4\u4F7F\u89E6\u53D1oom\u7684\u7A0B\u5E8F"},{"level":2,"title":"82. vi\u5B9E\u73B0\u5341\u516D\u8FDB\u5236\u7F16\u8F91\u529F\u80FD","slug":"_82-vi\u5B9E\u73B0\u5341\u516D\u8FDB\u5236\u7F16\u8F91\u529F\u80FD"},{"level":2,"title":"83. iproute\u8F6F\u4EF6\u5305\u91CC\u7684\u4E00\u4E9B\u5E38\u7528\u547D\u4EE4","slug":"_83-iproute\u8F6F\u4EF6\u5305\u91CC\u7684\u4E00\u4E9B\u5E38\u7528\u547D\u4EE4"},{"level":2,"title":"84. \u94FE\u63A5\u8DDF\u8E2A","slug":"_84-\u94FE\u63A5\u8DDF\u8E2A"},{"level":2,"title":"85. \u4E00\u4E9B\u6C47\u7F16\u8BED\u6CD5","slug":"_85-\u4E00\u4E9B\u6C47\u7F16\u8BED\u6CD5"},{"level":2,"title":"86. \u4F7F\u7528crash\u5206\u6790\u5185\u6838coredump\u7684\u4E00\u4E9B\u6587\u7AE0","slug":"_86-\u4F7F\u7528crash\u5206\u6790\u5185\u6838coredump\u7684\u4E00\u4E9B\u6587\u7AE0"},{"level":2,"title":"87. Linux\u5185\u6838\u6A21\u5757\u76F8\u5173","slug":"_87-linux\u5185\u6838\u6A21\u5757\u76F8\u5173"},{"level":2,"title":"88. ssh\u8FDE\u63A5\u4FDD\u6D3B\u914D\u7F6E","slug":"_88-ssh\u8FDE\u63A5\u4FDD\u6D3B\u914D\u7F6E"},{"level":2,"title":"89. \u4F7F\u7528auditd\u5BA1\u8BA1\u529F\u80FD","slug":"_89-\u4F7F\u7528auditd\u5BA1\u8BA1\u529F\u80FD"},{"level":2,"title":"90. \u5206\u6790\u78C1\u76D8\u6027\u80FD","slug":"_90-\u5206\u6790\u78C1\u76D8\u6027\u80FD"},{"level":2,"title":"91. Grub\u76F8\u5173\u95EE\u9898","slug":"_91-grub\u76F8\u5173\u95EE\u9898"},{"level":2,"title":"92. SLAB\u76F8\u5173\u7684\u77E5\u8BC6","slug":"_92-slab\u76F8\u5173\u7684\u77E5\u8BC6"},{"level":2,"title":"93. nfs\u76F8\u5173\u7684\u77E5\u8BC6","slug":"_93-nfs\u76F8\u5173\u7684\u77E5\u8BC6"},{"level":2,"title":"94. fork\u521B\u5EFA\u8FDB\u7A0B\u65F6\u7684\u51E0\u4E2A\u62A5\u9519\u8BF4\u660E","slug":"_94-fork\u521B\u5EFA\u8FDB\u7A0B\u65F6\u7684\u51E0\u4E2A\u62A5\u9519\u8BF4\u660E"}],"relativePath":"linux/linux-common-commands.md","lastUpdated":1657810449000}'),o={name:"linux/linux-common-commands.md"},c=l(`<h1 id="linux-\u4E0B\u5E38\u7528\u547D\u4EE4\u4E0E\u6280\u5DE7\u6C47\u603B" tabindex="-1">Linux \u4E0B\u5E38\u7528\u547D\u4EE4\u4E0E\u6280\u5DE7\u6C47\u603B <a class="header-anchor" href="#linux-\u4E0B\u5E38\u7528\u547D\u4EE4\u4E0E\u6280\u5DE7\u6C47\u603B" aria-hidden="true">#</a></h1><p>\u6536\u96C6\u81EA\u5DF1\u5E38\u7528\u5230\u7684linux\u547D\u4EE4\u4E0E\u6280\u5DE7,\u65B9\u4FBF\u540E\u7EED\u67E5\u627E.\u4E0D\u5B9A\u671F\u66F4\u65B0.</p><h2 id="_1-\u67E5\u8BE2\u7CFB\u7EDF\u51C6\u786E\u7684\u542F\u52A8\u65F6\u95F4" tabindex="-1">1. \u67E5\u8BE2\u7CFB\u7EDF\u51C6\u786E\u7684\u542F\u52A8\u65F6\u95F4 <a class="header-anchor" href="#_1-\u67E5\u8BE2\u7CFB\u7EDF\u51C6\u786E\u7684\u542F\u52A8\u65F6\u95F4" aria-hidden="true">#</a></h2><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">date -d </span><span style="color:#89DDFF;">&quot;$(</span><span style="color:#C3E88D;">awk -F. </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">{print $1}</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;"> /proc/uptime</span><span style="color:#89DDFF;">)</span><span style="color:#C3E88D;"> second ago</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> +</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">%Y-%m-%d %H:%M:%S</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">2018-01-17 22:27:55</span></span>
<span class="line"></span></code></pre></div><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">who -b</span></span>
<span class="line"><span style="color:#A6ACCD;">         system boot  2018-01-17 22:27</span></span>
<span class="line"></span></code></pre></div><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">uptime -s</span></span>
<span class="line"><span style="color:#A6ACCD;">2019-09-04 00:40:58</span></span>
<span class="line"></span></code></pre></div><h2 id="_2-\u67E5\u8BE2\u6240\u6709\u8FDB\u7A0B\u7684\u51C6\u786E\u542F\u52A8\u65F6\u95F4\u548C\u8FD0\u884C\u65F6\u957F" tabindex="-1">2. \u67E5\u8BE2\u6240\u6709\u8FDB\u7A0B\u7684\u51C6\u786E\u542F\u52A8\u65F6\u95F4\u548C\u8FD0\u884C\u65F6\u957F <a class="header-anchor" href="#_2-\u67E5\u8BE2\u6240\u6709\u8FDB\u7A0B\u7684\u51C6\u786E\u542F\u52A8\u65F6\u95F4\u548C\u8FD0\u884C\u65F6\u957F" aria-hidden="true">#</a></h2><p>-e \u8868\u793A\u67E5\u8BE2\u6240\u6709\u8FDB\u7A0B<br> -o \u8868\u793A\u6309\u6307\u5B9A\u7684\u683C\u5F0F\u8F93\u51FA<br> lstart \u4E3A\u8FDB\u7A0B\u542F\u52A8\u65F6\u95F4<br> etime\u53EF\u4EE5\u663E\u793A\u5DF2\u7ECF\u8FD0\u884C\u4E86\u591A\u957F\u65F6\u95F4<br> args \u4E3A\u5177\u4F53\u7684\u547D\u4EE4\u884C\u53C2\u6570</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">ps -e -o pid,lstart,etime,args</span></span>
<span class="line"></span></code></pre></div><p><code>ps -efL</code> \u52A0 <code>-L</code> \u5219\u663E\u793A\u7EBF\u7A0B</p><h2 id="_3-\u8BBE\u7F6E\u65F6\u95F4" tabindex="-1">3. \u8BBE\u7F6E\u65F6\u95F4 <a class="header-anchor" href="#_3-\u8BBE\u7F6E\u65F6\u95F4" aria-hidden="true">#</a></h2><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">date -s </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">dd/mm/yyyy hh:mm:ss</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre></div><p>\u4E5F\u53EF\u4EE5\u5728centos7\u4E0B\u4F7F\u7528</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">timedatectl set-time </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">2012-10-30 18:17:16</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre></div><h2 id="_4-\u540C\u6B65os\u4E0E\u786C\u4EF6\u65F6\u95F4" tabindex="-1">4. \u540C\u6B65OS\u4E0E\u786C\u4EF6\u65F6\u95F4 <a class="header-anchor" href="#_4-\u540C\u6B65os\u4E0E\u786C\u4EF6\u65F6\u95F4" aria-hidden="true">#</a></h2><p>\u5C06OS\u7CFB\u7EDF\u65F6\u95F4\u540C\u6B65\u5230\u786C\u4EF6(RTC)</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">hwclock \u2013-systohc</span></span>
<span class="line"></span></code></pre></div><p>\u5C06\u786C\u4EF6\u65F6\u95F4\u540C\u6B65\u5230OS</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">hwclock --hctosys</span></span>
<span class="line"></span></code></pre></div><h2 id="_5-\u67E5\u770B\u786C\u4EF6\u4FE1\u606F" tabindex="-1">5. \u67E5\u770B\u786C\u4EF6\u4FE1\u606F <a class="header-anchor" href="#_5-\u67E5\u770B\u786C\u4EF6\u4FE1\u606F" aria-hidden="true">#</a></h2><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">lscpu               </span><span style="color:#676E95;font-style:italic;">#\u67E5\u770BCPU\u4FE1\u606F</span></span>
<span class="line"><span style="color:#A6ACCD;">lspci               </span><span style="color:#676E95;font-style:italic;">#\u67E5\u770BPCI\u4FE1\u606F</span></span>
<span class="line"><span style="color:#A6ACCD;">lsusb               </span><span style="color:#676E95;font-style:italic;">#\u67E5\u770B\u5916\u8BBEUSB</span></span>
<span class="line"><span style="color:#A6ACCD;">lsscsi              </span><span style="color:#676E95;font-style:italic;">#\u67E5\u770BSCSI\u8BBE\u5907</span></span>
<span class="line"><span style="color:#A6ACCD;">lsblk               </span><span style="color:#676E95;font-style:italic;">#\u67E5\u770B\u5757\u8BBE\u5907</span></span>
<span class="line"><span style="color:#A6ACCD;">dmidecode -t memory </span><span style="color:#676E95;font-style:italic;">#\u67E5\u5185\u5B58\u69FD\u4F4D\u4FE1\u606F. \u4E0D\u8DDF -t , \u67E5\u5168\u91CFprocessor, Memory, BIOS</span></span>
<span class="line"></span></code></pre></div><h2 id="_6-\u9501\u5B9A\u6587\u4EF6-\u4E0D\u88AB\u4EFB\u4F55\u7A0B\u5E8F\u4FEE\u6539" tabindex="-1">6 \u9501\u5B9A\u6587\u4EF6,\u4E0D\u88AB\u4EFB\u4F55\u7A0B\u5E8F\u4FEE\u6539 <a class="header-anchor" href="#_6-\u9501\u5B9A\u6587\u4EF6-\u4E0D\u88AB\u4EFB\u4F55\u7A0B\u5E8F\u4FEE\u6539" aria-hidden="true">#</a></h2><p>chattr \u53EF\u4EE5\u6539\u53D8\u6587\u4EF6\u6269\u5C55\u5C5E\u6027, <code>chattr +i</code> \u53EF\u4EE5\u9632\u6B62\u4EFB\u4F55\u7A0B\u5E8F\u4FEE\u6539\u8BE5\u6587\u4EF6. \u5373\u4F7F\u6709root\u6743\u9650.<br> \u5E38\u7528\u4E8E\u9501\u5B9Adns\u914D\u7F6E,\u9632\u6B62dhcp\u7A0B\u5E8F\u81EA\u52A8\u4FEE\u6539. <code>lsattr</code> \u67E5\u770B\u5F53\u524D\u7684\u6269\u5C55\u5C5E\u6027. <code>man chattr</code> \u67E5\u770B\u6240\u6709\u53C2\u6570\u542B\u4E49.</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">chattr +i /etc/resolv.conf</span></span>
<span class="line"></span></code></pre></div><h2 id="_7-stat-\u67E5\u770B\u6587\u4EF6\u8BE6\u7EC6\u5143\u6570\u636E\u4FE1\u606F-\u7279\u522B\u662Finode" tabindex="-1">7. stat \u67E5\u770B\u6587\u4EF6\u8BE6\u7EC6\u5143\u6570\u636E\u4FE1\u606F, \u7279\u522B\u662Finode <a class="header-anchor" href="#_7-stat-\u67E5\u770B\u6587\u4EF6\u8BE6\u7EC6\u5143\u6570\u636E\u4FE1\u606F-\u7279\u522B\u662Finode" aria-hidden="true">#</a></h2><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ stat messages</span></span>
<span class="line"><span style="color:#A6ACCD;">  File: \u2018messages\u2019</span></span>
<span class="line"><span style="color:#A6ACCD;">  Size: 0         	Blocks: 0          IO Block: 4096   regular empty file</span></span>
<span class="line"><span style="color:#A6ACCD;">Device: fd01h/64769d	Inode: 528438      Links: 1</span></span>
<span class="line"><span style="color:#A6ACCD;">Access: </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">0600/-rw-------</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">  Uid: </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">    0/    root</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">   Gid: </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">    0/    root</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">Context: system_u:object_r:var_log_t:s0</span></span>
<span class="line"><span style="color:#A6ACCD;">Access: 2018-01-14 21:32:01.977218590 +0800</span></span>
<span class="line"><span style="color:#A6ACCD;">Modify: 2018-01-14 21:32:01.977218590 +0800</span></span>
<span class="line"><span style="color:#A6ACCD;">Change: 2018-01-14 21:32:01.977218590 +0800</span></span>
<span class="line"><span style="color:#A6ACCD;"> Birth: -</span></span>
<span class="line"></span></code></pre></div><h2 id="_8-xxd\u67E5\u770B\u4E8C\u8FDB\u5236\u6587\u4EF6" tabindex="-1">8. xxd\u67E5\u770B\u4E8C\u8FDB\u5236\u6587\u4EF6 <a class="header-anchor" href="#_8-xxd\u67E5\u770B\u4E8C\u8FDB\u5236\u6587\u4EF6" aria-hidden="true">#</a></h2><p>-s \u6307\u5B9A\u8D77\u59CB\u4F4D\u7F6E(\u4E0D\u6307\u5B9A\u5219\u4ECE0\u5F00\u59CB), -l \u6307\u5B9A\u6253\u5370\u591A\u5C11\u4E2A\u5B57\u8282</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">xxd  -s 1 -l 5 /etc/hosts</span></span>
<span class="line"></span></code></pre></div><p>\u5F53\u5C06js,\u6216\u5176\u4ED6\u6587\u672C\u7C7B\u4FE1\u606F\u5D4C\u5165\u5230C\u7A0B\u5E8F\u65F6, <code>xxd -i</code> \u975E\u5E38\u5B9E\u7528.</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ xxd a.js</span></span>
<span class="line"><span style="color:#A6ACCD;">0000000: 7661 7220 6120 3d20 310a                 var a = 1.</span></span>
<span class="line"><span style="color:#A6ACCD;">$ xxd -i a.js</span></span>
<span class="line"><span style="color:#A6ACCD;">unsigned char a_js</span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;"> = </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  0x76, 0x61, 0x72, 0x20, 0x61, 0x20, 0x3d, 0x20, 0x31, 0x0a</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"><span style="color:#A6ACCD;">unsigned int a_js_len = 10</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span></code></pre></div><h2 id="_9-\u6279\u91CF\u4FEE\u6539\u6587\u4EF6\u540D" tabindex="-1">9. \u6279\u91CF\u4FEE\u6539\u6587\u4EF6\u540D <a class="header-anchor" href="#_9-\u6279\u91CF\u4FEE\u6539\u6587\u4EF6\u540D" aria-hidden="true">#</a></h2><p>\u7528\u6CD5:<code>rename \u539F\u5B57\u7B26\u4E32 \u76EE\u6807\u5B57\u7B26\u4E32 \u6587\u4EF6</code><br> \u542B\u4E49:<br> \u539F\u5B57\u7B26\u4E32\uFF1A\u5C06\u6587\u4EF6\u540D\u9700\u8981\u66FF\u6362\u7684\u5B57\u7B26\u4E32\uFF1B<br> \u76EE\u6807\u5B57\u7B26\u4E32\uFF1A\u5C06\u6587\u4EF6\u540D\u4E2D\u542B\u6709\u7684\u539F\u5B57\u7B26\u66FF\u6362\u6210\u76EE\u6807\u5B57\u7B26\u4E32\uFF1B<br> \u6587\u4EF6\uFF1A\u6307\u5B9A\u8981\u6539\u53D8\u6587\u4EF6\u540D\u7684\u6587\u4EF6\u5217</p><div class="language-"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">rename\u652F\u6301\u901A\u914D\u7B26</span></span>
<span class="line"><span style="color:#A6ACCD;">?    \u53EF\u66FF\u4EE3\u5355\u4E2A\u5B57\u7B26</span></span>
<span class="line"><span style="color:#A6ACCD;">*    \u53EF\u66FF\u4EE3\u591A\u4E2A\u5B57\u7B26</span></span>
<span class="line"><span style="color:#A6ACCD;">[charset]    \u53EF\u66FF\u4EE3charset\u96C6\u4E2D\u7684\u4EFB\u610F\u5355\u4E2A\u5B57\u7B26</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>\u5C06\u6240\u6709\u5DF2<code>yum</code>\u5F00\u5934\u7684\u6587\u4EF6\u7684\u540E\u7F00\u540D\u4ECE<code>.yumtx</code>\u6539\u4E3A<code>.txt</code></p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">rename .yumtx .txt yum</span><span style="color:#89DDFF;">*</span></span>
<span class="line"></span></code></pre></div><h2 id="_10-df-\u67E5\u8BE2\u6587\u4EF6\u7CFB\u7EDF\u6302\u8F7D\u70B9\u4FE1\u606F" tabindex="-1">10. df \u67E5\u8BE2\u6587\u4EF6\u7CFB\u7EDF\u6302\u8F7D\u70B9\u4FE1\u606F <a class="header-anchor" href="#_10-df-\u67E5\u8BE2\u6587\u4EF6\u7CFB\u7EDF\u6302\u8F7D\u70B9\u4FE1\u606F" aria-hidden="true">#</a></h2><p><code>-h</code> \u4F7F\u5BB9\u91CF\u7684\u5927\u5C0F\u663E\u793A\u66F4\u4EBA\u6027\u5316 <code>-T</code> \u663E\u793A\u6587\u4EF6\u7CFB\u7EDF\u7C7B\u578B</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ df -hT</span></span>
<span class="line"><span style="color:#A6ACCD;">Filesystem                   Type      Size  Used Avail Use% Mounted on</span></span>
<span class="line"><span style="color:#A6ACCD;">/dev/mapper/VolGroup-lv_root ext4       50G  8.0G   39G  18% /</span></span>
<span class="line"><span style="color:#A6ACCD;">devtmpfs                     devtmpfs  484M     0  484M   0% /dev</span></span>
<span class="line"><span style="color:#A6ACCD;">tmpfs                        tmpfs     495M     0  495M   0% /dev/shm</span></span>
<span class="line"><span style="color:#A6ACCD;">tmpfs                        tmpfs     495M  460K  494M   1% /run</span></span>
<span class="line"><span style="color:#A6ACCD;">tmpfs                        tmpfs     495M     0  495M   0% /sys/fs/cgroup</span></span>
<span class="line"><span style="color:#A6ACCD;">/dev/sda1                    ext4      477M  234M  215M  53% /boot</span></span>
<span class="line"><span style="color:#A6ACCD;">/dev/mapper/VolGroup-lv_home ext4       12G   41M   11G   1% /home</span></span>
<span class="line"><span style="color:#A6ACCD;">tmpfs                        tmpfs      99M     0   99M   0% /run/user/0</span></span>
<span class="line"></span></code></pre></div><p><code>-i</code> \u663E\u793Ainode\u5BB9\u91CF</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ df -hi</span></span>
<span class="line"><span style="color:#A6ACCD;">Filesystem                   Inodes IUsed IFree IUse% Mounted on</span></span>
<span class="line"><span style="color:#A6ACCD;">/dev/mapper/VolGroup-lv_root   3.2M  170K  3.0M    6% /</span></span>
<span class="line"><span style="color:#A6ACCD;">devtmpfs                       121K   389  121K    1% /dev</span></span>
<span class="line"><span style="color:#A6ACCD;">tmpfs                          124K     1  124K    1% /dev/shm</span></span>
<span class="line"><span style="color:#A6ACCD;">tmpfs                          124K   498  124K    1% /run</span></span>
<span class="line"><span style="color:#A6ACCD;">tmpfs                          124K    16  124K    1% /sys/fs/cgroup</span></span>
<span class="line"><span style="color:#A6ACCD;">/dev/sda1                      126K   358  125K    1% /boot</span></span>
<span class="line"><span style="color:#A6ACCD;">/dev/mapper/VolGroup-lv_home   740K    31  740K    1% /home</span></span>
<span class="line"><span style="color:#A6ACCD;">tmpfs                          124K     1  124K    1% /run/user/0</span></span>
<span class="line"></span></code></pre></div><h2 id="_11-du-\u547D\u4EE4" tabindex="-1">11. du \u547D\u4EE4 <a class="header-anchor" href="#_11-du-\u547D\u4EE4" aria-hidden="true">#</a></h2><p>\u5355\u4F4D\u662FKB \u5982\u4E0B\u83B7\u53D6/tmp\u4E0B\u6240\u6709\u6587\u4EF6\u7684\u5927\u5C0F, \u5E76\u6309\u964D\u5E8F\u6392\u5217</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">du -xs /tmp/</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> sort -rn -k1</span></span>
<span class="line"><span style="color:#A6ACCD;">8	systemd-private-415928f8a9ee431abb4fdb7f6265aa87-chronyd.service-uw9sq7</span></span>
<span class="line"><span style="color:#A6ACCD;">4	</span><span style="color:#82AAFF;">test</span></span>
<span class="line"><span style="color:#A6ACCD;">4	empty</span></span>
<span class="line"><span style="color:#A6ACCD;">4	a.tar.gz</span></span>
<span class="line"></span></code></pre></div><h2 id="_12-find\u5220\u9664\u67E5\u627E\u5230\u7684\u6587\u4EF6" tabindex="-1">12. find\u5220\u9664\u67E5\u627E\u5230\u7684\u6587\u4EF6 <a class="header-anchor" href="#_12-find\u5220\u9664\u67E5\u627E\u5230\u7684\u6587\u4EF6" aria-hidden="true">#</a></h2><p>find\u547D\u4EE4\u7ECF\u5E38\u4F1A\u7528\u5230, <code>-type f</code>\u8868\u793A\u53EA\u8FD4\u56DE\u6587\u4EF6, <code>-exec</code> \u53EF\u5C06\u5DF2\u627E\u5230\u7684\u7ED3\u679C\u4F5C\u4E3A\u6807\u51C6\u8F93\u5165\u6267\u884C\u5176\u4ED6\u547D\u4EE4.</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">find </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">PATH</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> -type f -exec rm {} \\;    </span><span style="color:#676E95;font-style:italic;"># \u5220\u9664\u67E5\u627E\u5230\u7684\u6587\u4EF6, \u5C06 path \u6539\u4E3A\u5B9E\u9645\u8981\u67E5\u627E\u7684\u76EE\u5F55</span></span>
<span class="line"></span></code></pre></div><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">find </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">PATH</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">option</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">action</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">-mtime n </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> n\u4E3A\u6570\u5B57\uFF0C\u610F\u601D\u4E3A\u5728n\u5929\u4E4B\u524D\u7684\u201C\u4E00\u5929\u5185\u201D\u88AB\u66F4\u6539\u8FC7\u7684\u6587\u4EF6\uFF1B  </span></span>
<span class="line"><span style="color:#A6ACCD;">-mtime +n </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> \u5217\u51FA\u5728n\u5929\u4E4B\u524D\uFF08\u4E0D\u542Bn\u5929\u672C\u8EAB\uFF09\u88AB\u66F4\u6539\u8FC7\u7684\u6587\u4EF6\u540D\uFF1B  </span></span>
<span class="line"><span style="color:#A6ACCD;">-mtime -n </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> \u5217\u51FA\u5728n\u5929\u4E4B\u5185\uFF08\u542Bn\u5929\u672C\u8EAB\uFF09\u88AB\u66F4\u6539\u8FC7\u7684\u6587\u4EF6\u540D\uFF1B  </span></span>
<span class="line"><span style="color:#A6ACCD;">-newer file </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> \u5217\u51FA\u6BD4file\u8FD8\u8981\u65B0\u7684\u6587\u4EF6\u540D  </span></span>
<span class="line"><span style="color:#A6ACCD;">\u4F8B\u5982\uFF1A  </span></span>
<span class="line"><span style="color:#A6ACCD;">find /root -mtime 0 </span><span style="color:#676E95;font-style:italic;"># \u5728\u5F53\u524D\u76EE\u5F55\u4E0B\u67E5\u627E\u4ECA\u5929\u4E4B\u5185\u6709\u6539\u52A8\u7684\u6587\u4EF6  </span></span>
<span class="line"><span style="color:#A6ACCD;">  </span></span>
<span class="line"><span style="color:#A6ACCD;">\u4E0E\u6587\u4EF6\u6743\u9650\u53CA\u540D\u79F0\u6709\u5173\u7684\u53C2\u6570\uFF1A  </span></span>
<span class="line"><span style="color:#A6ACCD;">-name filename \uFF1A\u627E\u51FA\u6587\u4EF6\u540D\u4E3Afilename\u7684\u6587\u4EF6  </span></span>
<span class="line"><span style="color:#A6ACCD;">-size </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">+-</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;">SIZE \uFF1A\u627E\u51FA\u6BD4SIZE\u8FD8\u8981\u5927\uFF08+\uFF09\u6216\u5C0F\uFF08-\uFF09\u7684\u6587\u4EF6  </span></span>
<span class="line"><span style="color:#A6ACCD;">-tpye TYPE \uFF1A\u67E5\u627E\u6587\u4EF6\u7684\u7C7B\u578B\u4E3ATYPE\u7684\u6587\u4EF6\uFF0CTYPE\u7684\u503C\u4E3B\u8981\u6709\uFF1A\u4E00\u822C\u6587\u4EF6\uFF08f)\u3001\u8BBE\u5907\u6587\u4EF6\uFF08b\u3001c\uFF09\u3001  </span></span>
<span class="line"><span style="color:#A6ACCD;">             \u76EE\u5F55\uFF08d\uFF09\u3001\u8FDE\u63A5\u6587\u4EF6\uFF08l\uFF09\u3001socket\uFF08s\uFF09\u3001FIFO\u7BA1\u9053\u6587\u4EF6\uFF08p\uFF09\uFF1B  </span></span>
<span class="line"><span style="color:#A6ACCD;">-perm mode \uFF1A\u67E5\u627E\u6587\u4EF6\u6743\u9650\u521A\u597D\u7B49\u4E8Emode\u7684\u6587\u4EF6\uFF0Cmode\u7528\u6570\u5B57\u8868\u793A\uFF0C\u59820755\uFF1B  </span></span>
<span class="line"><span style="color:#A6ACCD;">-perm -mode \uFF1A\u67E5\u627E\u6587\u4EF6\u6743\u9650\u5FC5\u987B\u8981\u5168\u90E8\u5305\u62ECmode\u6743\u9650\u7684\u6587\u4EF6\uFF0Cmode\u7528\u6570\u5B57\u8868\u793A  </span></span>
<span class="line"><span style="color:#A6ACCD;">-perm +mode \uFF1A\u67E5\u627E\u6587\u4EF6\u6743\u9650\u5305\u542B\u4EFB\u4E00mode\u7684\u6743\u9650\u7684\u6587\u4EF6\uFF0Cmode\u7528\u6570\u5B57\u8868\u793A  </span></span>
<span class="line"><span style="color:#A6ACCD;">\u4F8B\u5982\uFF1A  </span></span>
<span class="line"><span style="color:#A6ACCD;">find / -name passwd </span><span style="color:#676E95;font-style:italic;"># \u67E5\u627E\u6587\u4EF6\u540D\u4E3Apasswd\u7684\u6587\u4EF6  </span></span>
<span class="line"><span style="color:#A6ACCD;">find </span><span style="color:#82AAFF;">.</span><span style="color:#A6ACCD;"> -perm 0755 </span><span style="color:#676E95;font-style:italic;"># \u67E5\u627E\u5F53\u524D\u76EE\u5F55\u4E2D\u6587\u4EF6\u6743\u9650\u76840755\u7684\u6587\u4EF6  </span></span>
<span class="line"><span style="color:#A6ACCD;">find </span><span style="color:#82AAFF;">.</span><span style="color:#A6ACCD;"> -size +12k </span><span style="color:#676E95;font-style:italic;"># \u67E5\u627E\u5F53\u524D\u76EE\u5F55\u4E2D\u5927\u4E8E12KB\u7684\u6587\u4EF6\uFF0C\u6CE8\u610Fc\u8868\u793Abyte  </span></span>
<span class="line"></span></code></pre></div><h2 id="_13-xargs-\u547D\u4EE4" tabindex="-1">13. xargs \u547D\u4EE4 <a class="header-anchor" href="#_13-xargs-\u547D\u4EE4" aria-hidden="true">#</a></h2><p>\u8BE5\u547D\u4EE4\u53EF\u4EE5\u5C06\u4E00\u4E2A\u547D\u4EE4\u7684\u8F93\u51FA\u4F5C\u4E3A\u53C2\u6570\u4F20\u9012\u7ED9\u53E6\u4E00\u4E2A\u547D\u4EE4\u3002<br> \u533A\u522B\u4E8E\u7BA1\u9053\u7B26<code>|</code>\u662F\u5C06\u5C06\u8F93\u51FA\u4F5C\u4E3A\u53E6\u4E00\u4E2A\u547D\u4EE4\u7684\u6807\u51C6\u8F93\u5165\u4F20\u9012.</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">find /tmp -name </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">.png -type f </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> xargs tar -cvzf images.tar.gz</span></span>
<span class="line"></span></code></pre></div><p>\u9ED8\u8BA4\u662F\u5C06\u5185\u5BB9\u653E\u5230\u53C2\u6570\u7684\u6700\u540E\u9762, \u5982\u679C\u8981\u653E\u5230\u6307\u5B9A\u4F4D\u7F6E,\u9700\u8981\u4F7F\u7528 <code>-i</code> \u548C <code>{}</code><br> \u5982\u4E0B\u6240\u793A\uFF0C\u5C06\u7B2C\u4E00\u4E2A\u547D\u4EE4\u7684\u8F93\u51FA\u653E\u5230<code>{}</code>\u51FA\u73B0\u7684\u4F4D\u7F6E</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">ls /etc/</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">.conf </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> xargs -i cp {} /home/likegeeks/Desktop/out</span></span>
<span class="line"></span></code></pre></div><h2 id="_14-grep\u67E5\u8BE2\u6587\u672C" tabindex="-1">14. grep\u67E5\u8BE2\u6587\u672C <a class="header-anchor" href="#_14-grep\u67E5\u8BE2\u6587\u672C" aria-hidden="true">#</a></h2><p>\u5728\u6587\u4EF6\u4E2D\u67E5\u627E\u5B57\u7B26\u4E32(\u4E0D\u533A\u5206\u5927\u5C0F\u5199)</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">grep -i </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">the</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> /etc/hosts</span></span>
<span class="line"></span></code></pre></div><p>\u8F93\u51FA\u6210\u529F\u5339\u914D\u7684\u884C\uFF0C\u4EE5\u53CA\u8BE5\u884C\u4E4B\u540E\u7684\u4E09\u884C. -B \u8868\u793A\u524D\u4E09\u884C. -C \u6307\u524D\u540E\u4E09\u884C</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">grep -A 3 </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">localhost</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> /etc/hosts</span></span>
<span class="line"></span></code></pre></div><p>\u5728\u4E00\u4E2A\u6587\u4EF6\u5939\u4E2D\u9012\u5F52\u67E5\u8BE2\u5305\u542B\u6307\u5B9A\u5B57\u7B26\u4E32\u7684\u6587\u4EF6</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">grep -r </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">abc</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> /etc</span></span>
<span class="line"></span></code></pre></div><p>\u67E5\u627E\u4E0D\u5305\u542B 127 \u7684\u6240\u6709\u884C</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">grep -v </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">127</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> /etc/hosts</span></span>
<span class="line"></span></code></pre></div><p>\u9012\u5F52\u641C\u7D22\u65F6\u5FFD\u7565\u4E8C\u8FDB\u5236\u6587\u4EF6,\u52A0\u53C2\u6570<code>-I</code></p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">grep -r </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">abc</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> -I /etc</span></span>
<span class="line"></span></code></pre></div><h2 id="_15-tail-\u67E5\u770B\u6587\u4EF6\u6307\u5B9A\u884C\u4FE1\u606F" tabindex="-1">15. tail \u67E5\u770B\u6587\u4EF6\u6307\u5B9A\u884C\u4FE1\u606F <a class="header-anchor" href="#_15-tail-\u67E5\u770B\u6587\u4EF6\u6307\u5B9A\u884C\u4FE1\u606F" aria-hidden="true">#</a></h2><p>\u663E\u793A\u6700\u540E3\u884C\u8BB0\u5F55</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ tail -3 /var/log/yum.log-20180101</span></span>
<span class="line"><span style="color:#A6ACCD;">Dec 10 00:35:55 Installed: libvirt-debuginfo-3.2.0-14.el7_4.3.x86_64</span></span>
<span class="line"><span style="color:#A6ACCD;">Dec 10 18:52:40 Installed: cloud-init-0.7.9-9.el7.centos.2.x86_64</span></span>
<span class="line"><span style="color:#A6ACCD;">Dec 10 19:50:30 Erased: cloud-init-0.7.9-9.el7.centos.2.x86_64</span></span>
<span class="line"></span></code></pre></div><p>\u4ECE\u7B2C770\u884C\u5F00\u59CB\u663E\u793A</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ tail -n +770 /var/log/yum.log-20180101</span></span>
<span class="line"><span style="color:#A6ACCD;">Dec 10 18:52:40 Installed: cloud-init-0.7.9-9.el7.centos.2.x86_64</span></span>
<span class="line"><span style="color:#A6ACCD;">Dec 10 19:50:30 Erased: cloud-init-0.7.9-9.el7.centos.2.x86_64</span></span>
<span class="line"></span></code></pre></div><h2 id="_16-\u6279\u91CF\u521B\u5EFA\u76EE\u5F55" tabindex="-1">16. \u6279\u91CF\u521B\u5EFA\u76EE\u5F55 <a class="header-anchor" href="#_16-\u6279\u91CF\u521B\u5EFA\u76EE\u5F55" aria-hidden="true">#</a></h2><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">mkdir -p new_folder/{folder_1,folder_2,folder_3,folder_4,folder_5}</span></span>
<span class="line"></span></code></pre></div><h2 id="_17-echo-\u76F8\u5173\u547D\u4EE4" tabindex="-1">17. echo \u76F8\u5173\u547D\u4EE4 <a class="header-anchor" href="#_17-echo-\u76F8\u5173\u547D\u4EE4" aria-hidden="true">#</a></h2><p>\u663E\u793A\u5F53\u524D\u4F7F\u7528\u54EA\u4E2Ashell</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">0</span></span>
<span class="line"><span style="color:#A6ACCD;">-bash</span></span>
<span class="line"></span></code></pre></div><p>\u663E\u793A\u6700\u8FD1\u4E00\u4E2A\u547D\u4EE4\u6267\u884C\u7684\u7ED3\u679C\u7801</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">?</span></span>
<span class="line"><span style="color:#A6ACCD;">0</span></span>
<span class="line"></span></code></pre></div><h2 id="_18-nohup\u4E0E\u6807\u51C6\u8F93\u51FA-\u6807\u51C6\u9519\u8BEF\u8F93\u51FA" tabindex="-1">18. nohup\u4E0E\u6807\u51C6\u8F93\u51FA,\u6807\u51C6\u9519\u8BEF\u8F93\u51FA <a class="header-anchor" href="#_18-nohup\u4E0E\u6807\u51C6\u8F93\u51FA-\u6807\u51C6\u9519\u8BEF\u8F93\u51FA" aria-hidden="true">#</a></h2><p><code>nohup</code>\u914D\u548C<code>&amp;</code>\u53EF\u4EE5\u8BA9\u8FDB\u7A0B\u5728\u540E\u53F0\u8FD0\u884C, \u5982\u679C\u6CA1\u6709\u663E\u793A\u6307\u5B9A, \u9ED8\u8BA4\u5C06\u6807\u51C6\u8F93\u51FA\u548C\u9519\u8BEF\u8F93\u51FA\u91CD\u5B9A\u5411\u5230 nohup.out<br><code>1&gt;/dev/null</code> \u9996\u5148\u8868\u793A\u6807\u51C6\u8F93\u51FA\u91CD\u5B9A\u5411\u5230\u7A7A\u8BBE\u5907\u6587\u4EF6\uFF0C\u4E5F\u5C31\u662F\u4E0D\u8F93\u51FA\u4EFB\u4F55\u4FE1\u606F\u5230\u7EC8\u7AEF\uFF0C\u4E0D\u663E\u793A\u4EFB\u4F55\u4FE1\u606F<br><code>2&gt;&amp;1</code> \u8868\u793A\u6807\u51C6\u9519\u8BEF\u8F93\u51FA\u91CD\u5B9A\u5411\u7B49\u540C\u4E8E\u6807\u51C6\u8F93\u51FA\uFF0C\u56E0\u4E3A\u4E4B\u524D\u6807\u51C6\u8F93\u51FA\u5DF2\u7ECF\u91CD\u5B9A\u5411\u5230\u4E86\u7A7A\u8BBE\u5907\u6587\u4EF6\uFF0C\u6240\u4EE5\u6807\u51C6\u9519\u8BEF\u8F93\u51FA\u4E5F\u91CD\u5B9A\u5411\u5230\u7A7A\u8BBE\u5907\u6587\u4EF6<br> \u5E38\u7528\u4F7F\u7528\u65B9\u5F0F\u4E3A:</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">nohup COMMAND  </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">output.log </span><span style="color:#89DDFF;">2&gt;&amp;1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;</span></span>
<span class="line"></span></code></pre></div><h2 id="_19-linux\u6A21\u5757\u7684\u5B89\u88C5\u548C\u5378\u8F7D" tabindex="-1">19. Linux\u6A21\u5757\u7684\u5B89\u88C5\u548C\u5378\u8F7D <a class="header-anchor" href="#_19-linux\u6A21\u5757\u7684\u5B89\u88C5\u548C\u5378\u8F7D" aria-hidden="true">#</a></h2><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">lsmod                               </span><span style="color:#676E95;font-style:italic;">#\u663E\u793A\u5F53\u524D\u88C5\u5165\u7684\u5185\u6838\u6A21\u5757</span></span>
<span class="line"><span style="color:#A6ACCD;">modinfo module_name                 </span><span style="color:#676E95;font-style:italic;">#\u663E\u793A\u6A21\u5757\u4FE1\u606F</span></span>
<span class="line"><span style="color:#A6ACCD;">modprobe -c                         </span><span style="color:#676E95;font-style:italic;">#\u663E\u793A\u6A21\u5757\u7684\u914D\u7F6E\u4FE1\u606F       </span></span>
<span class="line"><span style="color:#A6ACCD;">modprobe --show-depends module_name </span><span style="color:#676E95;font-style:italic;">#\u663E\u793A\u6A21\u5757\u7684\u4F9D\u8D56\u4FE1\u606F</span></span>
<span class="line"><span style="color:#A6ACCD;">modprobe module_name                </span><span style="color:#676E95;font-style:italic;">#\u624B\u52A8\u52A0\u8F7D\u6A21\u5757</span></span>
<span class="line"><span style="color:#A6ACCD;">rmmod module_name                   </span><span style="color:#676E95;font-style:italic;">#\u5378\u8F7D\u6A21\u5757</span></span>
<span class="line"></span></code></pre></div><p>systemd \u8BFB\u53D6 /etc/modules-load.d/ \u4E2D\u7684\u914D\u7F6E\u52A0\u8F7D\u989D\u5916\u7684\u5185\u6838\u6A21\u5757\u3002\u914D\u7F6E\u6587\u4EF6\u540D\u79F0\u901A\u5E38\u4E3A <code>/etc/modules-load.d/&lt;program&gt;.conf</code>\u3002\u5982\uFF1A</p><div class="language-"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ cat /etc/modules-load.d/bonding.conf</span></span>
<span class="line"><span style="color:#A6ACCD;">bonding</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>\u4F7F\u7528 /etc/modprobe.d/\u4E2D\u7684\u6587\u4EF6\u6765\u914D\u7F6E\u4F20\u9012\u53C2\u6570\uFF0C\u5982:</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ /etc/modprobe.d/bonding.conf</span></span>
<span class="line"><span style="color:#A6ACCD;">options bonding mode=1</span></span>
<span class="line"></span></code></pre></div><p>\u522B\u540D</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ cat /etc/modprobe.d/myalias.conf</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Lets you use &#39;mymod&#39; in MODULES, instead of &#39;really_long_module_name&#39;</span></span>
<span class="line"><span style="color:#82AAFF;">alias</span><span style="color:#A6ACCD;"> mymod really_long_module_name</span></span>
<span class="line"></span></code></pre></div><p>\u5982\u679C\u6A21\u5757\u76F4\u63A5\u7F16\u8BD1\u8FDB\u5185\u6838\uFF0C\u4E5F\u53EF\u4EE5\u901A\u8FC7\u542F\u52A8\u7BA1\u7406\u5668(GRUB, LILO \u6216 Syslinux)\u7684\u5185\u6838\u884C\u52A0\u5165\u53C2\u6570\uFF1A <code>modname.parametername=parametercontents</code></p><p>\u5217\u51FA\u76F4\u63A5\u7F16\u8BD1\u5230\u5185\u6838\u7684\u6A21\u5757\u5217\u8868</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ cat /lib/modules/</span><span style="color:#89DDFF;">$(</span><span style="color:#C3E88D;">uname -r</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">/modules.builtin</span></span>
<span class="line"><span style="color:#A6ACCD;">kernel/lib/zlib_deflate/zlib_deflate.ko</span></span>
<span class="line"><span style="color:#A6ACCD;">kernel/lib/zlib_inflate/zlib_inflate.ko</span></span>
<span class="line"><span style="color:#A6ACCD;">kernel/lib/crc16.ko</span></span>
<span class="line"><span style="color:#A6ACCD;">kernel/lib/crc32.ko</span></span>
<span class="line"></span></code></pre></div><h2 id="_20-column\u683C\u5F0F\u5316\u8F93\u51FA" tabindex="-1">20. column\u683C\u5F0F\u5316\u8F93\u51FA <a class="header-anchor" href="#_20-column\u683C\u5F0F\u5316\u8F93\u51FA" aria-hidden="true">#</a></h2><p>\u53EF\u4EE5\u8BA9\u4E00\u4E9B\u547D\u4EE4\u7684\u8F93\u51FA\u770B\u8D77\u6765\u66F4\u8212\u670D\u4E9B. \u4F8B\u5982<code>blkid</code>,<code>mount</code>,<code>cat /etc/fstab</code>.</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ blkid</span></span>
<span class="line"><span style="color:#A6ACCD;">/dev/sda1: UUID=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">04f8e14d-906d-475a-bacc-7d4be966f670</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> TYPE=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ext4</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">/dev/sda2: UUID=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">8pXbJg-c7bG-CzS4-Xs9Y-SdBD-TYOJ-0r9hgF</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> TYPE=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">LVM2_member</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">/dev/mapper/VolGroup-lv_swap: UUID=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">c058935d-34e0-403c-82f6-435b1c8194ce</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> TYPE=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">swap</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">/dev/mapper/VolGroup-lv_root: UUID=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">e9fe20ee-5d6f-4610-98ca-7cbed5d012ad</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> TYPE=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ext4</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">/dev/mapper/VolGroup-lv_home: UUID=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">43578ba0-a809-4274-931d-b92f881196ad</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> TYPE=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ext4</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">$ blkid </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> column -t</span></span>
<span class="line"><span style="color:#A6ACCD;">/dev/sda1:                     UUID=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">04f8e14d-906d-475a-bacc-7d4be966f670</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">    TYPE=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ext4</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">/dev/sda2:                     UUID=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">8pXbJg-c7bG-CzS4-Xs9Y-SdBD-TYOJ-0r9hgF</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">  TYPE=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">LVM2_member</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">/dev/mapper/VolGroup-lv_swap:  UUID=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">c058935d-34e0-403c-82f6-435b1c8194ce</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">    TYPE=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">swap</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">/dev/mapper/VolGroup-lv_root:  UUID=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">e9fe20ee-5d6f-4610-98ca-7cbed5d012ad</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">    TYPE=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ext4</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">/dev/mapper/VolGroup-lv_home:  UUID=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">43578ba0-a809-4274-931d-b92f881196ad</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">    TYPE=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ext4</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre></div><p><code>-s </code>\u53C2\u6570\u6307\u5B9A\u53EF\u4EE5\u6307\u5B9A\u5206\u9694\u7B26. \u9ED8\u8BA4\u662F\u7A7A\u683C</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ grep -E </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">sshd|qemu</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> /etc/passwd </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> column -t -s:</span></span>
<span class="line"><span style="color:#A6ACCD;">sshd  x  74   74   Privilege-separated SSH  /var/empty/sshd  /sbin/nologin</span></span>
<span class="line"><span style="color:#A6ACCD;">qemu  x  107  107  qemu user                /                /sbin/nologin</span></span>
<span class="line"></span></code></pre></div><h2 id="_21-\u901A\u8FC7pid\u67E5\u770B\u8FDB\u7A0B\u7684\u73AF\u5883\u53D8\u91CF\u4FE1\u606F" tabindex="-1">21. \u901A\u8FC7pid\u67E5\u770B\u8FDB\u7A0B\u7684\u73AF\u5883\u53D8\u91CF\u4FE1\u606F <a class="header-anchor" href="#_21-\u901A\u8FC7pid\u67E5\u770B\u8FDB\u7A0B\u7684\u73AF\u5883\u53D8\u91CF\u4FE1\u606F" aria-hidden="true">#</a></h2><p>\u4F7F\u7528strings, \u53EF\u4EE5\u683C\u5F0F\u5316\u6253\u5370</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ strings /proc/1158/environ</span></span>
<span class="line"><span style="color:#A6ACCD;">LANG=en_US.UTF-8</span></span>
<span class="line"><span style="color:#A6ACCD;">PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin</span></span>
<span class="line"><span style="color:#A6ACCD;">NOTIFY_SOCKET=/run/systemd/notify</span></span>
<span class="line"><span style="color:#A6ACCD;">SSH_USE_STRONG_RNG=0</span></span>
<span class="line"></span></code></pre></div><h2 id="_22-\u901A\u8FC7pid\u67E5\u770B\u8FDB\u7A0B\u5BF9\u5E94\u53EF\u6267\u884C\u6587\u4EF6\u7684\u7EDD\u5BF9\u8DEF\u5F84" tabindex="-1">22. \u901A\u8FC7pid\u67E5\u770B\u8FDB\u7A0B\u5BF9\u5E94\u53EF\u6267\u884C\u6587\u4EF6\u7684\u7EDD\u5BF9\u8DEF\u5F84 <a class="header-anchor" href="#_22-\u901A\u8FC7pid\u67E5\u770B\u8FDB\u7A0B\u5BF9\u5E94\u53EF\u6267\u884C\u6587\u4EF6\u7684\u7EDD\u5BF9\u8DEF\u5F84" aria-hidden="true">#</a></h2><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">readlink /proc/</span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">pid</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;">/exe</span></span>
<span class="line"></span></code></pre></div><h2 id="_23-\u901A\u8FC7pid\u67E5\u770B\u8FDB\u7A0B\u7684\u5F53\u524D\u5DE5\u4F5C\u76EE\u5F55" tabindex="-1">23. \u901A\u8FC7pid\u67E5\u770B\u8FDB\u7A0B\u7684\u5F53\u524D\u5DE5\u4F5C\u76EE\u5F55 <a class="header-anchor" href="#_23-\u901A\u8FC7pid\u67E5\u770B\u8FDB\u7A0B\u7684\u5F53\u524D\u5DE5\u4F5C\u76EE\u5F55" aria-hidden="true">#</a></h2><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">pwdx </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">pid</span><span style="color:#89DDFF;">]</span></span>
<span class="line"></span></code></pre></div><h2 id="_24-lsof-\u4E00\u5207\u7686\u6587\u4EF6" tabindex="-1">24. lsof \u4E00\u5207\u7686\u6587\u4EF6 <a class="header-anchor" href="#_24-lsof-\u4E00\u5207\u7686\u6587\u4EF6" aria-hidden="true">#</a></h2><p><code>-p [PID]</code> \u53EA\u663E\u793A\u8BE5\u8FDB\u7A0B\u6253\u5F00\u7684\u6240\u6709\u6587\u4EF6. \u4E0D\u5E26\u53C2\u6570\u663E\u793A\u6240\u6709\u5DF2\u6253\u5F00\u7684\u6587\u4EF6<br><code>-d</code> \u5BF9<code>FD</code>\u6709\u6548, \u7528\u4E8E\u7B5B\u9009\u6587\u4EF6\u5217\u8868. <code>^txt</code> \u663E\u793A\u9664txt \u5176\u4ED6\u6240\u6709\u7C7B\u578B\u7684\u6587\u4EF6. <code>1</code> \u663E\u793A\u6240\u6709fd\u4E3A1\u7684\u6587\u4EF6. \u53EF\u4EE5\u4F7F\u7528<code>,</code>\u9017\u53F7\u8FDE\u63A5\u591A\u4E2A\u9009\u62E9<br><code>-a</code> \u8868\u793A\u4E24\u4E2A\u53C2\u6570\u90FD\u5FC5\u987B\u6EE1\u8DB3 (AND)\u3002\u5982\u679C\u6CA1\u6709 -a \u6807\u5FD7\uFF0C\u7F3A\u7701\u7684\u60C5\u51B5\u662F\u663E\u793A\u5339\u914D\u4EFB\u4F55\u4E00\u4E2A\u53C2\u6570 (OR) \u7684\u6587\u4EF6<br><code>-n</code> \u963B\u6B62\u7F51\u7EDC\u5730\u5740\u8F6C\u6362<br><code>-P</code> \u963B\u6B62\u7AEF\u53E3\u53F7\u5230\u7AEF\u53E3\u540D\u7684\u8F6C\u6362<br><code>-i protocol:@ip:port</code> protocol \u5305\u62EC tcp \u548C udp. \u663E\u793A\u7B26\u5408\u8BE5\u5730\u5740\u7684\u6587\u4EF6\u5217\u8868 <code>-u s</code> s\u4E3A\u7528\u6237\u540D\u6216\u8005\u7528\u6237ID, \u9009\u62E9\u8BE5\u7528\u6237\u4E0B\u7684\u6587\u4EF6</p><p><code>lsof [name]</code><br> name\u662F mount point\u6216\u8005\u6587\u4EF6\u7CFB\u7EDF\u5BF9\u5E94\u7684\u8BBE\u5907\u6587\u4EF6, \u5219\u663E\u793A\u5728\u8BE5\u6587\u4EF6\u7CFB\u7EDF\u4E0A\u6253\u5F00\u7684\u6240\u6709\u6587\u4EF6\u5217\u8868<br> name\u662F \u6587\u4EF6\u5939(\u975Emount point), \u5219\u663E\u793A\u6240\u6709\u5C06\u8BE5\u6587\u4EF6\u5939\u4F5C\u4E3A\u6B63\u5E38\u6587\u4EF6\u6253\u5F00\u7684\u5217\u8868. \u4F8B\u5982 cwd, rtd. \u5982\u679C <code>+d</code> \u6253\u5370\u6240\u6709\u5728\u8BE5\u76EE\u5F55\u4E0B\u5DF2\u6253\u5F00\u7684\u6587\u4EF6,\u4F46\u4E0D\u9012\u5F52\u67E5\u627E\u5B50\u76EE\u5F55. <code>+D </code>\u5219\u5141\u8BB8\u9012\u5F52\u67E5\u627E</p><p>\u8C01\u5728\u4F7F\u7528 /var/log/audit/audit.log</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ lsof /var/log/audit/audit.log</span></span>
<span class="line"><span style="color:#A6ACCD;">COMMAND PID USER   FD   TYPE DEVICE SIZE/OFF   NODE NAME</span></span>
<span class="line"><span style="color:#A6ACCD;">auditd  669 root    5w   REG  253,1  2027785 524474 /var/log/audit/audit.log</span></span>
<span class="line"></span></code></pre></div><p>\u663E\u793A\u6587\u4EF6\u7CFB\u7EDF<code>/</code>\u4E0B\u6240\u6709\u5DF2\u6253\u5F00\u7684\u6587\u4EF6\u5217\u8868. \u548C<code>fuser /</code>\u6548\u679C\u4E00\u6837</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ lsof /</span></span>
<span class="line"></span></code></pre></div><p>\u6240\u6709\u5728/var\u4E0B\u5DF2\u6253\u5F00\u7684\u6587\u4EF6</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ lsof +D /var/spool/</span></span>
<span class="line"><span style="color:#A6ACCD;">COMMAND  PID    USER   FD   TYPE DEVICE SIZE/OFF   NODE NAME</span></span>
<span class="line"><span style="color:#A6ACCD;">master  1297    root  cwd    DIR  253,1     4096 524402 /var/spool/postfix</span></span>
<span class="line"><span style="color:#A6ACCD;">master  1297    root   10uW  REG  253,1       33 524591 /var/spool/postfix/pid/master.pid</span></span>
<span class="line"><span style="color:#A6ACCD;">qmgr    1301 postfix  cwd    DIR  253,1     4096 524402 /var/spool/postfix</span></span>
<span class="line"><span style="color:#A6ACCD;">pickup  4178 postfix  cwd    DIR  253,1     4096 524402 /var/spool/postfix</span></span>
<span class="line"></span></code></pre></div><p>\u5217\u51FAtcpdump\u8FD9\u4E2A\u7528\u6237\u6253\u5F00\u7684\u6240\u6709\u6587\u4EF6</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ lsof -u tcpdump</span></span>
<span class="line"><span style="color:#A6ACCD;">COMMAND   PID    USER   FD   TYPE DEVICE SIZE/OFF    NODE NAME</span></span>
<span class="line"><span style="color:#A6ACCD;">tcpdump 17905 tcpdump  cwd    DIR  253,1     4096 2752513 /root</span></span>
<span class="line"><span style="color:#A6ACCD;">tcpdump 17905 tcpdump  rtd    DIR  253,1     4096       2 /</span></span>
<span class="line"><span style="color:#A6ACCD;">tcpdump 17905 tcpdump  txt    REG  253,1   929928 1323976 /usr/sbin/tcpdump</span></span>
<span class="line"><span style="color:#A6ACCD;">tcpdump 17905 tcpdump  mem    REG  253,1    62184 1328951 /usr/lib64/libnss_files-2.17.so</span></span>
<span class="line"><span style="color:#A6ACCD;">tcpdump 17905 tcpdump  mem    REG    0,7           231120 socket:</span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">231120</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">stat: No such file or directory</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">tcpdump 17905 tcpdump  mem    REG  253,1    90664 1311459 /usr/lib64/libz.so.1.2.7</span></span>
<span class="line"><span style="color:#A6ACCD;">tcpdump 17905 tcpdump  mem    REG  253,1    19776 1328757 /usr/lib64/libdl-2.17.so</span></span>
<span class="line"><span style="color:#A6ACCD;">tcpdump 17905 tcpdump  mem    REG  253,1  2127336 1314561 /usr/lib64/libc-2.17.so</span></span>
<span class="line"><span style="color:#A6ACCD;">tcpdump 17905 tcpdump  mem    REG  253,1   266496 1312167 /usr/lib64/libpcap.so.1.5.3</span></span>
<span class="line"><span style="color:#A6ACCD;">tcpdump 17905 tcpdump  mem    REG  253,1  2512448 1312014 /usr/lib64/libcrypto.so.1.0.2k</span></span>
<span class="line"><span style="color:#A6ACCD;">tcpdump 17905 tcpdump  mem    REG  253,1    23968 1311919 /usr/lib64/libcap-ng.so.0.0.0</span></span>
<span class="line"><span style="color:#A6ACCD;">tcpdump 17905 tcpdump  mem    REG  253,1   164264 1311451 /usr/lib64/ld-2.17.so</span></span>
<span class="line"><span style="color:#A6ACCD;">tcpdump 17905 tcpdump    0u   CHR  136,1      0t0       4 /dev/pts/1</span></span>
<span class="line"><span style="color:#A6ACCD;">tcpdump 17905 tcpdump    1u   CHR  136,1      0t0       4 /dev/pts/1</span></span>
<span class="line"><span style="color:#A6ACCD;">tcpdump 17905 tcpdump    2u   CHR  136,1      0t0       4 /dev/pts/1</span></span>
<span class="line"><span style="color:#A6ACCD;">tcpdump 17905 tcpdump    3u  pack 231120      0t0     ALL type=SOCK_RAW</span></span>
<span class="line"><span style="color:#A6ACCD;">tcpdump 17905 tcpdump    4w   REG  253,1   864256 2756467 /root/abc2</span></span>
<span class="line"></span></code></pre></div><h2 id="_25-fuser-\u67E5\u627E\u8BBF\u95EE\u6587\u4EF6\u7CFB\u7EDF\u7684\u8FDB\u7A0B" tabindex="-1">25. fuser \u67E5\u627E\u8BBF\u95EE\u6587\u4EF6\u7CFB\u7EDF\u7684\u8FDB\u7A0B <a class="header-anchor" href="#_25-fuser-\u67E5\u627E\u8BBF\u95EE\u6587\u4EF6\u7CFB\u7EDF\u7684\u8FDB\u7A0B" aria-hidden="true">#</a></h2><p><code>-v</code> \u663E\u793A\u5177\u4F53\u7684\u8FDB\u7A0B\u540D\u548C\u7528\u6237</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ fuser -v /</span></span>
<span class="line"><span style="color:#A6ACCD;">                     USER        PID ACCESS COMMAND</span></span>
<span class="line"><span style="color:#A6ACCD;">/:                   root     kernel mount /</span></span>
<span class="line"><span style="color:#A6ACCD;">                     root          1 .rc.. systemd</span></span>
<span class="line"><span style="color:#A6ACCD;">                     root          2 .rc.. kthreadd</span></span>
<span class="line"><span style="color:#A6ACCD;">                     root          3 .rc.. ksoftirqd/0</span></span>
<span class="line"><span style="color:#A6ACCD;">                     root          5 .rc.. kworker/0:0H</span></span>
<span class="line"></span></code></pre></div><p><code>-k</code> kill\u6389\u8BBF\u95EE\u8BE5\u6587\u4EF6\u7CFB\u7EDF\u7684\u6240\u6709\u8FDB\u7A0B.\u614E\u7528. \u5148\u4F7F\u7528\u4E0A\u8FF0\u547D\u4EE4\u67E5\u8BE2</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">fuser -k /</span></span>
<span class="line"></span></code></pre></div><h2 id="_26-dd-\u6D4B\u8BD5\u78C1\u76D8\u6216\u8005\u6587\u4EF6\u8BFB\u5199" tabindex="-1">26. dd \u6D4B\u8BD5\u78C1\u76D8\u6216\u8005\u6587\u4EF6\u8BFB\u5199 <a class="header-anchor" href="#_26-dd-\u6D4B\u8BD5\u78C1\u76D8\u6216\u8005\u6587\u4EF6\u8BFB\u5199" aria-hidden="true">#</a></h2><p>\u9AD8\u5371\u547D\u4EE4, <code>of</code>\u4E00\u5B9A\u8981\u6307\u5411\u6B63\u786E\u7684\u6587\u4EF6, \u4E0D\u8981\u6307 <code>/</code>, <code>/dev/vda</code>, <code>/dev/vda1</code>\u7B49\u7CFB\u7EDF\u91CD\u8981\u8BBE\u5907.<br> \u8BE5\u547D\u4EE4\u8981\u5728\u6D4B\u8BD5\u73AF\u5883\u9A8C\u8BC1\u5145\u5206.<br><code>if</code> \u8868\u793A\u4ECE\u54EA\u4E2A\u8BBE\u5907/\u6587\u4EF6\u8BFB<br><code>of</code> \u8868\u793A\u5199\u5230\u54EA\u4E2A\u8BBE\u5907/\u6587\u4EF6<br><code>bs</code> \u8868\u793A\u4E00\u6B21\u8BFB\u5199\u591A\u5C11\u5B57\u8282. \u4E5F\u53EF\u4EE5\u4F7F\u7528 1K, 1M\u8FD9\u6837\u5E26\u5355\u4F4D\u7684<br><code>count</code> \u8868\u793A\u6700\u591A\u8BFB\u5199\u591A\u5C11\u6B21. \u603B\u7684\u8BFB\u5199\u91CF\u4E3A <code>bs * count</code><br><code>/dev/zero</code> \u53EF\u4EE5\u65E0\u9650\u8BFB\u53D6<code>\\0</code></p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">dd if=/dev/zero of=/tmp/abc.txt bs=1M count=10</span></span>
<span class="line"></span></code></pre></div><h2 id="_27-rpm-\u5B89\u88C5-\u66F4\u65B0-\u5378\u8F7D\u8F6F\u4EF6\u5305" tabindex="-1">27. rpm \u5B89\u88C5/\u66F4\u65B0/\u5378\u8F7D\u8F6F\u4EF6\u5305 <a class="header-anchor" href="#_27-rpm-\u5B89\u88C5-\u66F4\u65B0-\u5378\u8F7D\u8F6F\u4EF6\u5305" aria-hidden="true">#</a></h2><p>\u67E5\u8BE2\u7CFB\u7EDF\u5DF2\u5B89\u88C5\u7684\u6240\u6709\u8F6F\u4EF6\u5305</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">rpm -qa</span></span>
<span class="line"></span></code></pre></div><p>\u67E5\u8BE2\u67D0\u4E2A\u6587\u4EF6\u6240\u5C5E\u7684\u8F6F\u4EF6\u5305\u540D. \u6587\u4EF6\u5FC5\u987B\u662F\u7EDD\u5BF9\u8DEF\u5F84</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">rpm -qf /etc/ssh/sshd_config</span></span>
<span class="line"></span></code></pre></div><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">rpm -qf </span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">which strace</span><span style="color:#89DDFF;">\`</span></span>
<span class="line"></span></code></pre></div><p>\u67E5\u8BE2\u5305\u6240\u542B\u6709\u7684\u6587\u4EF6</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">rpm -ql strace</span></span>
<span class="line"></span></code></pre></div><p>\u67E5\u8BE2\u5305\u91CC\u7684\u914D\u7F6E\u6587\u4EF6</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">rpm -qc openssh-server</span></span>
<span class="line"></span></code></pre></div><p>\u67E5\u8BE2\u5305\u91CC\u7684\u6587\u6863</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">rpm -qd openssh-server</span></span>
<span class="line"></span></code></pre></div><p>\u67E5\u8BE2\u8F6F\u4EF6\u5305\u91CC\u7684\u811A\u672C\u4FE1\u606F</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ rpm -q --scripts openssh-server</span></span>
<span class="line"><span style="color:#A6ACCD;">preinstall scriptlet </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">using /bin/sh</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">getent group sshd </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">/dev/null </span><span style="color:#89DDFF;">||</span><span style="color:#A6ACCD;"> groupadd -g 74 -r sshd </span><span style="color:#89DDFF;">||</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">getent passwd sshd </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">/dev/null </span><span style="color:#89DDFF;">||</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">  useradd -c </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Privilege-separated SSH</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> -u 74 -g sshd \\</span></span>
<span class="line"><span style="color:#A6ACCD;">  -s /sbin/nologin -r -d /var/empty/sshd sshd </span><span style="color:#89DDFF;">2&gt;</span><span style="color:#A6ACCD;"> /dev/null </span><span style="color:#89DDFF;">||</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">postinstall scriptlet </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">using /bin/sh</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">1 </span><span style="color:#89DDFF;">-eq</span><span style="color:#A6ACCD;"> 1 </span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">then</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;"># Initial installation</span></span>
<span class="line"><span style="color:#A6ACCD;">        systemctl preset sshd.service sshd.socket </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">/dev/null </span><span style="color:#89DDFF;">2&gt;&amp;1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">||</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">fi</span></span>
<span class="line"><span style="color:#A6ACCD;">preuninstall scriptlet </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">using /bin/sh</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">1 </span><span style="color:#89DDFF;">-eq</span><span style="color:#A6ACCD;"> 0 </span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">then</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;"># Package removal, not upgrade</span></span>
<span class="line"><span style="color:#A6ACCD;">        systemctl --no-reload disable sshd.service sshd.socket </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> /dev/null </span><span style="color:#89DDFF;">2&gt;&amp;1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">||</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">        systemctl stop sshd.service sshd.socket </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> /dev/null </span><span style="color:#89DDFF;">2&gt;&amp;1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">||</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">fi</span></span>
<span class="line"><span style="color:#A6ACCD;">postuninstall scriptlet </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">using /bin/sh</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">systemctl daemon-reload </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">/dev/null </span><span style="color:#89DDFF;">2&gt;&amp;1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">||</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">1 </span><span style="color:#89DDFF;">-ge</span><span style="color:#A6ACCD;"> 1 </span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">then</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;"># Package upgrade, not uninstall</span></span>
<span class="line"><span style="color:#A6ACCD;">        systemctl try-restart sshd.service </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">/dev/null </span><span style="color:#89DDFF;">2&gt;&amp;1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">||</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">:</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">fi</span></span>
<span class="line"></span></code></pre></div><p>\u67E5\u8BE2\u5305,\u81EA\u5B9A\u4E49\u8F93\u51FA\u7684\u683C\u5F0F\u548C\u5730\u6BB5</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">rpm -qa --queryformat </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">%-35{NAME} %{VERSION} %{RELEASE} %{INSTALLTIME:date}\\n</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">jzlib                               1.1.1 6.el7 Thu 27 Jun 2019 11:30:01 AM HKT</span></span>
<span class="line"><span style="color:#A6ACCD;">nss                                 3.36.0 7.1.el7_6 Tue 11 Jun 2019 11:13:42 PM HKT</span></span>
<span class="line"><span style="color:#A6ACCD;">hamcrest                            1.3 6.el7 Thu 27 Jun 2019 11:30:01 AM HKT</span></span>
<span class="line"><span style="color:#A6ACCD;">dhcp-libs                           4.2.5 68.el7.centos.1 Tue 11 Jun 2019 11:13:43 PM HKT</span></span>
<span class="line"></span></code></pre></div><p>\u67E5\u8BE2\u5F53\u524D\u5305\u7684changelog. \u5E38\u7528\u4E8E\u67E5\u770B\u5DF2\u89E3\u51B3\u7684CVE\u5217\u8868</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">rpm -q --changelog openssh-server</span></span>
<span class="line"></span></code></pre></div><p>\u67E5\u8BE2\u5305\u6240\u80FD\u63D0\u4F9B\u7684CAPABILITY</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">rpm -q --provides glibc</span></span>
<span class="line"></span></code></pre></div><p>\u67E5\u8BE2\u54EA\u4E9B\u5305\u4F9D\u8D56\u67D0\u4E2ACAPABILITY</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">rpm -q --whatrequires </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">CAPABILITY</span><span style="color:#89DDFF;">]</span></span>
<span class="line"></span></code></pre></div><p>\u67E5\u8BE2\u5305\u6240\u4F9D\u8D56\u7684CAPABILITY</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">rpm -q -R glibc</span></span>
<span class="line"></span></code></pre></div><p>\u67E5\u8BE2\u5305\u6240\u6709\u63D0\u4F9B\u7684CAPABILITY</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">rpm -q --whatprovides </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">CAPABILITY</span><span style="color:#89DDFF;">]</span></span>
<span class="line"></span></code></pre></div><p>\u6821\u9A8C\u5F53\u524D\u5305\u4E0E\u539F\u59CB\u72B6\u6001\u7684\u5DEE\u522B.<br> 5 -- MD5 \u6821\u9A8C\u548C<br> S -- \u6587\u4EF6\u957F\u5EA6<br> L -- \u7B26\u53F7\u94FE\u63A5<br> T -- \u6587\u4EF6\u4FEE\u6539\u65E5\u671F<br> D -- \u8BBE\u5907<br> U -- \u7528\u6237<br> G -- \u7528\u6237\u7EC4<br> M -- \u6A21\u5F0F (\u5305\u542B\u8BB8\u53EF\u548C\u6587\u4EF6\u7C7B\u578B)<br> ? -- \u4E0D\u53EF\u8BFB\u6587\u4EF6<br> \u5982\u4E0B\u6807\u5FD7\u6587\u4EF6\u7684md5, \u6587\u4EF6\u957F\u5EA6, \u4FEE\u6539\u65E5\u5FD7\u6709\u53D8\u5316</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ rpm  -V openssh-server</span></span>
<span class="line"><span style="color:#A6ACCD;">S.5....T.  c /etc/ssh/sshd_config</span></span>
<span class="line"></span></code></pre></div><p>\u5B89\u88C5\u672C\u5730\u5305 <code>-vh</code> \u83B7\u5F97\u4E00\u4E2A\u8BE6\u7EC6\u7684\u5B89\u88C5\u8FDB\u7A0B <code>--nodeps</code> \u5FFD\u7565\u4F9D\u8D56\u5173\u7CFB</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">rpm -ivh abc.rpm</span></span>
<span class="line"></span></code></pre></div><p>\u5378\u8F7D\u5305</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">rpm -e abc.rpm</span></span>
<span class="line"></span></code></pre></div><p>\u5347\u7EA7\u5305</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">rpm -Uvh abc.rpm</span></span>
<span class="line"></span></code></pre></div><p>\u67E5\u8BE2\u672C\u5730\u5305\u7684\u4FE1\u606F,\u8981\u52A0<code>-p</code></p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">rpm -ql -p abc.rpm</span></span>
<span class="line"></span></code></pre></div><h2 id="_28-yum-\u5B89\u88C5-\u66F4\u65B0-\u5378\u8F7D\u8F6F\u4EF6\u5305" tabindex="-1">28. yum \u5B89\u88C5/\u66F4\u65B0/\u5378\u8F7D\u8F6F\u4EF6\u5305 <a class="header-anchor" href="#_28-yum-\u5B89\u88C5-\u66F4\u65B0-\u5378\u8F7D\u8F6F\u4EF6\u5305" aria-hidden="true">#</a></h2><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">yum install a            </span><span style="color:#676E95;font-style:italic;">#\u5B89\u88C5\u8F6F\u4EF6\u5305a   (\u52A0\u4E0A-y\u9009\u9879\uFF0C\u53EF\u4EE5\u5728\u5B89\u88C5\u8F6F\u4EF6\u5305\u65F6\uFF0C\u4E0D\u5F39\u51FA\u662F\u5426\u7EE7\u7EED\u7684\u63D0\u793A)</span></span>
<span class="line"><span style="color:#A6ACCD;">yum install xxx --downloadonly --downloaddir=/xxx  </span><span style="color:#676E95;font-style:italic;">#\u53EA\u4E0B\u8F7D,\u4E0D\u5B89\u88C5.</span></span>
<span class="line"><span style="color:#A6ACCD;">yum reinstall xxx        </span><span style="color:#676E95;font-style:italic;">#\u91CD\u88C5</span></span>
<span class="line"><span style="color:#A6ACCD;">yum remove a             </span><span style="color:#676E95;font-style:italic;">#\u5378\u8F7D\u8F6F\u4EF6\u5305a</span></span>
<span class="line"><span style="color:#A6ACCD;">yum groups list          </span><span style="color:#676E95;font-style:italic;">#\u67E5\u770B\u5DF2\u5B89\u88C5\u7684\u8F6F\u4EF6\u7EC4\u548C\u53EF\u7528\u7684\u8F6F\u4EF6\u7EC4</span></span>
<span class="line"><span style="color:#A6ACCD;">yum groups  install </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Basic Web Server</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">#\u5B89\u88C5\u8F6F\u4EF6\u7EC4</span></span>
<span class="line"><span style="color:#A6ACCD;">yum groups remove </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Basic Web Server</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">      </span><span style="color:#676E95;font-style:italic;">#\u5378\u8F7D\u8F6F\u4EF6\u7EC4</span></span>
<span class="line"><span style="color:#A6ACCD;">yum info a               </span><span style="color:#676E95;font-style:italic;">#\u67E5\u770B\u8F6F\u4EF6\u5305a\u7684\u76F8\u5173\u4FE1\u606F\uFF0C\u5982\u5927\u5C0F\uFF0C\u7248\u672C\u7B49...</span></span>
<span class="line"><span style="color:#A6ACCD;">yum update a             </span><span style="color:#676E95;font-style:italic;">#\u66F4\u65B0\u8F6F\u4EF6\u5305a</span></span>
<span class="line"><span style="color:#A6ACCD;">yum update               </span><span style="color:#676E95;font-style:italic;">#\u6574\u4F53\u66F4\u65B0\u6240\u6709\u53EF\u66F4\u65B0\u7684\u8F6F\u4EF6\u5305</span></span>
<span class="line"><span style="color:#A6ACCD;">yum provides \u6587\u4EF6\u6216\u76EE\u5F55    </span><span style="color:#676E95;font-style:italic;">#\u67E5\u770B\u6587\u4EF6\u7531\u54EA\u4E2Arpm\u5305\u63D0\u4F9B\u7684</span></span>
<span class="line"><span style="color:#A6ACCD;">yum search tree          </span><span style="color:#676E95;font-style:italic;">#\u4ECE\u4ED3\u5E93\u4E2D\u641C\u7D22\u5173\u952E\u8BCD\u4E3Atree\u7684\u5305</span></span>
<span class="line"><span style="color:#A6ACCD;">yum </span><span style="color:#82AAFF;">history</span><span style="color:#A6ACCD;">              </span><span style="color:#676E95;font-style:italic;">#\u67E5\u770Byum\u8FD0\u884C\u5386\u53F2\u8BB0\u5F55</span></span>
<span class="line"></span></code></pre></div><blockquote><p>\u67E5\u627E\u67D0\u4E2A\u6587\u4EF6\u5C5E\u4E8E\u54EA\u4E2A\u5305\u7684\u65B9\u6CD5\u6709:<br> \u5982\u679C\u6587\u4EF6\u5DF2\u7ECF\u5B89\u88C5\u5728\u672C\u673A, \u5219<code>rpm -qf xxx</code><br> \u5982\u679C\u6587\u4EF6\u6CA1\u6709\u5728\u672C\u673A\u5B89\u88C5, \u5219<code>yum provides XXX</code> XXX \u53EF\u4EE5\u662F\u6587\u4EF6\u540D, \u4E5F\u53EF\u4EE5\u4F7F\u7528glob\u8FD9\u6837\u7684\u901A\u914D\u7B26\u53BB\u67E5\u627E<br> \u6BD4\u5982\u5B89\u88C5\u67D0rpm\u5305, \u63D0\u793A\u6587\u4EF6\u6CA1\u627E\u5230, \u5219\u53EF\u4EE5\u4F7F\u7528 <code>yum provices xxx</code>. \u6BD4\u5982\u6587\u4EF6\u540D\u4E3A abc.txt, \u7528<code>yum provides *abc.txt</code>\u53BB\u67E5\u627E</p></blockquote><p>\u67E5\u8BE2\u5F53\u524D\u5728repo\u91CC\u6307\u5B9A\u5305\u7684\u6240\u6709\u53EF\u7528\u7248\u672C, \u53EF\u7528\u4E8E\u5347\u7EA7\u5230\u7279\u5B9A\u7248\u672C. <code>yum update systemd</code>\u9ED8\u8BA4\u5347\u7EA7\u5230\u6700\u65B0\u7248</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ yum list --showduplicates systemd</span></span>
<span class="line"><span style="color:#A6ACCD;">Installed Packages</span></span>
<span class="line"><span style="color:#A6ACCD;">systemd.x86_64                  219-42.el7_4.1                  @updates</span></span>
<span class="line"><span style="color:#A6ACCD;">Available Packages</span></span>
<span class="line"><span style="color:#A6ACCD;">systemd.x86_64                  219-42.el7                      base</span></span>
<span class="line"><span style="color:#A6ACCD;">systemd.x86_64                  219-42.el7_4.1                  updates</span></span>
<span class="line"><span style="color:#A6ACCD;">systemd.x86_64                  219-42.el7_4.4                  updates</span></span>
<span class="line"></span></code></pre></div><p>\u5347\u7EA7\u6307\u5B9A\u5305\u5230\u7279\u5B9A\u7684\u7248\u672C</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">yum install systemd-219-42.el7_4.4</span></span>
<span class="line"></span></code></pre></div><p>\u5177\u4F53\u67E5\u770B\u67D0\u6B21\u4E8B\u52A1\u4E2D\u5B89\u88C5,\u66F4\u65B0,\u5220\u9664\u7684\u5305\u5217\u8868</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ yum </span><span style="color:#82AAFF;">history</span><span style="color:#A6ACCD;"> info 307</span></span>
<span class="line"><span style="color:#A6ACCD;">Loaded plugins: auto-update-debuginfo, fastestmirror</span></span>
<span class="line"><span style="color:#A6ACCD;">Transaction ID </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> 307</span></span>
<span class="line"><span style="color:#A6ACCD;">Begin </span><span style="color:#F78C6C;">time</span><span style="color:#A6ACCD;">     </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> Sat Dec  9 20:24:11 2017</span></span>
<span class="line"><span style="color:#A6ACCD;">Begin rpmdb    </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> 700:b36eb7acc22b3ab4b107097d0b740dc6bfd84a58</span></span>
<span class="line"><span style="color:#A6ACCD;">End </span><span style="color:#F78C6C;">time</span><span style="color:#A6ACCD;">       </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;">            20:24:12 2017 </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">1 seconds</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">End rpmdb      </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> 701:df2089f95d28d6f1f19561b39352bf3dd7a98c75</span></span>
<span class="line"><span style="color:#A6ACCD;">User           </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> root </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">root</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">Return-Code    </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> Success</span></span>
<span class="line"><span style="color:#A6ACCD;">Command Line   </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;"> install qemu-kvm</span></span>
<span class="line"><span style="color:#A6ACCD;">Transaction performed with:</span></span>
<span class="line"><span style="color:#A6ACCD;">    Installed     rpm-4.11.3-25.el7.x86_64                      @base</span></span>
<span class="line"><span style="color:#A6ACCD;">    Installed     yum-3.4.3-154.el7.centos.noarch               @base</span></span>
<span class="line"><span style="color:#A6ACCD;">    Installed     yum-plugin-fastestmirror-1.1.31-42.el7.noarch @base</span></span>
<span class="line"><span style="color:#A6ACCD;">Packages Altered:</span></span>
<span class="line"><span style="color:#A6ACCD;">    Updated qemu-img-10:1.5.3-141.el7_4.2.x86_64        @updates</span></span>
<span class="line"><span style="color:#A6ACCD;">    Update           10:1.5.3-141.el7_4.4.x86_64        @updates</span></span>
<span class="line"><span style="color:#A6ACCD;">    Install qemu-kvm-10:1.5.3-141.el7_4.4.x86_64        @updates</span></span>
<span class="line"><span style="color:#A6ACCD;">    Updated qemu-kvm-common-10:1.5.3-141.el7_4.2.x86_64 @updates</span></span>
<span class="line"><span style="color:#A6ACCD;">    Update                  10:1.5.3-141.el7_4.4.x86_64 @updates</span></span>
<span class="line"><span style="color:#82AAFF;">history</span><span style="color:#A6ACCD;"> info</span></span>
<span class="line"></span></code></pre></div><p>\u67E5\u8BE2\u67D0\u4E2A\u8F6F\u4EF6\u5305\u7684\u6240\u6709\u5386\u53F2\u53D8\u66F4\u8BB0\u5F55</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ yum </span><span style="color:#82AAFF;">history</span><span style="color:#A6ACCD;"> list  cloud-init</span></span>
<span class="line"><span style="color:#A6ACCD;">Loaded plugins: auto-update-debuginfo, fastestmirror</span></span>
<span class="line"><span style="color:#A6ACCD;">ID     </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Command line             </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Date and </span><span style="color:#F78C6C;">time</span><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Action</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">s</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Altered</span></span>
<span class="line"><span style="color:#A6ACCD;">-------------------------------------------------------------------------------</span></span>
<span class="line"><span style="color:#A6ACCD;">   312 </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> erase cloud-init         </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> 2018-01-11 00:07 </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Erase          </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">    1</span></span>
<span class="line"><span style="color:#A6ACCD;">   311 </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> install cloud-init       </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> 2018-01-11 00:01 </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Install        </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">    1</span></span>
<span class="line"><span style="color:#A6ACCD;">   310 </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> erase cloud-init         </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> 2017-12-10 19:50 </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Erase          </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">    1</span></span>
<span class="line"><span style="color:#A6ACCD;">   309 </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> install cloud-init       </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> 2017-12-10 18:52 </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Install        </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">    1</span></span>
<span class="line"><span style="color:#A6ACCD;">   306 </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> erase cloud-init         </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> 2017-12-09 13:09 </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Erase          </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">    1</span></span>
<span class="line"><span style="color:#A6ACCD;">   301 </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> install cloud-init       </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> 2017-10-14 11:49 </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> Install        </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">    5</span></span>
<span class="line"><span style="color:#82AAFF;">history</span><span style="color:#A6ACCD;"> list</span></span>
<span class="line"></span></code></pre></div><p>\u67E5\u8BE2\u5305\u7684\u4F9D\u8D56\u5173\u7CFB</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ yum deplist strace</span></span>
<span class="line"><span style="color:#A6ACCD;">package: strace.x86_64 4.12-4.el7</span></span>
<span class="line"><span style="color:#A6ACCD;">  dependency: /bin/sh</span></span>
<span class="line"><span style="color:#A6ACCD;">   provider: bash.x86_64 4.2.46-29.el7_4</span></span>
<span class="line"><span style="color:#A6ACCD;">  dependency: libc.so.6</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">GLIBC_2.15</span><span style="color:#89DDFF;">)(</span><span style="color:#A6ACCD;">64bit</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">   provider: glibc.x86_64 2.17-196.el7_4.2</span></span>
<span class="line"><span style="color:#A6ACCD;">  dependency: </span><span style="color:#82AAFF;">libgcc_s.so.1</span><span style="color:#89DDFF;">()(</span><span style="color:#A6ACCD;">64bit</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">   provider: libgcc.x86_64 4.8.5-16.el7_4.1</span></span>
<span class="line"><span style="color:#A6ACCD;">  dependency: libgcc_s.so.1</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">GCC_3.0</span><span style="color:#89DDFF;">)(</span><span style="color:#A6ACCD;">64bit</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">   provider: libgcc.x86_64 4.8.5-16.el7_4.1</span></span>
<span class="line"><span style="color:#A6ACCD;">  dependency: libgcc_s.so.1</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">GCC_3.3.1</span><span style="color:#89DDFF;">)(</span><span style="color:#A6ACCD;">64bit</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">   provider: libgcc.x86_64 4.8.5-16.el7_4.1</span></span>
<span class="line"><span style="color:#A6ACCD;">  dependency: rtld</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">GNU_HASH</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">   provider: glibc.x86_64 2.17-196.el7_4.2</span></span>
<span class="line"><span style="color:#A6ACCD;">   provider: glibc.i686 2.17-196.el7_4.2</span></span>
<span class="line"></span></code></pre></div><h2 id="_29-\u89E3\u538B\u7F29\u547D\u4EE4" tabindex="-1">29. \u89E3\u538B\u7F29\u547D\u4EE4 <a class="header-anchor" href="#_29-\u89E3\u538B\u7F29\u547D\u4EE4" aria-hidden="true">#</a></h2><p>tar.gz</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">tar -xzvf abc.tar.gz               </span><span style="color:#676E95;font-style:italic;">#\u89E3\u538B\u7F29</span></span>
<span class="line"><span style="color:#A6ACCD;">tar -xzvf abc.tar.gz -C /path      </span><span style="color:#676E95;font-style:italic;">#\u89E3\u538B\u7F29\u5230\u5236\u52A8\u7684path\u76EE\u5F55\u4E0B</span></span>
<span class="line"><span style="color:#A6ACCD;">tar -tzvf abc.tar.gz               </span><span style="color:#676E95;font-style:italic;">#\u4E0D\u89E3\u538B,\u53EA\u67E5\u770B\u6587\u4EF6\u5217\u8868</span></span>
<span class="line"><span style="color:#A6ACCD;">tar -czvf abc.tar.gz a.txt b.txt   </span><span style="color:#676E95;font-style:italic;">#\u5C06 a.txt \u548C b.txt \u538B\u7F29\u4E3A abc.tar.gz</span></span>
<span class="line"></span></code></pre></div><p>.gz</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">gzip -d FileName.gz      </span><span style="color:#676E95;font-style:italic;">#\u89E3\u538B</span></span>
<span class="line"><span style="color:#A6ACCD;">gzip FileName            </span><span style="color:#676E95;font-style:italic;">#\u538B\u7F29</span></span>
<span class="line"></span></code></pre></div><p>.bz .bz2</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">bzip2 -d FileName.bz2    </span><span style="color:#676E95;font-style:italic;">#\u89E3\u538B</span></span>
<span class="line"></span></code></pre></div><p>.tar.bz .tar.bz2</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">tar jxvf FileName.tar.bz2 </span><span style="color:#676E95;font-style:italic;">#\u89E3\u538B</span></span>
<span class="line"></span></code></pre></div><p>.Z</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">uncompress FileName.Z    </span><span style="color:#676E95;font-style:italic;">#\u89E3\u538B</span></span>
<span class="line"><span style="color:#A6ACCD;">compress FileName        </span><span style="color:#676E95;font-style:italic;">#\u538B\u7F29</span></span>
<span class="line"></span></code></pre></div><p>.zip</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">unzip FileName.zip       </span><span style="color:#676E95;font-style:italic;">#\u89E3\u538B</span></span>
<span class="line"><span style="color:#A6ACCD;">zip FileName.zip DirName </span><span style="color:#676E95;font-style:italic;">#\u538B\u7F29</span></span>
<span class="line"></span></code></pre></div><p>.rar</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">rar x FileName.rar                </span><span style="color:#676E95;font-style:italic;">#\u89E3\u538B</span></span>
<span class="line"><span style="color:#A6ACCD;">rar a FileName.rar DirName        </span><span style="color:#676E95;font-style:italic;">#\u538B\u7F29</span></span>
<span class="line"></span></code></pre></div><p>.rpm</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">rpm2cpio FileName.rpm </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> cpio -div   </span><span style="color:#676E95;font-style:italic;">#\u89E3\u5305</span></span>
<span class="line"></span></code></pre></div><p>.deb</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">ar p FileName.deb data.tar.gz </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> tar -xzvf  </span><span style="color:#676E95;font-style:italic;">#\u89E3\u5305</span></span>
<span class="line"></span></code></pre></div><h2 id="_30-systemd-\u7BA1\u7406\u547D\u4EE4" tabindex="-1">30. systemd \u7BA1\u7406\u547D\u4EE4 <a class="header-anchor" href="#_30-systemd-\u7BA1\u7406\u547D\u4EE4" aria-hidden="true">#</a></h2><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">systemctl    -t </span><span style="color:#82AAFF;">help</span><span style="color:#A6ACCD;">            </span><span style="color:#676E95;font-style:italic;">#\u5217\u51FA\u6240\u6709\u7684\u5355\u5143\u7C7B\u578B</span></span>
<span class="line"><span style="color:#A6ACCD;">systemctl --type </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">unit</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">         </span><span style="color:#676E95;font-style:italic;">#\u67E5\u770B\u6307\u5B9A\u5355\u5143\u7C7B\u578B\u7684\u72B6\u51B5, \u66FF\u6362 unit \u4E3A &quot;mount&quot;, &quot;service&quot;, &quot;socket&quot;\u7B49</span></span>
<span class="line"><span style="color:#A6ACCD;">systemctl --failed              </span><span style="color:#676E95;font-style:italic;">#\u67E5\u770B\u6240\u6709\u52A0\u8F7D\u5931\u8D25\u7684\u5355\u5143\u4FE1\u606F</span></span>
<span class="line"><span style="color:#A6ACCD;">systemctl status sshd           </span><span style="color:#676E95;font-style:italic;">#\u67E5\u770Bsshd\u670D\u52A1\u5355\u5143\u72B6\u51B5</span></span>
<span class="line"><span style="color:#A6ACCD;">systemctl start sshd            </span><span style="color:#676E95;font-style:italic;">#\u542F\u52A8sshd\u670D\u52A1\u5355\u5143</span></span>
<span class="line"><span style="color:#A6ACCD;">systemctl stop sshd             </span><span style="color:#676E95;font-style:italic;">#\u505C\u6B62sshd\u670D\u52A1\u5355\u5143</span></span>
<span class="line"><span style="color:#A6ACCD;">systemctl restart sshd          </span><span style="color:#676E95;font-style:italic;">#\u91CD\u542Fsshd\u670D\u52A1\u5355\u5143</span></span>
<span class="line"><span style="color:#A6ACCD;">systemctl </span><span style="color:#82AAFF;">enable</span><span style="color:#A6ACCD;"> sshd           </span><span style="color:#676E95;font-style:italic;">#\u914D\u7F6Esshd\u670D\u52A1\u5355\u5143\u5F00\u673A\u81EA\u52A8\u542F\u52A8</span></span>
<span class="line"><span style="color:#A6ACCD;">systemctl disable sshd          </span><span style="color:#676E95;font-style:italic;">#\u914D\u7F6Esshd\u670D\u52A1\u5355\u5143\u5F00\u673A\u4E0D\u542F\u52A8</span></span>
<span class="line"><span style="color:#A6ACCD;">systemctl reload sshd           </span><span style="color:#676E95;font-style:italic;">#\u91CD\u65B0\u52A0\u8F7Dsshd\u670D\u52A1\u5355\u5143\u7684\u914D\u7F6E\u6587\u4EF6</span></span>
<span class="line"><span style="color:#A6ACCD;">systemctl mask sshd             </span><span style="color:#676E95;font-style:italic;">#\u5F7B\u5E95\u5C4F\u853Dsshd\u670D\u52A1\u5355\u5143</span></span>
<span class="line"><span style="color:#A6ACCD;">systemctl unmask sshd           </span><span style="color:#676E95;font-style:italic;">#\u53D6\u6D88\u5C4F\u853Dsshd\u670D\u52A1\u5355\u5143</span></span>
<span class="line"><span style="color:#A6ACCD;">systemctl list-units            </span><span style="color:#676E95;font-style:italic;">#\u5217\u51FA\u5F53\u524D\u6240\u6709\u7684\u5355\u5143, \u8FD9\u662F systemctl \u7684\u9ED8\u8BA4\u547D\u4EE4</span></span>
<span class="line"><span style="color:#A6ACCD;">systemctl get-default           </span><span style="color:#676E95;font-style:italic;">#\u67E5\u770B\u7CFB\u7EDF\u9ED8\u8BA4\u542F\u52A8\u7684Target</span></span>
<span class="line"><span style="color:#A6ACCD;">systemctl set-default multi-user.target  </span><span style="color:#676E95;font-style:italic;"># \u8BBE\u7F6E\u7CFB\u7EDF\u9ED8\u8BA4\u7684target\u4E3A \u591A\u7528\u6237\u6A21\u5F0F</span></span>
<span class="line"><span style="color:#A6ACCD;">systemctl list-dependencies multi-user.target  </span><span style="color:#676E95;font-style:italic;">#\u67E5\u770B\u8BE5target\u4E0B\u6240\u6709\u7684unit</span></span>
<span class="line"><span style="color:#A6ACCD;">systemctl list-dependencies sshd   </span><span style="color:#676E95;font-style:italic;"># \u67E5\u770B\u4E00\u4E2Aservice\u6240\u4F9D\u8D56\u7684\u6240\u6709unit</span></span>
<span class="line"><span style="color:#A6ACCD;">systemctl list-dependencies --reverse sshd   </span><span style="color:#676E95;font-style:italic;"># \u67E5\u770B\u54EA\u4E2Aunit\u4F9D\u8D56\u8BE5\u670D\u52A1</span></span>
<span class="line"><span style="color:#A6ACCD;">systemctl list-dependencies --before sshd   </span><span style="color:#676E95;font-style:italic;"># \u67E5\u770B\u6240\u6709unit after sshd, \u4E5F\u5C31\u662F sshd \u914D\u7F6E\u91CC\u7684before=</span></span>
<span class="line"><span style="color:#A6ACCD;">systemctl list-dependencies --after sshd   </span><span style="color:#676E95;font-style:italic;"># \u67E5\u770B\u6240\u6709unit before sshd</span></span>
<span class="line"><span style="color:#A6ACCD;">systemctl cat sshd              </span><span style="color:#676E95;font-style:italic;">#\u67E5\u770Bservice\u7684\u914D\u7F6E\u6587\u4EF6</span></span>
<span class="line"><span style="color:#A6ACCD;">systemctl show sshd             </span><span style="color:#676E95;font-style:italic;">#\u67E5\u770Bservice\u7684\u914D\u7F6E\u53C2\u6570, \u4E0D\u5E26 service\u5219\u663E\u793A\u9ED8\u8BA4\u7684\u914D\u7F6E. \u53EF\u7528\u6765\u67E5\u8BE2nofile, noproc\u7B49\u9650\u5236\u8D44\u6E90\u53C2\u6570</span></span>
<span class="line"><span style="color:#A6ACCD;">systemctl list-jobs             </span><span style="color:#676E95;font-style:italic;">#\u67E5\u770B\u6709\u54EA\u4E9Bjob\u4ECD\u5728\u8FD0\u884C\u6216\u8005\u7B49\u5F85\u8FD0\u884C</span></span>
<span class="line"></span></code></pre></div><blockquote><p>/etc/security/limits.conf\u65E0\u6CD5\u8BBE\u7F6Esystemd\u670D\u52A1\u7684\u8D44\u6E90\u9650\u5236. \u53C2\u89C1:<br><a href="http://smilejay.com/2016/06/centos-7-systemd-conf-limits/" target="_blank" rel="noopener noreferrer">http://smilejay.com/2016/06/centos-7-systemd-conf-limits/</a></p></blockquote><p>\u5217\u51FA\u5F53\u524D\u65E7\u7684LSB\u811A\u672C</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ systemctl </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> grep LSB</span></span>
<span class="line"><span style="color:#A6ACCD;">  network.service       loaded active running   LSB: Bring up/down networking</span></span>
<span class="line"><span style="color:#A6ACCD;">  prl-x11.service       loaded active exited    LSB: Autostart script </span><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#A6ACCD;"> Parallels service</span></span>
<span class="line"><span style="color:#A6ACCD;">  prltoolsd.service     loaded active running   LSB: Autostart script </span><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#A6ACCD;"> guest tools service.</span></span>
<span class="line"></span></code></pre></div><p>\u67E5\u8BE2systemd \u7248\u672C</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ systemctl --version</span></span>
<span class="line"><span style="color:#A6ACCD;">systemd 219</span></span>
<span class="line"><span style="color:#A6ACCD;">+PAM +AUDIT +SELINUX +IMA -APPARMOR +SMACK +SYSVINIT +UTMP +LIBCRYPTSETUP +GCRYPT +GNUTLS +ACL +XZ -LZ4 -SECCOMP +BLKID +ELFUTILS +KMOD +IDN</span></span>
<span class="line"></span></code></pre></div><p>\u67E5\u770B\u542F\u52A8\u8017\u65F6</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ systemd-analyze</span></span>
<span class="line"><span style="color:#A6ACCD;">Startup finished </span><span style="color:#89DDFF;font-style:italic;">in</span><span style="color:#A6ACCD;"> 579ms </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">kernel</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> + 2.964s </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">initrd</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> + 8.899s </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">userspace</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> = 12.442s</span></span>
<span class="line"></span></code></pre></div><p>\u67E5\u770B\u6BCF\u4E2A\u670D\u52A1\u7684\u542F\u52A8\u8017\u65F6,\u5E76\u6253\u5370TOP5</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ systemd-analyze blame </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> head -5</span></span>
<span class="line"><span style="color:#A6ACCD;">          4.949s NetworkManager-wait-online.service</span></span>
<span class="line"><span style="color:#A6ACCD;">          3.379s network.service</span></span>
<span class="line"><span style="color:#A6ACCD;">           987ms postfix.service</span></span>
<span class="line"><span style="color:#A6ACCD;">           656ms dev-mapper-VolGroup\\x2dlv_root.device</span></span>
<span class="line"><span style="color:#A6ACCD;">           591ms lvm2-monitor.service</span></span>
<span class="line"></span></code></pre></div><p>\u6253\u5370\u6700\u8017\u65F6\u7684\u4E00\u6761\u542F\u52A8\u94FE, \u540E\u9762\u8DDF\u6307\u5B9A\u7684service, \u5219\u6253\u5370\u8BE5\u670D\u52A1\u7684\u542F\u52A8\u94FE</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ systemd-analyze critical-chain</span></span>
<span class="line"><span style="color:#A6ACCD;">The </span><span style="color:#F78C6C;">time</span><span style="color:#A6ACCD;"> after the unit is active or started is printed after the </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">@</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> character.</span></span>
<span class="line"><span style="color:#A6ACCD;">The </span><span style="color:#F78C6C;">time</span><span style="color:#A6ACCD;"> the unit takes to start is printed after the </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">+</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> character.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">multi-user.target @8.863s</span></span>
<span class="line"><span style="color:#A6ACCD;">\u2514\u2500postfix.service @7.864s +987ms</span></span>
<span class="line"><span style="color:#A6ACCD;">  \u2514\u2500network.target @7.856s</span></span>
<span class="line"><span style="color:#A6ACCD;">    \u2514\u2500NetworkManager.service @2.459s +64ms</span></span>
<span class="line"><span style="color:#A6ACCD;">      \u2514\u2500network-pre.target @2.458s</span></span>
<span class="line"><span style="color:#A6ACCD;">        \u2514\u2500firewalld.service @1.934s +523ms</span></span>
<span class="line"><span style="color:#A6ACCD;">          \u2514\u2500polkit.service @1.724s +203ms</span></span>
<span class="line"><span style="color:#A6ACCD;">            \u2514\u2500basic.target @1.721s</span></span>
<span class="line"><span style="color:#A6ACCD;">              \u2514\u2500sockets.target @1.721s</span></span>
<span class="line"><span style="color:#A6ACCD;">                \u2514\u2500iscsiuio.socket @1.721s</span></span>
<span class="line"><span style="color:#A6ACCD;">                  \u2514\u2500sysinit.target @1.709s</span></span>
<span class="line"><span style="color:#A6ACCD;">                    \u2514\u2500systemd-update-utmp.service @1.700s +8ms</span></span>
<span class="line"><span style="color:#A6ACCD;">                      \u2514\u2500auditd.service @1.426s +272ms</span></span>
<span class="line"><span style="color:#A6ACCD;">                        \u2514\u2500systemd-tmpfiles-setup.service @1.358s +58ms</span></span>
<span class="line"><span style="color:#A6ACCD;">                          \u2514\u2500rhel-import-state.service @1.303s +52ms</span></span>
<span class="line"><span style="color:#A6ACCD;">                            \u2514\u2500local-fs.target @1.299s</span></span>
<span class="line"><span style="color:#A6ACCD;">                              \u2514\u2500home.mount @1.283s +15ms</span></span>
<span class="line"><span style="color:#A6ACCD;">                                \u2514\u2500systemd-fsck@dev-mapper-VolGroup\\x2dlv_home.service @1.266s +14ms</span></span>
<span class="line"><span style="color:#A6ACCD;">                                  \u2514\u2500dev-mapper-VolGroup\\x2dlv_home.device @1.265s</span></span>
<span class="line"></span></code></pre></div><p>\u751F\u6210\u542F\u52A8\u7011\u5E03\u56FE, \u4F7F\u7528chrome\u6D4F\u89C8\u5668\u6253\u5F00 a.svg. \u5206\u6790\u542F\u52A8\u6027\u80FD\u66F4\u52A0\u76F4\u89C2</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">systemd-analyze plot </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">a.svg</span></span>
<span class="line"></span></code></pre></div><p>\u542F\u52A8\u7011\u5E03\u56FE<br><img src="`+p+`" alt="\u542F\u52A8\u7011\u5E03\u56FE"></p><p>journalctl \u76F8\u5173\u64CD\u4F5C</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">journalctl                       </span><span style="color:#676E95;font-style:italic;"># \u67E5\u770B\u6240\u6709\u65E5\u5FD7\uFF08\u9ED8\u8BA4\u60C5\u51B5\u4E0B \uFF0C\u663E\u793A\u6240\u6709\u53EF\u4EE5\u67E5\u770B\u7684\u65E5\u5FD7\uFF09</span></span>
<span class="line"><span style="color:#A6ACCD;">journalctl -k                    </span><span style="color:#676E95;font-style:italic;"># \u67E5\u770B\u5185\u6838\u65E5\u5FD7\uFF08\u4E0D\u663E\u793A\u5E94\u7528\u65E5\u5FD7\uFF09</span></span>
<span class="line"><span style="color:#A6ACCD;">journalctl -b                    </span><span style="color:#676E95;font-style:italic;"># \u67E5\u770B\u7CFB\u7EDF\u672C\u6B21\u542F\u52A8\u7684\u65E5\u5FD7                 </span></span>
<span class="line"><span style="color:#A6ACCD;">journalctl -b -1                 </span><span style="color:#676E95;font-style:italic;"># \u67E5\u770B\u4E0A\u4E00\u6B21\u542F\u52A8\u7684\u65E5\u5FD7\uFF08\u9700\u66F4\u6539\u8BBE\u7F6E\uFF09</span></span>
<span class="line"><span style="color:#A6ACCD;">journalctl -f               </span><span style="color:#676E95;font-style:italic;"># \u5B9E\u65F6\u6EDA\u52A8\u663E\u793A\u6700\u65B0\u65E5\u5FD7</span></span>
<span class="line"><span style="color:#A6ACCD;">journalctl /usr/lib/systemd/systemd </span><span style="color:#676E95;font-style:italic;"># \u67E5\u770B\u6307\u5B9A\u53EF\u6267\u884C\u6587\u4EF6\u7684\u65E5\u5FD7, \u5FC5\u987B\u6307\u5B9A\u7EDD\u5BF9\u8DEF\u5F84</span></span>
<span class="line"><span style="color:#A6ACCD;">journalctl _PID=1                </span><span style="color:#676E95;font-style:italic;"># \u67E5\u770B\u6307\u5B9A\u8FDB\u7A0B\u7684\u65E5\u5FD7</span></span>
<span class="line"><span style="color:#A6ACCD;">journalctl -u sshd               </span><span style="color:#676E95;font-style:italic;"># \u67E5\u770B\u67D0\u4E2A Unit \u7684\u65E5\u5FD7</span></span>
<span class="line"><span style="color:#A6ACCD;">journalctl --disk-usage          </span><span style="color:#676E95;font-style:italic;"># \u663E\u793A\u65E5\u5FD7\u5360\u636E\u7684\u786C\u76D8\u7A7A\u95F4</span></span>
<span class="line"><span style="color:#A6ACCD;">journalctl --list-boots          </span><span style="color:#676E95;font-style:italic;"># \u663E\u793A\u6BCF\u6B21\u542F\u52A8\u7684id\u548C\u65F6\u95F4</span></span>
<span class="line"></span></code></pre></div><p>\u67E5\u770B\u6307\u5B9A\u65F6\u95F4\u7684\u65E5\u5FD7</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">journalctl --since </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">2012-10-30 18:17:16</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">journalctl --since </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">2020-10-01</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">journalctl --since </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">20 min ago</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">journalctl --since </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">-5m</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">journalctl --since </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">-5d</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">journalctl --since yesterday</span></span>
<span class="line"><span style="color:#A6ACCD;">journalctl --since </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">2015-01-10</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> --until </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">2015-01-11 03:00</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">journalctl --since 09:00 --until </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1 hour ago</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre></div><p>\u65F6\u95F4\u683C\u5F0F\u53EF\u53C2\u8003<code>man journalctl</code>\u6216\u8005<code>man 7 systemd.time</code></p><h2 id="_31-ubuntu-debian-\u68C0\u67E5\u5DF2\u7ECF\u5B89\u88C5\u597D\u7684\u8F6F\u4EF6\u5305\u7684\u66F4\u65B0\u65E5\u5FD7" tabindex="-1">31. Ubuntu/Debian \u68C0\u67E5\u5DF2\u7ECF\u5B89\u88C5\u597D\u7684\u8F6F\u4EF6\u5305\u7684\u66F4\u65B0\u65E5\u5FD7 <a class="header-anchor" href="#_31-ubuntu-debian-\u68C0\u67E5\u5DF2\u7ECF\u5B89\u88C5\u597D\u7684\u8F6F\u4EF6\u5305\u7684\u66F4\u65B0\u65E5\u5FD7" aria-hidden="true">#</a></h2><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">zless /usr/share/doc/</span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">package -name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">/changelog.Debian.gz</span></span>
<span class="line"><span style="color:#A6ACCD;">zless /usr/share/doc/</span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">package -name</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">/changelog.gz</span></span>
<span class="line"></span></code></pre></div><h2 id="_32-\u641C\u7D22\u542B\u6709\u6307\u5B9A\u5B57\u7B26\u7684\u624B\u518C\u9875" tabindex="-1">32. \u641C\u7D22\u542B\u6709\u6307\u5B9A\u5B57\u7B26\u7684\u624B\u518C\u9875 <a class="header-anchor" href="#_32-\u641C\u7D22\u542B\u6709\u6307\u5B9A\u5B57\u7B26\u7684\u624B\u518C\u9875" aria-hidden="true">#</a></h2><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ man -k logrotate</span></span>
<span class="line"><span style="color:#A6ACCD;">dh_installlogrotate </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">1</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> - install logrotate config files</span></span>
<span class="line"><span style="color:#A6ACCD;">logrotate </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">8</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> - rotates, compresses, and mails system logs</span></span>
<span class="line"><span style="color:#A6ACCD;">logrotate.conf </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">5</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> - rotates, compresses, and mails system logs</span></span>
<span class="line"></span></code></pre></div><h2 id="_33-\u5FEB\u901F\u5220\u9664\u5927\u91CF\u5C0F\u6587\u4EF6" tabindex="-1">33. \u5FEB\u901F\u5220\u9664\u5927\u91CF\u5C0F\u6587\u4EF6 <a class="header-anchor" href="#_33-\u5FEB\u901F\u5220\u9664\u5927\u91CF\u5C0F\u6587\u4EF6" aria-hidden="true">#</a></h2><p>\u4F7F\u7528<code>rsync</code>, \u901F\u5EA6\u5FEB\u4F46\u5360\u7528\u5927\u91CFIO, \u4E1A\u52A1\u91CF\u4F4E\u65F6\u4F7F\u7528. \u9AD8\u5371\u547D\u4EE4</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">mkdir empty_dir</span></span>
<span class="line"><span style="color:#A6ACCD;">rsync -a --delete empty_dir/    yourdirectory/</span></span>
<span class="line"></span></code></pre></div><p>\u4F7F\u7528<code>find</code>, \u901F\u5EA6\u6162\u4F46\u6D88\u8017IO\u5C11. <code>rm</code>\u4F1A\u9047\u5230<code>Argument list too long</code>\u62A5\u9519</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">find /tmp -type f -exec rm {} \\;      </span><span style="color:#676E95;font-style:italic;">#\u5220\u9664/tmp\u76EE\u5F55\u4E0B\u6240\u6709\u6587\u4EF6</span></span>
<span class="line"></span></code></pre></div><h2 id="_34-sysctl-\u7BA1\u7406\u7CFB\u7EDF\u53C2\u6570" tabindex="-1">34. sysctl \u7BA1\u7406\u7CFB\u7EDF\u53C2\u6570 <a class="header-anchor" href="#_34-sysctl-\u7BA1\u7406\u7CFB\u7EDF\u53C2\u6570" aria-hidden="true">#</a></h2><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">sysctl -a                                       </span><span style="color:#676E95;font-style:italic;">#\u6253\u5370\u5F53\u524D\u53C2\u6570</span></span>
<span class="line"><span style="color:#A6ACCD;">sysctl -w net.ipv4.tcp_fin_timeout=30           </span><span style="color:#676E95;font-style:italic;">#\u5B9E\u65F6\u66F4\u65B0\u4E00\u4E2A\u7CFB\u7EDF\u53C2\u6570, \u9AD8\u5371. \u8981\u9A8C\u8BC1\u597D</span></span>
<span class="line"><span style="color:#A6ACCD;">sysctl -p                                       </span><span style="color:#676E95;font-style:italic;">#\u8BFB\u53D6/etc/sysctl.conf\u548C /etc/sysctl.d/\u4E0B\u914D\u7F6E\u6587\u4EF6\u4FE1\u606F,\u4F7F\u5176\u751F\u6548  </span></span>
<span class="line"></span></code></pre></div><h2 id="_35-\u6E05\u7A7A\u6587\u4EF6\u5185\u5BB9" tabindex="-1">35. \u6E05\u7A7A\u6587\u4EF6\u5185\u5BB9 <a class="header-anchor" href="#_35-\u6E05\u7A7A\u6587\u4EF6\u5185\u5BB9" aria-hidden="true">#</a></h2><p>\u5047\u8BBE\u6587\u4EF6\u540D\u4E3A abc.txt, \u4EE5\u4E0B\u65B9\u6CD5\u90FD\u53EF\u4EE5\u6E05\u7A7A\u8BE5\u6587\u4EF6\u7684\u5185\u5BB9</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> abc.txt</span></span>
<span class="line"><span style="color:#A6ACCD;">cp /dev/null abc.txt</span></span>
<span class="line"></span></code></pre></div><h2 id="_36-\u67E5\u8BE2\u7CFB\u7EDF\u8C03\u7528" tabindex="-1">36. \u67E5\u8BE2\u7CFB\u7EDF\u8C03\u7528 <a class="header-anchor" href="#_36-\u67E5\u8BE2\u7CFB\u7EDF\u8C03\u7528" aria-hidden="true">#</a></h2><p>\u8DDF\u8E2A\u547D\u4EE4<code>ls -rlt</code>\u7684\u7CFB\u7EDF\u8C03\u7528, \u5C06\u4FE1\u606F\u8F93\u51FA\u5230<code>a.txt</code></p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">strace -ftT -o a.txt ls -rlt</span></span>
<span class="line"></span></code></pre></div><p>\u7EDF\u8BA1\u547D\u4EE4\u8FDB\u884C\u7684\u7CFB\u7EDF\u8C03\u7528\u4FE1\u606F</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">strace -c ls</span></span>
<span class="line"></span></code></pre></div><p>\u8DDF\u8E2A\u5177\u4F53\u7684\u8FDB\u7A0B</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">strace -p </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">pid</span><span style="color:#89DDFF;">]</span></span>
<span class="line"></span></code></pre></div><p>\u8FC7\u6EE4\u7CFB\u7EDF\u8C03\u7528</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">strace -e trace=open ls</span></span>
<span class="line"><span style="color:#A6ACCD;">strace -e trace=open,write ls</span></span>
<span class="line"></span></code></pre></div><h2 id="_37-\u67E5\u770B\u78C1\u76D8uuid\u548C\u6587\u4EF6\u7CFB\u7EDF\u7C7B\u578B" tabindex="-1">37. \u67E5\u770B\u78C1\u76D8uuid\u548C\u6587\u4EF6\u7CFB\u7EDF\u7C7B\u578B <a class="header-anchor" href="#_37-\u67E5\u770B\u78C1\u76D8uuid\u548C\u6587\u4EF6\u7CFB\u7EDF\u7C7B\u578B" aria-hidden="true">#</a></h2><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ lsblk -f</span></span>
<span class="line"><span style="color:#A6ACCD;">NAME   FSTYPE LABEL UUID                                 MOUNTPOINT</span></span>
<span class="line"><span style="color:#A6ACCD;">vda</span></span>
<span class="line"><span style="color:#A6ACCD;">\u2514\u2500vda1 ext3         32236b41-fcde-460e-8c34-ba50515b33f2 /</span></span>
<span class="line"><span style="color:#A6ACCD;">$ blkid</span></span>
<span class="line"><span style="color:#A6ACCD;">/dev/vda1: UUID=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">32236b41-fcde-460e-8c34-ba50515b33f2</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> TYPE=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ext3</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre></div><h2 id="_38-\u521B\u5EFA\u8F6F\u8FDE\u63A5" tabindex="-1">38. \u521B\u5EFA\u8F6F\u8FDE\u63A5 <a class="header-anchor" href="#_38-\u521B\u5EFA\u8F6F\u8FDE\u63A5" aria-hidden="true">#</a></h2><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">ln -s regular_file softlink          \u521B\u5EFA\u8F6F\u8FDE\u63A5</span></span>
<span class="line"></span></code></pre></div><h2 id="_39-history\u67E5\u770B\u5386\u53F2\u8BB0\u5F55" tabindex="-1">39. history\u67E5\u770B\u5386\u53F2\u8BB0\u5F55 <a class="header-anchor" href="#_39-history\u67E5\u770B\u5386\u53F2\u8BB0\u5F55" aria-hidden="true">#</a></h2><p>\u5982\u679C\u76F4\u63A5\u6267\u884C<code>history</code>\u6CA1\u6709\u663E\u793A\u65F6\u95F4\u6233,\u53EF\u4EE5\u4F7F\u7528\u4E0B\u9762\u7684\u547D\u4EE4</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">HISTTIMEFORMAT=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">%d/%m/%y %T</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#82AAFF;">history</span></span>
<span class="line"></span></code></pre></div><h2 id="_40-\u67E5\u770B\u8FDB\u7A0B\u7684\u7236\u5B50\u8C03\u7528\u5173\u7CFB" tabindex="-1">40. \u67E5\u770B\u8FDB\u7A0B\u7684\u7236\u5B50\u8C03\u7528\u5173\u7CFB <a class="header-anchor" href="#_40-\u67E5\u770B\u8FDB\u7A0B\u7684\u7236\u5B50\u8C03\u7528\u5173\u7CFB" aria-hidden="true">#</a></h2><p><code>-p</code> \u663E\u793Apid\u4FE1\u606F. {}\u8868\u793A\u7EBF\u7A0B</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ pstree -p</span></span>
<span class="line"><span style="color:#A6ACCD;">systemd</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">1</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">\u2500\u252C\u2500agetty</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">1176</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">           \u251C\u2500auditd</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">669</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">\u2500\u2500\u2500{auditd}</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">670</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">           \u251C\u2500avahi-daemon</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">701</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">\u2500\u2500\u2500avahi-daemon</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">720</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">           \u251C\u2500chronyd</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">721</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">           \u251C\u2500crond</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">1169</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">           \u251C\u2500dbus-daemon</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">702</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">\u2500\u2500\u2500{dbus-daemon}</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">730</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">           \u251C\u2500dhclient</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">4673</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">           \u251C\u2500dnsmasq</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">1344</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">\u2500\u2500\u2500dnsmasq</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">1345</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">           \u251C\u2500firewalld</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">776</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">\u2500\u2500\u2500{firewalld}</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">952</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">           \u251C\u2500gssproxy</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">714</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">\u2500\u252C\u2500{gssproxy}</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">724</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">           \u2502               \u251C\u2500{gssproxy}</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">725</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">           \u2502               \u251C\u2500{gssproxy}</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">726</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">           \u2502               \u251C\u2500{gssproxy}</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">727</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">           \u2502               \u2514\u2500{gssproxy}</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">728</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre></div><h2 id="_41-rsync\u6587\u4EF6" tabindex="-1">41. rsync\u6587\u4EF6 <a class="header-anchor" href="#_41-rsync\u6587\u4EF6" aria-hidden="true">#</a></h2><p>rsync [OPTION]... SRC [SRC]... DEST<br> \u5728\u6307\u5B9A\u590D\u5236\u6E90\u65F6\uFF0C\u8DEF\u5F84\u662F\u5426\u6709\u6700\u540E\u7684 \u201C/\u201D \u6709\u4E0D\u540C\u7684\u542B\u4E49\uFF0C\u4F8B\u5982\uFF1A<br> /data \uFF1A\u8868\u793A\u5C06\u6574\u4E2A /data \u76EE\u5F55\u590D\u5236\u5230\u76EE\u6807\u76EE\u5F55<br> /data/ \uFF1A\u8868\u793A\u5C06 /data/ \u76EE\u5F55\u4E2D\u7684\u6240\u6709\u5185\u5BB9\u590D\u5236\u5230\u76EE\u6807\u76EE\u5F55<br><code>--stats</code> : \u8F93\u51FA\u6587\u4EF6\u4F20\u8F93\u7684\u72B6\u6001<br><code>--progress</code> : \u8F93\u51FA\u6587\u4EF6\u4F20\u8F93\u7684\u8FDB\u5EA6<br><code>-a</code>\u5F52\u6863\u6A21\u5F0F, \u9012\u5F52\u4E14\u4FDD\u7559\u7B26\u53F7\u94FE\u63A5\uFF0C\u4FDD\u7559\u6743\u9650\u4FE1\u606F\uFF0C\u65F6\u95F4\u6233\uFF0C\u4EE5\u53CAowner,group\u4FE1\u606F<br><code>-z</code> \u6253\u5F00\u538B\u7F29\u529F\u80FD<br><code>-v</code> verbose\u66F4\u591A\u6253\u5370\u4FE1\u606F<br> \u672C\u5730\u540C\u6B65</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">rsync -azv /var/opt/installation/inventory/ /root/temp/</span></span>
<span class="line"></span></code></pre></div><p>\u4ECE\u672C\u5730\u5230\u8FDC\u7AEF</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">rsync -avz /root/temp/ thegeekstuff@192.168.200.10:/home/thegeekstuff/temp/</span></span>
<span class="line"></span></code></pre></div><h2 id="_42-\u67E5\u8BE2\u7684\u52A8\u6001\u5E93\u94FE\u63A5\u4FE1\u606F" tabindex="-1">42. \u67E5\u8BE2\u7684\u52A8\u6001\u5E93\u94FE\u63A5\u4FE1\u606F <a class="header-anchor" href="#_42-\u67E5\u8BE2\u7684\u52A8\u6001\u5E93\u94FE\u63A5\u4FE1\u606F" aria-hidden="true">#</a></h2><p>\u67E5\u8BE2python\u8FD9\u4E2A\u7A0B\u5E8F\u4F9D\u8D56\u7684\u6240\u6709\u52A8\u6001\u5E93</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ ldd </span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">which python</span><span style="color:#89DDFF;">\`</span></span>
<span class="line"><span style="color:#A6ACCD;">	linux-vdso.so.1 =</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">0x00007fffb1fb4000</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">	libpython2.7.so.1.0 =</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> /lib64/libpython2.7.so.1.0 </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">0x00007f5dee201000</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">	libpthread.so.0 =</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> /lib64/libpthread.so.0 </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">0x00007f5dedfe5000</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">	libdl.so.2 =</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> /lib64/libdl.so.2 </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">0x00007f5dedde0000</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">	libutil.so.1 =</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> /lib64/libutil.so.1 </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">0x00007f5dedbdd000</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">	libm.so.6 =</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> /lib64/libm.so.6 </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">0x00007f5ded8db000</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">	libc.so.6 =</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> /lib64/libc.so.6 </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">0x00007f5ded517000</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">	/lib64/ld-linux-x86-64.so.2 </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">0x0000561b940b0000</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">root@linux /tmp/new_folder</span><span style="color:#89DDFF;">]</span><span style="color:#676E95;font-style:italic;">#</span></span>
<span class="line"></span></code></pre></div><h2 id="_43-\u67E5\u8BE2ascii\u7F16\u7801\u8868" tabindex="-1">43. \u67E5\u8BE2ascii\u7F16\u7801\u8868 <a class="header-anchor" href="#_43-\u67E5\u8BE2ascii\u7F16\u7801\u8868" aria-hidden="true">#</a></h2><p>\u901F\u67E5\u7F16\u7801\u4FE1\u606F</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">man ascii</span></span>
<span class="line"></span></code></pre></div><h2 id="_44-iptable-\u5185\u7F6E\u9632\u706B\u5899" tabindex="-1">44. iptable \u5185\u7F6E\u9632\u706B\u5899 <a class="header-anchor" href="#_44-iptable-\u5185\u7F6E\u9632\u706B\u5899" aria-hidden="true">#</a></h2><p>iptables\u5185\u7F6E\u4E864\u4E2A\u8868\uFF0C\u5373raw\u8868\u3001filter\u8868\u3001nat\u8868\u548Cmangle\u8868\uFF0C\u9ED8\u8BA4\u64CD\u4F5Cfilter\u8868.</p><p>\u89C4\u5219\u8868\u4E4B\u95F4\u7684\u4F18\u5148\u987A\u5E8F\u5982\u4E0B\uFF1A</p><div class="language-"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">     Raw      --&gt;    mangle       -&gt;        nat    --&gt;      filter</span></span>
<span class="line"><span style="color:#A6ACCD;">prerouting          prerouting          prerouting        input</span></span>
<span class="line"><span style="color:#A6ACCD;">output              postrouting         postrouting       output</span></span>
<span class="line"><span style="color:#A6ACCD;">                    input               output            forward</span></span>
<span class="line"><span style="color:#A6ACCD;">                    output</span></span>
<span class="line"><span style="color:#A6ACCD;">                    forward</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>\u67E5\u8BE2\u8868\u4E2D\u7684\u89C4\u5219,\u5F53\u65F6\u6253\u5370\u5339\u914D\u8BE5\u89C4\u5219\u7684\u5305\u548C\u5B57\u8282\u6570</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">iptables -nvL</span></span>
<span class="line"></span></code></pre></div><p><code>REJECT</code> \u62E6\u963B\u8BE5\u6570\u636E\u5305\uFF0C\u5E76\u8FD4\u56DE\u6570\u636E\u5305\u901A\u77E5\u5BF9\u65B9\uFF0C\u53EF\u4EE5\u8FD4\u56DE\u7684\u6570\u636E\u5305\u6709\u51E0\u4E2A\u9009\u62E9\uFF1AICMP port-unreachable\u3001ICMP echo-reply \u6216\u662Ftcp-reset\uFF08\u8FD9\u4E2A\u6570\u636E\u5305\u5305\u4F1A\u8981\u6C42\u5BF9\u65B9\u5173\u95ED\u8054\u673A\uFF09\uFF0C\u8FDB\u884C\u5B8C\u6B64\u5904\u7406\u52A8\u4F5C\u540E\uFF0C\u5C06\u4E0D\u518D\u6BD4\u5BF9\u5176\u5B83\u89C4\u5219\uFF0C\u76F4\u63A5\u4E2D\u65AD\u8FC7\u6EE4\u7A0B\u5E8F\u3002 \u8303\u4F8B\u5982\u4E0B\uFF1A</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">iptables -A  INPUT -p TCP --dport 22 -j REJECT --reject-with ICMP echo-reply</span></span>
<span class="line"></span></code></pre></div><p><code>DROP</code> \u4E22\u5F03\u6570\u636E\u5305\u4E0D\u4E88\u5904\u7406\uFF0C\u8FDB\u884C\u5B8C\u6B64\u5904\u7406\u52A8\u4F5C\u540E\uFF0C\u5C06\u4E0D\u518D\u6BD4\u5BF9\u5176\u5B83\u89C4\u5219\uFF0C\u76F4\u63A5\u4E2D\u65AD\u8FC7\u6EE4\u7A0B\u5E8F\u3002 <code>REDIRECT</code> \u5C06\u5C01\u5305\u91CD\u65B0\u5BFC\u5411\u5230\u53E6\u4E00\u4E2A\u7AEF\u53E3\uFF08PNAT\uFF09\uFF0C\u8FDB\u884C\u5B8C\u6B64\u5904\u7406\u52A8\u4F5C\u540E\uFF0C\u5C06\u4F1A\u7EE7\u7EED\u6BD4\u5BF9\u5176\u5B83\u89C4\u5219\u3002\u8FD9\u4E2A\u529F\u80FD\u53EF\u4EE5\u7528\u6765\u5B9E\u4F5C\u900F\u660E\u4EE3\u7406 \u6216\u7528\u6765\u4FDD\u62A4web \u670D\u52A1\u5668\u3002\u4F8B\u5982\uFF1A</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">iptables -t nat -A PREROUTING -p tcp --dport 80 -j REDIRECT--to-ports 8081</span></span>
<span class="line"></span></code></pre></div><p><code>MASQUERADE</code> \u6539\u5199\u5C01\u5305\u6765\u6E90IP\u4E3A\u9632\u706B\u5899\u7684IP\uFF0C\u53EF\u4EE5\u6307\u5B9Aport \u5BF9\u5E94\u7684\u8303\u56F4\uFF0C\u8FDB\u884C\u5B8C\u6B64\u5904\u7406\u52A8\u4F5C\u540E\uFF0C\u76F4\u63A5\u8DF3\u5F80\u4E0B\u4E00\u4E2A\u89C4\u5219\u94FE\uFF08mangle:postrouting\uFF09\u3002\u8FD9\u4E2A\u529F\u80FD\u4E0ESNAT\u7565\u6709\u4E0D\u540C\uFF0C\u5F53\u8FDB\u884CIP \u4F2A\u88C5\u65F6\uFF0C\u4E0D\u9700\u6307\u5B9A\u8981\u4F2A\u88C5\u6210\u54EA\u4E2A IP\uFF0CIP \u4F1A\u4ECE\u7F51\u5361\u76F4\u63A5\u8BFB\u53D6\uFF0C\u5F53\u4F7F\u7528\u62E8\u63A5\u8FDE\u7EBF\u65F6\uFF0CIP \u901A\u5E38\u662F\u7531ISP\u516C\u53F8\u7684DHCP\u670D\u52A1\u5668\u6307\u6D3E\u7684\uFF0C\u8FD9\u4E2A\u65F6\u5019MASQUERADE\u7279\u522B\u6709\u7528\u3002\u8303\u4F8B\u5982\u4E0B\uFF1A</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">iptables -t nat -A POSTROUTING -p TCP -j MASQUERADE --to-ports 21000-31000</span></span>
<span class="line"></span></code></pre></div><p><code>LOG</code> \u5C06\u6570\u636E\u5305\u76F8\u5173\u4FE1\u606F\u7EAA\u5F55\u5728 /var/log \u4E2D\uFF0C\u8BE6\u7EC6\u4F4D\u7F6E\u8BF7\u67E5\u9605 /etc/syslog.conf \u914D\u7F6E\u6587\u4EF6\uFF0C\u8FDB\u884C\u5B8C\u6B64\u5904\u7406\u52A8\u4F5C\u540E\uFF0C\u5C06\u4F1A\u7EE7\u7EED\u6BD4\u5BF9\u5176\u5B83\u89C4\u5219\u3002\u4F8B\u5982\uFF1A</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">iptables -A INPUT -p tcp -j LOG --log-prefix </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">input packet</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre></div><p><code>SNAT</code> \u6539\u5199\u5C01\u5305\u6765\u6E90IP\u4E3A\u67D0\u7279\u5B9AIP\u6216IP\u8303\u56F4\uFF0C\u53EF\u4EE5\u6307\u5B9Aport\u5BF9\u5E94\u7684\u8303\u56F4\uFF0C\u8FDB\u884C\u5B8C\u6B64\u5904\u7406\u52A8\u4F5C\u540E\uFF0C\u5C06\u76F4\u63A5\u8DF3\u5F80\u4E0B\u4E00\u4E2A\u89C4\u5219\u70BC\uFF08mangle:postrouting\uFF09.\u8303\u4F8B\u5982\u4E0B\uFF1A</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">iptables -t nat -A POSTROUTING -p tcp -o eth0 -j SNAT --to-source 192.168.10.15-192.168.10.160:2100-3200</span></span>
<span class="line"></span></code></pre></div><p><code>DNAT</code> \u6539\u5199\u6570\u636E\u5305\u5305\u76EE\u7684\u5730 IP \u4E3A\u67D0\u7279\u5B9A IP \u6216 IP \u8303\u56F4\uFF0C\u53EF\u4EE5\u6307\u5B9A port \u5BF9\u5E94\u7684\u8303\u56F4\uFF0C\u8FDB\u884C\u5B8C\u6B64\u5904\u7406\u52A8\u4F5C\u540E\uFF0C\u5C06\u4F1A\u76F4\u63A5\u8DF3\u5F80\u4E0B\u4E00\u4E2A\u89C4\u5219\u94FE\uFF08filter:input \u6216 filter:forward\uFF09\u3002\u8303\u4F8B\u5982\u4E0B\uFF1A</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">iptables -t nat -A PREROUTING -p tcp -d 15.45.23.67 --dport 80 -j DNAT --to-destination 192.168.10.1-192.168.10.10:80-100</span></span>
<span class="line"></span></code></pre></div><p><code>MIRROR</code> \u955C\u50CF\u6570\u636E\u5305\uFF0C\u4E5F\u5C31\u662F\u5C06\u6765\u6E90 IP\u4E0E\u76EE\u7684\u5730IP\u5BF9\u8C03\u540E\uFF0C\u5C06\u6570\u636E\u5305\u8FD4\u56DE\uFF0C\u8FDB\u884C\u5B8C\u6B64\u5904\u7406\u52A8\u4F5C\u540E\uFF0C\u5C06\u4F1A\u4E2D\u65AD\u8FC7\u6EE4\u7A0B\u5E8F\u3002 <code>QUEUE</code> \u4E2D\u65AD\u8FC7\u6EE4\u7A0B\u5E8F\uFF0C\u5C06\u5C01\u5305\u653E\u5165\u961F\u5217\uFF0C\u4EA4\u7ED9\u5176\u5B83\u7A0B\u5E8F\u5904\u7406\u3002\u900F\u8FC7\u81EA\u884C\u5F00\u53D1\u7684\u5904\u7406\u7A0B\u5E8F\uFF0C\u53EF\u4EE5\u8FDB\u884C\u5176\u5B83\u5E94\u7528\uFF0C\u4F8B\u5982\uFF1A\u8BA1\u7B97\u8054\u673A\u8D39\u7528.......\u7B49\u3002 <code>RETURN</code> \u7ED3\u675F\u5728\u76EE\u524D\u89C4\u5219\u94FE\u4E2D\u7684\u8FC7\u6EE4\u7A0B\u5E8F\uFF0C\u8FD4\u56DE\u4E3B\u89C4\u5219\u94FE\u7EE7\u7EED\u8FC7\u6EE4\uFF0C\u5982\u679C\u628A\u81EA\u8BA2\u89C4\u5219\u70BC\u770B\u6210\u662F\u4E00\u4E2A\u5B50\u7A0B\u5E8F\uFF0C\u90A3\u4E48\u8FD9\u4E2A\u52A8\u4F5C\uFF0C\u5C31\u76F8\u5F53\u4E8E\u63D0\u65E9\u7ED3\u675F\u5B50\u7A0B\u5E8F\u5E76\u8FD4\u56DE\u5230\u4E3B\u7A0B\u5E8F\u4E2D\u3002 <code>MARK</code> \u5C06\u5C01\u5305\u6807\u4E0A\u67D0\u4E2A\u4EE3\u53F7\uFF0C\u4EE5\u4FBF\u63D0\u4F9B\u4F5C\u4E3A\u540E\u7EED\u8FC7\u6EE4\u7684\u6761\u4EF6\u5224\u65AD\u4F9D\u636E\uFF0C\u8FDB\u884C\u5B8C\u6B64\u5904\u7406\u52A8\u4F5C\u540E\uFF0C\u5C06\u4F1A\u7EE7\u7EED\u6BD4\u5BF9\u5176\u5B83\u89C4\u5219\u3002\u8303\u4F8B\u5982\u4E0B\uFF1A</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">iptables -t mangle -A PREROUTING -p tcp --dport 22 -j MARK --set-mark 22</span></span>
<span class="line"></span></code></pre></div><p>\u6E05\u7A7Aiptables\u89C4\u5219</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;"># set ACCEPT for default action</span></span>
<span class="line"><span style="color:#A6ACCD;">iptables -P INPUT ACCEPT</span></span>
<span class="line"><span style="color:#A6ACCD;">iptables -P FORWARD ACCEPT</span></span>
<span class="line"><span style="color:#A6ACCD;">iptables -P OUTPUT ACCEPT</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># flush all chains</span></span>
<span class="line"><span style="color:#A6ACCD;">iptables -F</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># delete all  user-defined chains</span></span>
<span class="line"><span style="color:#A6ACCD;">iptables -X</span></span>
<span class="line"></span></code></pre></div><p>\u4E22\u5F03TCP\u8BBF\u95EE21\u7AEF\u53E3\u7684\u5305</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">iptables -A INPUT -p tcp --dport 21 -j DROP</span></span>
<span class="line"></span></code></pre></div><p>\u52A0<code>--line-numbers</code>\u53C2\u6570\u53EF\u4EE5\u6253\u5370\u89C4\u5219\u5E8F\u53F7. \u5220\u9664\u65F6\u7528</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">iptables -nvL --line-numbers</span></span>
<span class="line"></span></code></pre></div><p>\u5220\u9664INPUT\u94FE\u91CC\u7684\u7B2C\u4E09\u4E2A\u89C4\u5219</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">iptables -D INPUT 3</span></span>
<span class="line"></span></code></pre></div><p><a href="https://blog.csdn.net/htmlxx/article/details/51412750" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/htmlxx/article/details/51412750</a><br> \u8FD9\u91CC\u8BB0\u5F55\u4E86\u4E00\u4E9B\u5E38\u7528\u7684iptables\u89C4\u5219\u64CD\u4F5C</p><h2 id="_45-tcpdump-\u6293\u5305" tabindex="-1">45. tcpdump \u6293\u5305 <a class="header-anchor" href="#_45-tcpdump-\u6293\u5305" aria-hidden="true">#</a></h2><p>\u5E38\u7528\u8868\u8FBE\u5F0F:<br> \u975E : ! or &quot;not&quot; (\u53BB\u6389\u53CC\u5F15\u53F7)<br> \u4E14 : &amp;&amp; or &quot;and&quot;<br> \u6216 : || or &quot;or&quot;<br><code>-nn</code> \u4E0D\u8F6C\u6362\u5730\u5740\u548C\u7AEF\u53E3\u53F7 <code>-v</code> \u6253\u5370\u8BE6\u60C5</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">tcpdump -i eth0 -nnv</span></span>
<span class="line"></span></code></pre></div><p>\u6293\u53D6\u6240\u6709\u7ECF\u8FC7eth1\uFF0C\u5730\u5740\u662F192.168.1.1\u4E14\u7AEF\u53E3\u53F7\u4E3A25\u7684\u6240\u6709\u5305</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">tcpdump -i eth1 host 192.168.1.1 and port 25</span></span>
<span class="line"></span></code></pre></div><p>-c count \u6293\u53D6\u6307\u5B9A\u6570\u76EE\u7684\u5305\u540E\u9000\u51FA</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">tcpdump -i eth0 -c 1000</span></span>
<span class="line"></span></code></pre></div><p>-C file_size \u5FAA\u73AF\u6293\u5305,\u5F53\u6587\u4EF6\u8FBE\u5230\u6307\u5B9A\u7684\u5927\u5C0F\u540E,\u5C06\u5305\u5199\u5165\u5230\u65B0\u6587\u4EF6.\u4E3E\u4F8B\u5982\u4E0B:</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">tcpdump -i eth0 -C 1 -w abc</span></span>
<span class="line"><span style="color:#A6ACCD;">$ ls -rlt abc</span><span style="color:#89DDFF;">*</span></span>
<span class="line"><span style="color:#A6ACCD;">-rw-r--r--. 1 tcpdump tcpdump 1001078 Jan 14 23:33 abc</span></span>
<span class="line"><span style="color:#A6ACCD;">-rw-r--r--. 1 tcpdump tcpdump  647168 Jan 14 23:33 abc1</span></span>
<span class="line"></span></code></pre></div><p>\u6293\u53D6\u672C\u673Aeth0\u7F51\u5361\u53D1\u5F80\u516C\u7F51ip\u7684\u6570\u636E\u5305</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">tcpdump -n -i eth0 </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">not net 10.0.0.0/8 and not net 192.168.0.0/16 and not net 172.16.0.0/12</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span></code></pre></div><h2 id="_46-dns\u67E5\u8BE2\u5DE5\u5177" tabindex="-1">46. DNS\u67E5\u8BE2\u5DE5\u5177 <a class="header-anchor" href="#_46-dns\u67E5\u8BE2\u5DE5\u5177" aria-hidden="true">#</a></h2><p>\u6307\u5B9ADNS\u670D\u52A1\u5668\u9012\u5F52\u67E5</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ dig www.baidu.com @8.8.8.8</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;&lt;</span><span style="color:#89DDFF;font-style:italic;">&gt;&gt;</span><span style="color:#C3E88D;"> DiG 9.9.4-RedHat-9.9.4-51.el7 &lt;&lt;&gt;&gt; www.baidu.com @8.8.8.8</span></span>
<span class="line"><span style="color:#C3E88D;">;; global options: +cmd</span></span>
<span class="line"><span style="color:#C3E88D;">;; Got answer:</span></span>
<span class="line"><span style="color:#C3E88D;">;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 4712</span></span>
<span class="line"><span style="color:#C3E88D;">;; flags: qr rd ra; QUERY: 1, ANSWER: 3, AUTHORITY: 0, ADDITIONAL: 1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">;; OPT PSEUDOSECTION:</span></span>
<span class="line"><span style="color:#C3E88D;">; EDNS: version: 0, flags:; udp: 512</span></span>
<span class="line"><span style="color:#C3E88D;">;; QUESTION SECTION:</span></span>
<span class="line"><span style="color:#C3E88D;">;www.baidu.com.			IN	A</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">;; ANSWER SECTION:</span></span>
<span class="line"><span style="color:#C3E88D;">www.baidu.com.		1043	IN	CNAME	www.a.shifen.com.</span></span>
<span class="line"><span style="color:#C3E88D;">www.a.shifen.com.	218	IN	A	220.181.112.244</span></span>
<span class="line"><span style="color:#C3E88D;">www.a.shifen.com.	218	IN	A	220.181.111.188</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C3E88D;">;; Query time: 78 msec</span></span>
<span class="line"><span style="color:#C3E88D;">;; SERVER: 8.8.8.8#53(8.8.8.8)</span></span>
<span class="line"><span style="color:#C3E88D;">;; WHEN: Mon Jan 15 00:03:09 HKT 2018</span></span>
<span class="line"><span style="color:#C3E88D;">;; MSG SIZE  rcvd: 101</span></span>
<span class="line"></span></code></pre></div><p>\u53CD\u89E3\u6790</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ dig -x 74.125.135.105</span></span>
<span class="line"><span style="color:#89DDFF;">;;</span><span style="color:#A6ACCD;"> QUESTION SECTION:</span></span>
<span class="line"><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;">105.135.125.74.in-addr.arpa.   IN      PTR</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">;;</span><span style="color:#A6ACCD;"> ANSWER SECTION:</span></span>
<span class="line"><span style="color:#A6ACCD;">105.135.125.74.in-addr.arpa. 83205 IN   PTR     ni-in-f105.1e100.net.</span></span>
<span class="line"></span></code></pre></div><p>\u5168\u8FC7\u7A0B\u8FED\u4EE3\u8DDF\u8E2A</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">dig +trace www.baidu.com</span></span>
<span class="line"></span></code></pre></div><h2 id="_47-ntp\u65F6\u95F4\u540C\u6B65" tabindex="-1">47. NTP\u65F6\u95F4\u540C\u6B65 <a class="header-anchor" href="#_47-ntp\u65F6\u95F4\u540C\u6B65" aria-hidden="true">#</a></h2><p>ntpdate \u624B\u5DE5\u6821\u51C6\u65F6\u95F4, \u52A0 <code>-q</code> \u53EA\u67E5\u8BE2, \u4E0D\u540C\u6B65\u65F6\u95F4, \u52A0 <code>-d</code> \u6253\u5F00Debug\u6A21\u5F0F, \u4F46\u4E0D\u771F\u6B63\u66F4\u65B0\u65F6\u95F4</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ ntpdate ntp1.aliyun.com</span></span>
<span class="line"><span style="color:#A6ACCD;">15 Jan 23:18:51 ntpdate</span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">18981</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;">: adjust </span><span style="color:#F78C6C;">time</span><span style="color:#A6ACCD;"> server 182.92.12.11 offset 0.000643 sec</span></span>
<span class="line"></span></code></pre></div><p>\u5B89\u88C5<code>ntpd</code>\u65F6\u67E5\u8BE2ntp\u540C\u6B65\u72B6\u6001\u7684\u547D\u4EE4\u4E3A<code>ntpq -p</code><br> \u5982\u679C\u4F7F\u7528<code>chronyd</code>(centos7\u9ED8\u8BA4)\u662F\u547D\u4EE4\u4E3A<code>chronyc sources -v</code></p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ chronyc sources -v</span></span>
<span class="line"><span style="color:#A6ACCD;">210 Number of sources = 2</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">  .-- Source mode  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">^</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> = server, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> = peer, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">#</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> = </span><span style="color:#C792EA;">local</span><span style="color:#A6ACCD;"> clock.</span></span>
<span class="line"><span style="color:#A6ACCD;"> / .- Source state </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">*</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> = current synced, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">+</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> = combined , </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">-</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> = not combined,</span></span>
<span class="line"><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> /   </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">?</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> = unreachable, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">x</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> = </span><span style="color:#F78C6C;">time</span><span style="color:#A6ACCD;"> may be </span><span style="color:#89DDFF;font-style:italic;">in</span><span style="color:#A6ACCD;"> error, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">~</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> = </span><span style="color:#F78C6C;">time</span><span style="color:#A6ACCD;"> too variable.</span></span>
<span class="line"><span style="color:#89DDFF;">||</span><span style="color:#A6ACCD;">                                                 .- xxxx </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;"> yyyy </span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> +/- zzzz</span></span>
<span class="line"><span style="color:#89DDFF;">||</span><span style="color:#A6ACCD;">      Reachability register </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">octal</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> -.           </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">  xxxx = adjusted offset,</span></span>
<span class="line"><span style="color:#89DDFF;">||</span><span style="color:#A6ACCD;">      Log2</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">Polling interval</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> --.      </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">          </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">  yyyy = measured offset,</span></span>
<span class="line"><span style="color:#89DDFF;">||</span><span style="color:#A6ACCD;">                                \\     </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">          </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">  zzzz = estimated error.</span></span>
<span class="line"><span style="color:#89DDFF;">||</span><span style="color:#A6ACCD;">                                 </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">           \\</span></span>
<span class="line"><span style="color:#A6ACCD;">MS Name/IP address         Stratum Poll Reach LastRx Last sample</span></span>
<span class="line"><span style="color:#A6ACCD;">===============================================================================</span></span>
<span class="line"><span style="color:#A6ACCD;">^</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> time5.aliyun.com              2   6    37    41  +2394ns</span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">+1057us</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> +/-   15ms</span></span>
<span class="line"><span style="color:#A6ACCD;">^- 120.25.115.19                 2   6    37    40  -2559us</span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">-2559us</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> +/-   67ms</span></span>
<span class="line"></span></code></pre></div><h2 id="_48-netstat\u67E5\u8BE2\u7F51\u7EDC\u8FDE\u63A5\u4FE1\u606F" tabindex="-1">48. netstat\u67E5\u8BE2\u7F51\u7EDC\u8FDE\u63A5\u4FE1\u606F <a class="header-anchor" href="#_48-netstat\u67E5\u8BE2\u7F51\u7EDC\u8FDE\u63A5\u4FE1\u606F" aria-hidden="true">#</a></h2><p>\u67E5\u770B\u6240\u6709tcp\u4E0B\u76D1\u542C\u7AEF\u53E3, p\u8868\u793A\u6253\u5370\u76F8\u5E94\u7684\u8FDB\u7A0B</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">netstat -lntp</span></span>
<span class="line"></span></code></pre></div><p>\u67E5\u770B\u6240\u6709\u5DF2\u7ECF\u5EFA\u7ACB\u7684\u8FDE\u63A5</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">netstat -antp</span></span>
<span class="line"></span></code></pre></div><p>\u67E5\u770B\u8DEF\u7531\u8868</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">netstat -rn</span></span>
<span class="line"></span></code></pre></div><p>\u67E5\u770B\u7F51\u7EDC\u7EDF\u8BA1\u4FE1\u606F\u8FDB\u7A0B</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">netstat -s</span></span>
<span class="line"></span></code></pre></div><h2 id="_49-ethtool-\u7F51\u5361\u67E5\u8BE2\u5DE5\u5177" tabindex="-1">49. ethtool \u7F51\u5361\u67E5\u8BE2\u5DE5\u5177 <a class="header-anchor" href="#_49-ethtool-\u7F51\u5361\u67E5\u8BE2\u5DE5\u5177" aria-hidden="true">#</a></h2><p><code>-i</code> \u67E5\u7F51\u5361\u9A71\u52A8\u4FE1\u606F</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ ethtool -i  eth0</span></span>
<span class="line"><span style="color:#A6ACCD;">driver: virtio_net</span></span>
<span class="line"><span style="color:#A6ACCD;">version: 1.0.0</span></span>
<span class="line"><span style="color:#A6ACCD;">firmware-version:</span></span>
<span class="line"><span style="color:#A6ACCD;">expansion-rom-version:</span></span>
<span class="line"><span style="color:#A6ACCD;">bus-info: 0000:00:05.0</span></span>
<span class="line"><span style="color:#A6ACCD;">supports-statistics: no</span></span>
<span class="line"><span style="color:#A6ACCD;">supports-test: no</span></span>
<span class="line"><span style="color:#A6ACCD;">supports-eeprom-access: no</span></span>
<span class="line"><span style="color:#A6ACCD;">supports-register-dump: no</span></span>
<span class="line"><span style="color:#A6ACCD;">supports-priv-flags: no</span></span>
<span class="line"></span></code></pre></div><p>\u4E0D\u8DDF\u53C2\u6570,\u663E\u793A\u901F\u7387,\u5168\u53CC\u5DE5\u6A21\u5F0F\u7B49\u4FE1\u606F(\u865A\u62DF\u673A\u4E0B\u6CA1\u6709)<br> Link \u4E3A<code>yes</code>\u8868\u793A \u7F51\u7EBF\u8FDE\u63A5\u6B63\u5E38</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ ethtool eth0</span></span>
<span class="line"><span style="color:#A6ACCD;">Settings </span><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#A6ACCD;"> eth0:</span></span>
<span class="line"><span style="color:#A6ACCD;">	Link detected: yes</span></span>
<span class="line"></span></code></pre></div><h2 id="_50-ip-\u7F51\u7EDC\u7EF4\u62A4" tabindex="-1">50. ip \u7F51\u7EDC\u7EF4\u62A4 <a class="header-anchor" href="#_50-ip-\u7F51\u7EDC\u7EF4\u62A4" aria-hidden="true">#</a></h2><p>\u542F\u7528\u63A5\u53E3</p><div class="language-"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">ip link set &lt;\u63A5\u53E3\u540D&gt; up</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>\u7981\u7528\u63A5\u53E3</p><div class="language-"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">ip link set &lt;\u63A5\u53E3\u540D&gt; down</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>\u8BBE\u7F6E\u63A5\u53E3MAC\u5730\u5740\uFF08\u8BBE\u7F6E\u524D\u8BF7\u5148\u7981\u7528\u63A5\u53E3\uFF09</p><div class="language-"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">ip link set &lt;\u63A5\u53E3\u540D&gt; address &lt;\u503C&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>\u8BBE\u7F6E\u63A5\u53E3MTU\uFF08\u8BBE\u7F6E\u524D\u8BF7\u5148\u7981\u7528\u63A5\u53E3\uFF09 \u4F8B\uFF1A\u628Aens33\u7684MTU\u6539\u62109000\u5E76\u68C0\u67E5\u3002</p><div class="language-"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;"># ip link show dev ens33 #\u4FEE\u6539\u524D</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">2: ens33: &lt;BROADCAST,MULTICAST&gt; mtu 1500 qdisc pfifo_fast state DOWN mode DEFAULT qlen 1000</span></span>
<span class="line"><span style="color:#A6ACCD;">    link/ether 88:32:9b:ca:3f:49 brd ff:ff:ff:ff:ff:ff</span></span>
<span class="line"><span style="color:#A6ACCD;"># ip link set ens33 mtu 9000</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;"># ip link show dev ens33  #\u4FEE\u6539\u540E</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span>
<span class="line"><span style="color:#A6ACCD;">2: ens33: &lt;BROADCAST,MULTICAST&gt; mtu 9000 qdisc pfifo_fast state DOWN mode DEFAULT qlen 1000</span></span>
<span class="line"><span style="color:#A6ACCD;">    link/ether 88:32:9b:ca:3f:49 brd ff:ff:ff:ff:ff:ff</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>\u67E5\u770B\u7F51\u5361\u7684\u8BE6\u7EC6\u4FE1\u606F, \u6BD4\u5982\u662Fbridge\u8FD8\u662Fveth\u7B49\u7C7B\u578B</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">ip --details link</span></span>
<span class="line"><span style="color:#A6ACCD;">ip link  show </span><span style="color:#82AAFF;">type</span><span style="color:#A6ACCD;"> bridge  </span><span style="color:#676E95;font-style:italic;">#\u663E\u793A\u6240\u6709\u7684\u6865\u63A5\u8BBE\u5907</span></span>
<span class="line"></span></code></pre></div><p>\u4E0B\u9762\u811A\u672C\u53EF\u4EE5\u663E\u793A\u6BCF\u4E2A\u94FE\u8DEF\u7684\u7C7B\u578B, \u9664\u4E86\u4EE5\u592A\u7F51</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;">!</span><span style="color:#A6ACCD;">/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Arguments: $1: Interface (&#39;grep&#39;-regexp).</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># Static list of types (from \`ip link help\`):</span></span>
<span class="line"><span style="color:#A6ACCD;">TYPES=</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">bond bond_slave bridge dummy gre gretap ifb ip6gre ip6gretap ip6tnl ipip ipoib ipvlan macvlan macvtap nlmon sit vcan veth vlan vti vxlan tun tap</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">iface=</span><span style="color:#89DDFF;">&quot;$</span><span style="color:#A6ACCD;">1</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#A6ACCD;"> type </span><span style="color:#89DDFF;font-style:italic;">in</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;\${</span><span style="color:#A6ACCD;">TYPES</span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">@</span><span style="color:#89DDFF;">]}&quot;</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">do</span></span>
<span class="line"><span style="color:#A6ACCD;">  ip link show </span><span style="color:#82AAFF;">type</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;\${</span><span style="color:#A6ACCD;">type</span><span style="color:#89DDFF;">}&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> grep -E </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">^[0-9]+:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> cut -d </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> -f 2 </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> sed </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">s|^[[:space:]]*||</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">while</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">read</span><span style="color:#A6ACCD;"> _if</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">do</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;\${</span><span style="color:#A6ACCD;">_if</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">:</span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">type</span><span style="color:#89DDFF;">}&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;font-style:italic;">done</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> grep </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">^</span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">iface</span><span style="color:#89DDFF;">}&quot;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">done</span></span>
<span class="line"></span></code></pre></div><p>\u67E5\u770B\u7F51\u5361\u72B6\u6001\u548C\u5BF9\u5E94\u7684IP\u4FE1\u606F</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">ip addr</span></span>
<span class="line"></span></code></pre></div><p>\u7ED9\u63A5\u53E3eth0\u8D4B\u4E88\u5730\u574010.211.55.10 \u63A9\u7801\u662F255.255.255.0(24\u4EE3\u8868\u63A9\u7801\u4E2D1\u7684\u4E2A\u6570)\uFF0C\u5E7F\u64AD\u5730\u5740\u662F10.211.55.255</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">ip addr add 10.211.55.10/24 dev eth0</span></span>
<span class="line"></span></code></pre></div><p>\u5220\u9664eth0\u4E0A\u7684 10.211.55.10</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">ip addr del 10.211.55.10/24 dev eth0</span></span>
<span class="line"></span></code></pre></div><p>\u67E5\u770B\u8DEF\u7531\u8868\u4FE1\u606F</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ ip route</span></span>
<span class="line"><span style="color:#A6ACCD;">default via 10.211.55.1 dev eth0</span></span>
<span class="line"><span style="color:#A6ACCD;">10.211.55.0/24 dev eth0 proto kernel scope link src 10.211.55.9</span></span>
<span class="line"><span style="color:#A6ACCD;">192.168.122.0/24 dev virbr0 proto kernel scope link src 192.168.122.1</span></span>
<span class="line"></span></code></pre></div><p>\u67E5\u8BE2\u76EE\u7684\u5730\u4E3A<code>192.168.1.1</code>\u65F6\u9009\u62E9\u7684\u8DEF\u7531\u60C5\u51B5</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ ip route get 192.168.1.1</span></span>
<span class="line"><span style="color:#A6ACCD;">192.168.1.1 via 10.211.55.1 dev eth0 src 10.211.55.9</span></span>
<span class="line"><span style="color:#A6ACCD;">    cache</span></span>
<span class="line"></span></code></pre></div><p>\u589E\u52A0\u9ED8\u8BA4\u8DEF\u7531</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">ip route add default via 20.0.0.1</span></span>
<span class="line"></span></code></pre></div><p>\u7B56\u7565\u6027\u8DEF\u7531\u76F8\u5BF9\u4E8E\u4F20\u7EDF\u7684\u8DEF\u7531\u7B97\u6CD5\u4E3B\u8981\u662F\u5F15\u5165\u4E86\u591A\u8DEF\u7531\u8868\u4EE5\u53CA\u89C4\u5219\u7684\u6982\u5FF5\u3002<br> \u4F8B\u5982\u4E00\u4E2A\u5B50\u7F51\u901A\u8FC7\u4E00\u4E2A\u8DEF\u7531\u5668\u4E0E\u5916\u754C\u76F8\u8FDE\uFF0C\u8DEF\u7531\u5668\u4E0E\u5916\u754C\u6709\u4E24\u6761\u7EBF\u8DEF\u76F8\u8FDE\uFF0C\u5176\u4E2D\u4E00\u6761\u7684\u901F\u5EA6\u6BD4\u8F83\u5FEB\uFF0C\u4E00\u6761\u7684\u901F\u5EA6\u6BD4\u8F83\u6162\u3002\u5BF9\u4E8E\u5B50\u7F51\u5185\u7684\u5927\u591A\u6570\u7528\u6237\u6765\u8BF4\u5BF9\u901F\u5EA6\u5E76\u6CA1\u6709\u7279\u6B8A\u7684\u8981\u6C42\uFF0C\u6240\u4EE5\u53EF\u4EE5\u8BA9\u4ED6\u4EEC\u7528\u6BD4\u8F83\u6162\u7684\u8DEF\u7531\uFF1B\u4F46\u662F\u5B50\u7F51\u5185\u6709\u4E00\u4E9B\u7279\u6B8A\u7684\u7528\u6237\u5374\u662F\u5BF9\u901F\u5EA6\u7684\u8981\u6C42\u6BD4\u8F83\u82DB\u523B\uFF0C\u6240\u4EE5\u4ED6\u4EEC\u9700\u8981\u4F7F\u7528\u901F\u5EA6\u6BD4\u8F83\u5FEB\u7684\u8DEF\u7531\u3002\u5982\u679C\u4F7F\u7528\u4E00\u5F20\u8DEF\u7531\u8868\u4E0A\u8FF0\u8981\u6C42\u662F\u65E0\u6CD5\u5B9E\u73B0\u7684\uFF0C\u800C\u5982\u679C\u6839\u636E\u6E90\u5730\u5740\u6216\u5176\u5B83\u53C2\u6570\uFF0C\u5BF9\u4E0D\u540C\u7684\u7528\u6237\u4F7F\u7528\u4E0D\u540C\u7684\u8DEF\u7531\u8868\uFF0C\u8FD9\u6837\u5C31\u53EF\u4EE5\u5927\u5927\u63D0\u9AD8\u8DEF\u7531\u5668\u7684\u6027\u80FD\u3002<br> \u4F18\u5148\u7EA7\u522B\u8D8A\u9AD8\u7684\u89C4\u5219\u8D8A\u5148\u5339\u914D\uFF08\u6570\u503C\u8D8A\u5C0F\u4F18\u5148\u7EA7\u522B\u8D8A\u9AD8\uFF09\u3002</p><p>\u7CFB\u7EDF\u5185\u7F6E3\u5F20\u8868:</p><div class="language-"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">\u8868255 \u672C\u5730\u8DEF\u7531\u8868\uFF08Local table\uFF09\u672C\u5730\u63A5\u53E3\u5730\u5740\uFF0C\u5E7F\u64AD\u5730\u5740\uFF0C\u5DF2\u53CANAT\u5730\u5740\u90FD\u653E\u5728\u8FD9\u4E2A\u8868\u3002\u8BE5\u8DEF\u7531\u8868\u7531\u7CFB\u7EDF\u81EA\u52A8\u7EF4\u62A4\uFF0C\u7BA1\u7406\u5458\u4E0D\u80FD\u76F4\u63A5\u4FEE\u6539\u3002</span></span>
<span class="line"><span style="color:#A6ACCD;">\u8868254 \u4E3B\u8DEF\u7531\u8868\uFF08Main table\uFF09\u5982\u679C\u6CA1\u6709\u6307\u660E\u8DEF\u7531\u6240\u5C5E\u7684\u8868\uFF0C\u6240\u6709\u7684\u8DEF\u7531\u90FD\u9ED8\u8BA4\u90FD\u653E\u5728\u8FD9\u4E2A\u8868\u91CC\uFF0Croute\uFF09\u6240\u6DFB\u52A0\u7684\u8DEF\u7531\u90FD\u4F1A\u52A0\u5230\u8FD9\u4E2A\u8868\u3002</span></span>
<span class="line"><span style="color:#A6ACCD;">\u8868253 \u9ED8\u8BA4\u8DEF\u7531\u8868\uFF08Default table\uFF09\u4E00\u822C\u6765\u8BF4\u9ED8\u8BA4\u7684\u8DEF\u7531\u90FD\u653E\u5728\u8FD9\u5F20\u8868\uFF0C\u4F46\u662F\u5982\u679C\u7279\u522B\u6307\u660E\u653E\u7684\u4E5F\u53EF\u4EE5\u662F\u6240\u6709\u7684\u7F51\u5173\u8DEF\u7531\u3002</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>\u67E5\u770B\u8DEF\u7531\u89C4\u5219, <code>32766</code>\u8868\u793A\u4F18\u5148\u7EA7, \u8D8A\u5C0F\u4F18\u5148\u7EA7\u8D8A\u9AD8.</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ ip rule list</span></span>
<span class="line"><span style="color:#A6ACCD;">0:	from all lookup </span><span style="color:#C792EA;">local</span></span>
<span class="line"><span style="color:#A6ACCD;">32766:	from all lookup main</span></span>
<span class="line"><span style="color:#A6ACCD;">32767:	from all lookup default</span></span>
<span class="line"></span></code></pre></div><p>\u521B\u5EFA\u4E00\u4E2A\u65B0\u7684\u8DEF\u7531\u8868, \u539F\u5730\u5740\u4E3A<code>192.168.2.0/24</code>\u7684\u6D88\u606F\u5168\u90E8\u8DEF\u7531\u5230\u8FD9\u5F20\u8868\u91CC</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">250 test</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&gt;&gt;</span><span style="color:#A6ACCD;"> /etc/iproute2/rt_tables</span></span>
<span class="line"><span style="color:#A6ACCD;">$ ip rule add from 192.168.2.0/24 table </span><span style="color:#82AAFF;">test</span></span>
<span class="line"></span></code></pre></div><p>\u4E0A\u9762\u7684\u914D\u7F6E\u5982\u679C\u8981\u6301\u4E45\u5316, \u53EF\u4EE5\u5C06\u547D\u4EE4\u5199\u5165<code>/etc/rc.d/rc.local</code>, \u5E76\u7ED9\u8BE5\u6587\u4EF6\u53EF\u6267\u884C\u6743\u9650. <code>chmod +x /etc/rc.d/rc.local</code></p><p>\u67E5\u770B\u67D0\u4E00\u5F20\u8868\u91CC\u7684\u8DEF\u7531\u4FE1\u606F</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ ip route list table main</span></span>
<span class="line"></span></code></pre></div><p>\u89C4\u5219\u5339\u914D\u7684\u5BF9\u8C61\u662F\u6240\u6709\u7684\u6570\u636E\u5305\uFF0C\u52A8\u4F5C\u662F\u9009\u7528\u8DEF\u7531\u88681\u7684\u8DEF\u7531\uFF0C\u8FD9\u6761\u89C4\u5219\u7684\u4F18\u5148\u7EA7\u662F32800</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ ip rule add from 0/0 table 1 pref 32800</span></span>
<span class="line"></span></code></pre></div><p>\u89C4\u5219\u5339\u914D\u7684\u5BF9\u8C61\u662FIP\u4E3A192.168.3.112\uFF0Ctos\u7B49\u4E8E0x10\u7684\u5305\uFF0C\u4F7F\u7528\u8DEF\u7531\u88682\uFF0C\u8FD9\u6761\u89C4\u5219\u7684\u4F18\u5148\u7EA7\u662F1500</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">ip rule add from 192.168.3.112/32 </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">tos 0x10</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> table \uFF12 pref 1500</span></span>
<span class="line"></span></code></pre></div><p>\u5728table test\u91CC\u6DFB\u52A0\u4E00\u6761\u9ED8\u8BA4\u8DEF\u7531</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">ip route add default via 182.169.1.1 table </span><span style="color:#82AAFF;">test</span></span>
<span class="line"></span></code></pre></div><p>\u4E0A\u9762\u7684\u89C4\u5219\u662F\u4EE5\u6E90\u5730\u5740\u4E3A\u5173\u952E\u5B57\uFF0C\u4F5C\u4E3A\u662F\u5426\u5339\u914D\u7684\u4F9D\u636E\u7684\u3002\u9664\u4E86\u6E90\u5730\u5740\u5916\uFF0C\u8FD8\u53EF\u4EE5\u7528\u4EE5\u4E0B\u7684\u4FE1\u606F\uFF1A</p><div class="language-"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">from -- \u6E90\u5730\u5740</span></span>
<span class="line"><span style="color:#A6ACCD;">to -- \u76EE\u7684\u5730\u5740\uFF08\u8FD9\u91CC\u662F\u9009\u62E9\u89C4\u5219\u65F6\u4F7F\u7528\uFF0C\u67E5\u627E\u8DEF\u7531\u8868\u65F6\u4E5F\u4F7F\u7528\uFF09</span></span>
<span class="line"><span style="color:#A6ACCD;">tos -- IP\u5305\u5934\u7684TOS\uFF08type of sevice\uFF09\u57DF</span></span>
<span class="line"><span style="color:#A6ACCD;">dev -- \u7269\u7406\u63A5\u53E3</span></span>
<span class="line"><span style="color:#A6ACCD;">fwmark -- \u9632\u706B\u5899\u53C2\u6570</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>\u91C7\u53D6\u7684\u52A8\u4F5C\u9664\u4E86\u6307\u5B9A\u8868\uFF0C\u8FD8\u53EF\u4EE5\u6307\u5B9A\u4E0B\u9762\u7684\u52A8\u4F5C\uFF1A</p><div class="language-"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">Table \u6307\u660E\u6240\u4F7F\u7528\u7684\u8868</span></span>
<span class="line"><span style="color:#A6ACCD;">Nat \u900F\u660E\u7F51\u5173</span></span>
<span class="line"><span style="color:#A6ACCD;">Action prohibit \u4E22\u5F03\u8BE5\u5305\uFF0C\u5E76\u53D1\u9001 COMM.ADM.PROHIITED\u7684ICMP\u4FE1\u606F</span></span>
<span class="line"><span style="color:#A6ACCD;">Reject \u5355\u7EAF\u4E22\u5F03\u8BE5\u5305</span></span>
<span class="line"><span style="color:#A6ACCD;">Unreachable\u4E22\u5F03\u8BE5\u5305\uFF0C\u5E76\u53D1\u9001 NET UNREACHABLE\u7684ICMP\u4FE1\u606F</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>\u5B9E\u9645\u573A\u666F\u4E2D\u5C3D\u91CF\u4F7F\u7528<code>ip rule to xxxx table xxx</code>\u9488\u5BF9\u76EE\u7684IP\u6307\u5B9A\u8DEF\u7531\u8868. \u8FD9\u6837\u65E0\u8BBA\u662F\u6536\u5230\u8BF7\u6C42\u540E\u56DE\u590D,\u6216\u8005\u4E3B\u52A8\u53D1\u8D77\u8BF7\u6C42\u90FD\u80FD\u5339\u914D</p><p>\u5177\u4F53\u7684\u8BED\u6CD5\u53EF\u53C2\u8003<code>man ip-rule</code>\u548C<code>man ip-route</code><br><a href="https://www.redhat.com/sysadmin/beginners-guide-network-troubleshooting-linux" target="_blank" rel="noopener noreferrer">https://www.redhat.com/sysadmin/beginners-guide-network-troubleshooting-linux</a><br><a href="http://www.microhowto.info/troubleshooting/troubleshooting_the_routing_table.html" target="_blank" rel="noopener noreferrer">http://www.microhowto.info/troubleshooting/troubleshooting_the_routing_table.html</a></p><p>ip netns\u64CD\u4F5C<br><a href="https://www.cnblogs.com/sparkdev/p/9253409.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/sparkdev/p/9253409.html</a></p><h2 id="_51-who-\u67E5\u770B\u5F53\u524D\u767B\u5F55\u7528\u6237" tabindex="-1">51. who \u67E5\u770B\u5F53\u524D\u767B\u5F55\u7528\u6237 <a class="header-anchor" href="#_51-who-\u67E5\u770B\u5F53\u524D\u767B\u5F55\u7528\u6237" aria-hidden="true">#</a></h2><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ who</span></span>
<span class="line"><span style="color:#A6ACCD;">root     pts/0        2018-01-17 22:28 </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">10.211.55.2</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span></code></pre></div><h2 id="_52-\u4F7F\u7528iftop\u67E5\u770B\u4E3B\u673A\u5B9E\u65F6\u7F51\u7EDC\u6D41\u91CF" tabindex="-1">52. \u4F7F\u7528iftop\u67E5\u770B\u4E3B\u673A\u5B9E\u65F6\u7F51\u7EDC\u6D41\u91CF <a class="header-anchor" href="#_52-\u4F7F\u7528iftop\u67E5\u770B\u4E3B\u673A\u5B9E\u65F6\u7F51\u7EDC\u6D41\u91CF" aria-hidden="true">#</a></h2><p>\u7C7B\u4F3Ctop\u8FD9\u6837\u7684\u4EA4\u4E92\u5F0F\u754C\u9762<br> \u76D1\u63A7\u7F51\u5361\u7684\u5B9E\u65F6\u6D41\u91CF,\u53CD\u5411\u89E3\u6790IP,\u540C\u65F6\u8FD8\u663E\u793A\u5177\u4F53\u6BCF\u4E2A\u8FDE\u63A5\u63A5\u53D7\u548C\u53D1\u9001\u7684\u6D41\u91CF<br> \u6CE8\u610F\u663E\u793A\u6D41\u91CF\u7684\u5355\u4F4D\u4E3Ab. \u4F8B\u5982 <code>8Mb = 1MB</code>. \u6240\u6709\u6D41\u91CF\u503C\u90FD\u662F per second<br> \u6309<code>n</code>\u5173\u95ED\u4E3B\u673A\u540D\u89E3\u6790, \u6309<code>N</code>\u5173\u95ED\u7AEF\u53E3\u53F7\u89E3\u6790, \u6309<code>p</code>\u663E\u793A\u8FDE\u63A5\u7684\u7AEF\u53E3\u53F7<br><code>iftop -f &quot;port 22&quot;</code>\u8FC7\u6EE4\u53EA\u663E\u793A\u7AEF\u53E3\u4E3A22\u7684\u8FDE\u63A5\u7684\u6D41\u91CF\u4FE1\u606F, \u8FC7\u6EE4\u8BED\u6CD5\u8DDF<code>tcpdump</code>\u4E00\u6837<br> \u76F4\u63A5\u8FD0\u884C<code>iftop</code>, \u5F97\u5230\u5982\u4E0B\u4FE1\u606F:</p><blockquote><p>\u7B2C\u4E00\u884C\u7C7B\u4F3C\u523B\u5EA6\u5C3A\u7684\u523B\u5EA6\uFF0C\u4E3A\u663E\u793A\u6D41\u91CF\u56FE\u5F62\u7684\u957F\u6761\u4F5C\u6807\u5C3A\u7528\u7684\u3002<br> &lt;= =&gt;\u8FD9\u4E24\u4E2A\u5DE6\u53F3\u7BAD\u5934\uFF0C\u8868\u793A\u7684\u662F\u6D41\u91CF\u7684\u65B9\u5411\u3002<br> TX\uFF1A\u53D1\u9001\u6D41\u91CF<br> RX\uFF1A\u63A5\u6536\u6D41\u91CF<br> TOTAL\uFF1A\u603B\u6D41\u91CF<br> Cumm\uFF1A\u8FD0\u884Ciftop\u5230\u76EE\u524D\u65F6\u95F4\u7684\u603B\u6D41\u91CF<br> peak\uFF1A\u6D41\u91CF\u5CF0\u503C<br> rates\uFF1A\u5206\u522B\u8868\u793A\u8FC7\u53BB 2s 10s 40s \u7684\u5E73\u5747\u6D41\u91CF</p></blockquote><p><img src="`+e+`" alt="iftop\u4EA4\u4E92\u56FE"></p><h2 id="_53-bash\u76F8\u5173\u73AF\u5883\u53D8\u91CF" tabindex="-1">53. Bash\u76F8\u5173\u73AF\u5883\u53D8\u91CF <a class="header-anchor" href="#_53-bash\u76F8\u5173\u73AF\u5883\u53D8\u91CF" aria-hidden="true">#</a></h2><p>\u5386\u53F2\u4FE1\u606F\u663E\u793A\u65F6\u95F4\u683C\u5F0F<br> \u5982\u4E0B\u8BBE\u7F6E\u540E, \u4F7F\u7528<code>history</code>\u5C31\u4F1A\u663E\u793A\u5177\u4F53\u547D\u4EE4\u7684\u5177\u4F53\u6267\u884C\u65F6\u95F4.<br> \u53EF\u4EE5\u76F4\u63A5\u5C06\u5176\u5199\u5728 .bashrc\u6587\u4EF6\u91CC</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">HISTTIMEFORMAT=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">%d/%m/%y %T </span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre></div><p>PS1\u53D8\u91CF \u8BBE\u7F6E\u767B\u5F55\u63D0\u793A\u7B26, \u5982\u4E0B\u5E26\u989C\u8272\u663E\u793A\u5F53\u524D\u7528\u6237, \u4E3B\u673A\u540D\u548C\u5F53\u524D\u76EE\u5F55\u7684\u7EDD\u5BF9\u8DEF\u5F84.</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">PS1=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">[\\e[1;31m\\u@\\h \\e[0;34m</span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">PWD</span><span style="color:#89DDFF;">}</span><span style="color:#C3E88D;">\\e[0m]</span><span style="color:#A6ACCD;">\\\\</span><span style="color:#C3E88D;">$ </span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre></div><h2 id="_54-\u67E5\u672C\u673A\u7684\u516C\u7F51ip" tabindex="-1">54. \u67E5\u672C\u673A\u7684\u516C\u7F51IP <a class="header-anchor" href="#_54-\u67E5\u672C\u673A\u7684\u516C\u7F51ip" aria-hidden="true">#</a></h2><p>\u901A\u5E38\u6211\u4EEC\u7684\u4E3B\u673A\u90FD\u5728\u5185\u7F51, \u8BBF\u95EE\u4E92\u8054\u7F51\u662F\u90FD\u662F\u6362\u6210\u516C\u7F51IP\u540E\u53BB\u8FDE\u63A5\u7684<br> \u5982\u4E0B\u662F\u67E5\u8BE2\u6211\u4EEC\u4E3B\u673A\u7684\u516C\u7F51IP</p><ol><li>\u6253\u5F00\u767E\u5EA6 <a href="http://www.baidu.com" target="_blank" rel="noopener noreferrer">www.baidu.com</a></li><li>\u8F93\u51FA\u4E24\u4E2A\u5B57\u7B26 <code>ip</code>, \u6572\u56DE\u8F66</li><li>\u65B0\u9875\u9762\u663E\u793A\u7684\u672C\u673AIP\u5C31\u662F\u516C\u7F51IP</li></ol><h2 id="_55-\u67E5\u8BE2linux\u7CFB\u7EDF\u7684\u4E00\u4E9B\u9650\u5236\u4FE1\u606F" tabindex="-1">55. \u67E5\u8BE2linux\u7CFB\u7EDF\u7684\u4E00\u4E9B\u9650\u5236\u4FE1\u606F <a class="header-anchor" href="#_55-\u67E5\u8BE2linux\u7CFB\u7EDF\u7684\u4E00\u4E9B\u9650\u5236\u4FE1\u606F" aria-hidden="true">#</a></h2><p>\u5982\u4E0B\u6587\u7AE0\u8BE6\u7EC6\u5217\u4E3E\u4E86redhat/centos\u5404\u7248\u672C\u64CD\u4F5C\u7CFB\u7EDF\u7684\u91CD\u8981\u9650\u5236\u4FE1\u606F.<br> \u6BD4\u5982ext4\u9650\u5236, \u6700\u5927cpu, \u6700\u5927Memory<br><a href="https://access.redhat.com/articles/rhel-limits" target="_blank" rel="noopener noreferrer">https://access.redhat.com/articles/rhel-limits</a></p><h2 id="_56-\u5224\u65AD\u865A\u62DF\u5316\u7C7B\u578B\u7684n\u79CD\u65B9\u6CD5" tabindex="-1">56. \u5224\u65AD\u865A\u62DF\u5316\u7C7B\u578B\u7684N\u79CD\u65B9\u6CD5 <a class="header-anchor" href="#_56-\u5224\u65AD\u865A\u62DF\u5316\u7C7B\u578B\u7684n\u79CD\u65B9\u6CD5" aria-hidden="true">#</a></h2><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ dmidecode -s system-manufacturer</span></span>
<span class="line"><span style="color:#A6ACCD;">OpenStack Foundation</span></span>
<span class="line"></span></code></pre></div><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ systemd-detect-virt</span></span>
<span class="line"><span style="color:#A6ACCD;">kvm</span></span>
<span class="line"></span></code></pre></div><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ virt-what</span></span>
<span class="line"><span style="color:#A6ACCD;">kvm</span></span>
<span class="line"></span></code></pre></div><h2 id="_57-cpu\u4FE1\u606F\u89E3\u8BFB" tabindex="-1">57. cpu\u4FE1\u606F\u89E3\u8BFB <a class="header-anchor" href="#_57-cpu\u4FE1\u606F\u89E3\u8BFB" aria-hidden="true">#</a></h2><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ lscpu</span></span>
<span class="line"><span style="color:#A6ACCD;">Architecture:          x86_64              // \u67B6\u6784 </span></span>
<span class="line"><span style="color:#A6ACCD;">CPU op-mode</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">s</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">:        32-bit, 64-bit      // \u4F4D\u6570</span></span>
<span class="line"><span style="color:#A6ACCD;">Byte Order:            Little Endian       // \u5C0F\u7AEF</span></span>
<span class="line"><span style="color:#A6ACCD;">CPU</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">s</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">:                2                   // \u903B\u8F91cpu\u6570</span></span>
<span class="line"><span style="color:#A6ACCD;">On-line CPU</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">s</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> list:   0,1</span></span>
<span class="line"><span style="color:#A6ACCD;">Thread</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">s</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> per core:    1                   // \u4E00\u4E2A\u6838\u6709\u4E00\u4E2A\u7EBF\u7A0B. </span></span>
<span class="line"><span style="color:#A6ACCD;">Core</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">s</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> per socket:    2                   // \u4E00\u4E2A\u63D2\u69FD\u6709\u4E24\u4E2A\u6838</span></span>
<span class="line"><span style="color:#A6ACCD;">Socket</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">s</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">:             1                   // \u603B\u5171\u4E00\u4E2A\u63D2\u69FD</span></span>
<span class="line"><span style="color:#A6ACCD;">NUMA node</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">s</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">:          1</span></span>
<span class="line"><span style="color:#A6ACCD;">Vendor ID:             GenuineIntel</span></span>
<span class="line"><span style="color:#A6ACCD;">CPU family:            6</span></span>
<span class="line"><span style="color:#A6ACCD;">Model:                 69</span></span>
<span class="line"><span style="color:#A6ACCD;">Model name:            Intel</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">R</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> Core</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">TM</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> i5-4260U CPU @ 1.40GHz</span></span>
<span class="line"><span style="color:#A6ACCD;">Stepping:              1</span></span>
<span class="line"><span style="color:#A6ACCD;">CPU MHz:               2000.000</span></span>
<span class="line"><span style="color:#A6ACCD;">BogoMIPS:              4000.00</span></span>
<span class="line"><span style="color:#A6ACCD;">Hypervisor vendor:     KVM                 // \u865A\u62DF\u5316\u7C7B\u578B</span></span>
<span class="line"><span style="color:#A6ACCD;">Virtualization type:   full                // \u5168\u865A\u62DF\u5316</span></span>
<span class="line"><span style="color:#A6ACCD;">L1d cache:             32K</span></span>
<span class="line"><span style="color:#A6ACCD;">L1i cache:             32K</span></span>
<span class="line"><span style="color:#A6ACCD;">L2 cache:              256K</span></span>
<span class="line"><span style="color:#A6ACCD;">L3 cache:              3072K</span></span>
<span class="line"><span style="color:#A6ACCD;">NUMA node0 CPU</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">s</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">:     0,1</span></span>
<span class="line"><span style="color:#A6ACCD;">............</span></span>
<span class="line"></span></code></pre></div><h2 id="_58-taskset\u6307\u5B9A\u8FDB\u7A0B\u7684cpu\u4EB2\u548C\u6027" tabindex="-1">58. taskset\u6307\u5B9A\u8FDB\u7A0B\u7684CPU\u4EB2\u548C\u6027 <a class="header-anchor" href="#_58-taskset\u6307\u5B9A\u8FDB\u7A0B\u7684cpu\u4EB2\u548C\u6027" aria-hidden="true">#</a></h2><p>\u8FD4\u56DE\u7684mask\u4E3A\u5341\u516D\u8FDB\u5236, 3 \u4EE3\u8868 0x11 \u5373\u7ED1\u5B9A\u5728cpu 0 \u548C 1 \u4E0A\u9762. \u6700\u4F4E\u4F4D\u4EE3\u8868\u7B2C\u4E00\u4E2Acpu<br> taskset -p pid \u8FD4\u56DEpid\u5BF9\u5E94\u8FDB\u7A0B\u5F53\u524D\u7684\u4EB2\u548C\u6027</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ taskset -p 691</span></span>
<span class="line"><span style="color:#A6ACCD;">pid 691</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">s current affinity mask: 3</span></span>
<span class="line"></span></code></pre></div><p><code>taskset -p mask pid</code>\u8BBE\u7F6E\u8FDB\u7A0B\u7684cpu\u4EB2\u548C\u6027<br> \u4E5F\u53EF\u4EE5\u4F7F\u7528\u6570\u5B57\u4EE3\u66FFmask, \u6BD4\u5982 <code>taskset -c 0,1 -p 1</code> \u8868\u793A\u4E3Apid\u4E3A1\u7684\u8FDB\u7A0B\u7ED1\u5B9Acpu0\u548C1</p><p><code>taskset 1 ls</code> \u6267\u884Cls\u547D\u4EE4\u662F\u76F4\u63A5\u7ED1\u5B9A\u5230cpu0\u4E0A.</p><p><code>/proc/[pid]/status</code>\u4E5F\u53EF\u4EE5\u67E5\u8BE2, \u4E3E\u4F8B:</p><blockquote><p>Cpus_allowed: 3<br> Cpus_allowed_list: 0-1<br> \u89E3\u91CA:<br> Cpus_allowed:3\u6307\u51FA\u8BE5\u8FDB\u7A0B\u53EF\u4EE5\u4F7F\u7528CPU\u7684\u4EB2\u548C\u6027\u63A9\u7801,\u56E0\u4E3A\u6211\u4EEC\u6307\u5B9A\u4E3A\u4E24\u5757CPU,\u6240\u4EE5\u8FD9\u91CC\u5C31\u662F3,\u5982\u679C\u8BE5\u8FDB\u7A0B\u6307\u5B9A\u4E3A4\u4E2ACPU(\u5982\u679C\u6709\u8BDD),\u8FD9\u91CC\u5C31\u662FF(1111).<br> Cpus_allowed_list:0-1\u6307\u51FA\u8BE5\u8FDB\u7A0B\u53EF\u4EE5\u4F7F\u7528CPU\u7684\u5217\u8868,\u8FD9\u91CC\u662F0-1.</p></blockquote><p>\u8FDB\u7A0B\u8FD0\u884C\u65F6\u8BBE\u7F6E\u7684\u4EB2\u548C\u6027\u5E76\u4E0D\u5F71\u54CD\u5176\u4ED6\u7EBF\u7A0B, \u5982\u679C\u8981\u5BF9java\u8FD9\u6837\u7684\u591A\u7EBF\u7A0B\u8BBE\u7F6E, \u9700\u8981ps -efL \u627E\u5230\u6240\u6709\u7EBF\u7A0B, \u7136\u540E\u9010\u4E00\u8BBE\u7F6E<br><code>taskset 1 java</code>\u542F\u52A8java\u547D\u4EE4\u65F6\u7684\u7ED1\u5B9A, \u4F1A\u5E94\u7528\u5230\u6240\u6709\u7EBF\u7A0B, \u56E0\u4E3Acpu\u7684\u4EB2\u548C\u6027\u5177\u6709\u7EE7\u627F\u6027</p><h2 id="_59-linux\u7CFB\u7EDF\u6700\u5927\u6587\u4EF6\u6570\u91CF" tabindex="-1">59. Linux\u7CFB\u7EDF\u6700\u5927\u6587\u4EF6\u6570\u91CF <a class="header-anchor" href="#_59-linux\u7CFB\u7EDF\u6700\u5927\u6587\u4EF6\u6570\u91CF" aria-hidden="true">#</a></h2><p><code>ulimit -n</code>\u8FD4\u56DE\u5F53\u524Duser\u5355\u8FDB\u7A0B\u53EF\u6253\u5F00\u7684\u6700\u5927\u8FDB\u7A0B\u6570<br><code>/proc/[pid]/limits</code> \u67E5\u8BE2\u8BE5\u8FDB\u7A0B\u7684\u8D44\u6E90\u9650\u5236\u6570\u636E<br><code>ls -rlt /proc/[pid]/fd | wc -l</code> \u67E5\u8BE2\u8BE5\u8FDB\u7A0B\u5F53\u524D\u5DF2\u6253\u5F00\u7684\u6587\u4EF6\u6570<br><code>lsof -p [pid] | wc -l </code> \u4E5F\u53EF\u67E5\u8BE2, \u4F46\u8981\u8FC7\u6EE4\u6389cwd, \u52A8\u6001\u5E93\u7B49<br><code>ulimit -n unlimited</code>\u662F\u65E0\u6548\u7684, \u8FDB\u7A0B\u7EA7\u7684\u6587\u4EF6\u53E5\u67C4\u4E0D\u652F\u6301<code>unlimited</code>, \u6700\u5927\u503C\u4E3A <code>/proc/sys/fs/nr_open</code>, \u8BE5\u503C\u9ED8\u8BA4\u4E3A1048576.</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;"># ulimit -n 1048577</span></span>
<span class="line"><span style="color:#A6ACCD;">-bash: ulimit: op]en files: cannot modify limit: Operation not permitted</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># ulimit -n unlimited</span></span>
<span class="line"><span style="color:#A6ACCD;">-bash: ulimit: open files: cannot modify limit: Operation not permitted</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># cat /proc/sys/fs/nr_open</span></span>
<span class="line"><span style="color:#A6ACCD;">1048576</span></span>
<span class="line"></span></code></pre></div><p>\u5728centos7\u4E0A<code>nr_open</code>\u7684\u6700\u5927\u503C\u53EF\u8C03\u6574\u4E3A2147483584</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;"># sysctl -w fs.nr_open=2147483585</span></span>
<span class="line"><span style="color:#A6ACCD;">sysctl: setting key </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fs.nr_open</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">: Invalid argument</span></span>
<span class="line"><span style="color:#A6ACCD;">fs.nr_open = 2147483585</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># sysctl -w fs.nr_open=2147483584</span></span>
<span class="line"><span style="color:#A6ACCD;">fs.nr_open = 2147483584</span></span>
<span class="line"></span></code></pre></div><p>\u67E5\u8BE2\u6574\u4E2AOS\u5F53\u524D\u7684\u6587\u4EF6\u6570\u4F7F\u7528\u60C5\u51B5:<br> file-max\u663E\u793A\u6240\u6709\u8FDB\u7A0B\u7684\u6700\u5927\u6587\u4EF6\u6570, \u53EF\u901A\u8FC7<code>echo 100000 &gt; /proc/sys/fs/file-max</code>\u63D0\u9AD8</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ cat /proc/sys/fs/file-max</span></span>
<span class="line"><span style="color:#A6ACCD;">97703</span></span>
<span class="line"></span></code></pre></div><p>file-nr\u662F\u53EA\u8BFB\u7684, \u7B2C\u4E00\u4E2A\u5B57\u6BB5\u4EE3\u8868\u5DF2\u5206\u914D(\u5373\u5DF2\u6253\u5F00)\u6587\u4EF6\u6570, \u7B2C\u4E8C\u4E2A\u5B57\u6BB5\u4ECE2.6\u5F00\u59CB\u4E00\u76F4\u4E3A0, \u7B2C\u4E09\u4E2A\u5B57\u6BB5\u7B49\u4E8Efile-max</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ cat /proc/sys/fs/file-nr</span></span>
<span class="line"><span style="color:#A6ACCD;">1344	0	97703</span></span>
<span class="line"></span></code></pre></div><p>\u5217\u51FA\u6BCF\u4E2A\u8FDB\u7A0B\u7684\u5DF2\u6253\u5F00\u7684\u6587\u4EF6\u6570, \u7528\u4E8E\u627E\u5230\u5F53\u524D\u54EA\u4E2A\u8FDB\u7A0B\u5360\u7528\u6700\u591A\u6587\u4EF6\u6570<br><code>-d</code> \u7528\u4E8E\u6392\u9664cwd, \u52A8\u6001\u5E93\u4E4B\u7C7B\u7684\u4FE1\u606F<br><code>-n</code> \u4E0D\u7528\u534F\u8BAE\u89E3\u6790, \u52A0\u5FEB\u547D\u4EE4\u8FD0\u884C\u901F\u5EA6<br><code>lsof -n -d0-999999 | awk &#39;{print $2}&#39; | sort | uniq -c | sort -k1 -n</code></p><h2 id="_60-ss-\u67E5\u8BE2socket\u8FDE\u63A5\u4FE1\u606F" tabindex="-1">60. ss \u67E5\u8BE2socket\u8FDE\u63A5\u4FE1\u606F <a class="header-anchor" href="#_60-ss-\u67E5\u8BE2socket\u8FDE\u63A5\u4FE1\u606F" aria-hidden="true">#</a></h2><p>\u7C7B\u4F3C\u4E8E<code>netstat</code>, \u4F7F\u7528\u4E86netlink, \u6027\u80FD\u66F4\u597D</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">ss -s                </span><span style="color:#676E95;font-style:italic;">#\u663E\u793A\u5404socket\u7684\u7EDF\u8BA1\u4FE1\u606F</span></span>
<span class="line"><span style="color:#A6ACCD;">ss -ntlp             </span><span style="color:#676E95;font-style:italic;">#-n \u4E0D\u89E3\u6790, -t \u663E\u793Atcp\u8FDE\u63A5  -l \u663E\u793A\u76D1\u542Csocket, -p \u663E\u793A\u4F7F\u7528\u7684\u8FDB\u7A0B\u540D</span></span>
<span class="line"><span style="color:#A6ACCD;">ss -t -a             </span><span style="color:#676E95;font-style:italic;">#\u67E5\u770B\u6240\u6709tcp\u8FDE\u63A5, \u4E0D\u5E26-a\u5219\u6307\u663E\u793A Established \u8FDE\u63A5</span></span>
<span class="line"><span style="color:#A6ACCD;">ss -to               </span><span style="color:#676E95;font-style:italic;">#\u67E5\u770Btcp\u7684keepalive\u4FE1\u606F</span></span>
<span class="line"><span style="color:#A6ACCD;">ss -ti               </span><span style="color:#676E95;font-style:italic;">#\u67E5\u770Btcp\u7684\u5185\u90E8\u4FE1\u606F,\u6BD4\u5982\u62E5\u585E\u7B97\u6CD5,rto,rtt,cwnd,ssthresh\u7B49</span></span>
<span class="line"><span style="color:#A6ACCD;">ss -tm               </span><span style="color:#676E95;font-style:italic;">#\u67E5\u770Btcp\u7684\u5185\u5B58\u4F7F\u7528\u4FE1\u606F, \u6BD4\u5982\u6536\u53D1\u7F13\u51B2\u533A\u7684\u5927\u5C0F</span></span>
<span class="line"></span></code></pre></div><p>\u8FD8\u6709\u4E00\u4E9B\u9AD8\u7EA7\u7684\u8FC7\u6EE4\u7528\u6CD5</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">ss  -A raw,packet_raw  -a -p                             </span><span style="color:#676E95;font-style:italic;">#\u67E5\u770Braw socket\u7684\u4FE1\u606F</span></span>
<span class="line"><span style="color:#A6ACCD;">ss -tn  state listening                                  </span><span style="color:#676E95;font-style:italic;">#\u663E\u793A\u5904\u4E8Elistening\u72B6\u6001\u7684\u8FDE\u63A5</span></span>
<span class="line"><span style="color:#A6ACCD;">ss -tn  state established                                </span><span style="color:#676E95;font-style:italic;">#\u663E\u793A\u5904\u4E8Eestablished\u72B6\u6001\u7684\u8FDE\u63A5</span></span>
<span class="line"><span style="color:#A6ACCD;">ss -tn  state listening  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">( sport == 22 )</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">               </span><span style="color:#676E95;font-style:italic;">#\u663E\u793A\u5904\u4E8Elistening\u72B6\u6001\u4E14\u6E90\u7AEF\u53E3\u4E3A22\u7684\u8FDE\u63A5</span></span>
<span class="line"><span style="color:#A6ACCD;">ss -tn </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">( sport == 22 )</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">                                 </span><span style="color:#676E95;font-style:italic;">#\u663E\u793A\u6E90\u7AEF\u53E3\u4E3A22\u7684\u8FDE\u63A5</span></span>
<span class="line"><span style="color:#A6ACCD;">ss -tn </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">( sport != 22 )</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">                                 </span><span style="color:#676E95;font-style:italic;">#\u663E\u793A\u6E90\u7AEF\u53E3\u4E0D\u4E3A22\u7684\u8FDE\u63A5</span></span>
<span class="line"><span style="color:#A6ACCD;">ss -tn </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">( sport == 22 || dport == 22 )</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">                  </span><span style="color:#676E95;font-style:italic;">#\u663E\u793A\u6E90\u7AEF\u53E3\u4E3A22\u6216\u8005\u76EE\u6807\u7AEF\u53E3\u4E3A22\u7684\u8FDE\u63A5</span></span>
<span class="line"><span style="color:#A6ACCD;">ss -tn </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">( dst 10.211.55.2 &amp;&amp; dport == 58181 )</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">           </span><span style="color:#676E95;font-style:italic;">#\u663E\u793A\u76EE\u6807ip\u4E3A10.211.55.2\u4E14\u76EE\u6807\u7AEF\u53E3\u4E3A58181\u7684\u8FDE\u63A5</span></span>
<span class="line"><span style="color:#A6ACCD;">ss -tn </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">( src 127.0.0.1 )</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">                               </span><span style="color:#676E95;font-style:italic;">#\u663E\u793A\u6E90ip\u4E3A 127.0.0.1\u7684\u8FDE\u63A5</span></span>
<span class="line"><span style="color:#A6ACCD;">ss -tn </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">( ! dst 10.211.55.2 &amp;&amp; dport != 58181 )</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">         </span><span style="color:#676E95;font-style:italic;">#\u663E\u793A\u76EE\u6807ip\u4E0D\u662F10.211.55.2\u4E14\u76EE\u6807\u7AEF\u53E3\u4E0D\u662F58181\u7684\u8FDE\u63A5</span></span>
<span class="line"></span></code></pre></div><p>state\u540E\u9762\u652F\u6301\u7684TCP\u72B6\u6001\u5982\u4E0B:</p><div class="language-c"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#C792EA;">static</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">char</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> sstate_namel</span><span style="color:#C792EA;">[]</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">		</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">UNKNOWN</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">		</span><span style="color:#89DDFF;">[</span><span style="color:#F07178;">SS_ESTABLISHED</span><span style="color:#89DDFF;">]</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">established</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">		</span><span style="color:#89DDFF;">[</span><span style="color:#F07178;">SS_SYN_SENT</span><span style="color:#89DDFF;">]</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">syn-sent</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">		</span><span style="color:#89DDFF;">[</span><span style="color:#F07178;">SS_SYN_RECV</span><span style="color:#89DDFF;">]</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">syn-recv</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">		</span><span style="color:#89DDFF;">[</span><span style="color:#F07178;">SS_FIN_WAIT1</span><span style="color:#89DDFF;">]</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fin-wait-1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">		</span><span style="color:#89DDFF;">[</span><span style="color:#F07178;">SS_FIN_WAIT2</span><span style="color:#89DDFF;">]</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">fin-wait-2</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">		</span><span style="color:#89DDFF;">[</span><span style="color:#F07178;">SS_TIME_WAIT</span><span style="color:#89DDFF;">]</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">time-wait</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">		</span><span style="color:#89DDFF;">[</span><span style="color:#F07178;">SS_CLOSE</span><span style="color:#89DDFF;">]</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">unconnected</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">		</span><span style="color:#89DDFF;">[</span><span style="color:#F07178;">SS_CLOSE_WAIT</span><span style="color:#89DDFF;">]</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">close-wait</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">		</span><span style="color:#89DDFF;">[</span><span style="color:#F07178;">SS_LAST_ACK</span><span style="color:#89DDFF;">]</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">last-ack</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">		</span><span style="color:#89DDFF;">[</span><span style="color:#F07178;">SS_LISTEN</span><span style="color:#89DDFF;">]</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;">	</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">listening</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">		</span><span style="color:#89DDFF;">[</span><span style="color:#F07178;">SS_CLOSING</span><span style="color:#89DDFF;">]</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">closing</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">	</span><span style="color:#89DDFF;">};</span></span>
<span class="line"></span></code></pre></div><p>\u66F4\u591A\u4F7F\u7528\u4ECB\u7ECD\u8BF7\u53C2\u8003:<br><a href="https://www.cyberciti.biz/tips/linux-investigate-sockets-network-connections.html" target="_blank" rel="noopener noreferrer">https://www.cyberciti.biz/tips/linux-investigate-sockets-network-connections.html</a><br><a href="https://man7.org/linux/man-pages/man8/ss.8.html" target="_blank" rel="noopener noreferrer">https://man7.org/linux/man-pages/man8/ss.8.html</a><br><a href="https://github.com/shemminger/iproute2/blob/main/misc/ssfilter.y" target="_blank" rel="noopener noreferrer">https://github.com/shemminger/iproute2/blob/main/misc/ssfilter.y</a></p><h2 id="_61-\u6D88\u9664\u7528\u6237\u88AB\u9501\u7684\u9519\u8BEF\u767B\u5F55\u8BB0\u5F55" tabindex="-1">61. \u6D88\u9664\u7528\u6237\u88AB\u9501\u7684\u9519\u8BEF\u767B\u5F55\u8BB0\u5F55 <a class="header-anchor" href="#_61-\u6D88\u9664\u7528\u6237\u88AB\u9501\u7684\u9519\u8BEF\u767B\u5F55\u8BB0\u5F55" aria-hidden="true">#</a></h2><p>\u901A\u5E38\u7BA1\u7406\u5458\u4F1A\u914D\u7F6Epam_faillock\u6216\u8005pam_tally2, \u5F53\u7528\u6237\u4F7F\u7528\u9519\u8BEF\u5BC6\u7801\u6EE1\u8DB3\u4E00\u5B9A\u6761\u4EF6, \u5C31\u5C06\u7528\u6237\u9501\u5B9A\u4E00\u6BB5\u65F6\u95F4. \u5982\u4E0B\u662F\u5373\u65F6\u6E05\u9664\u9519\u8BEF\u8BB0\u5F55\u7684\u547D\u4EE4</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">faillock --reset</span></span>
<span class="line"><span style="color:#A6ACCD;">pam_tally2 -r -u </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">username</span><span style="color:#89DDFF;">]</span></span>
<span class="line"></span></code></pre></div><h2 id="_62-\u4F30\u8BA1rss\u603B\u548C\u7684\u5927\u5C0F" tabindex="-1">62. \u4F30\u8BA1RSS\u603B\u548C\u7684\u5927\u5C0F <a class="header-anchor" href="#_62-\u4F30\u8BA1rss\u603B\u548C\u7684\u5927\u5C0F" aria-hidden="true">#</a></h2><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">ps aux </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> awk </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">{sum+=$6} END {print sum / 1024}</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span></code></pre></div><p>\u5982\u4E0B\u811A\u672C\u4E5F\u53EF\u4EE5:</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ cat rss.sh</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#/bin/bash</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#A6ACCD;"> PROC </span><span style="color:#89DDFF;font-style:italic;">in</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">ls  /proc/</span><span style="color:#89DDFF;">|</span><span style="color:#C3E88D;">grep </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">^[0-9]</span><span style="color:#89DDFF;">&quot;\`</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">do</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-f</span><span style="color:#A6ACCD;"> /proc/</span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">PROC/statm </span><span style="color:#89DDFF;">];</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">      TEP=</span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">cat /proc/</span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">PROC</span><span style="color:#C3E88D;">/statm </span><span style="color:#89DDFF;">|</span><span style="color:#C3E88D;"> awk </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">{print ($2)}</span><span style="color:#89DDFF;">&#39;\`</span></span>
<span class="line"><span style="color:#A6ACCD;">      RSS=</span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">expr </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">RSS</span><span style="color:#C3E88D;"> + </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">TEP</span><span style="color:#89DDFF;">\`</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;font-style:italic;">fi</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">done</span></span>
<span class="line"><span style="color:#A6ACCD;">RSS=</span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">expr </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">RSS</span><span style="color:#C3E88D;"> </span><span style="color:#A6ACCD;">\\*</span><span style="color:#C3E88D;"> 4</span><span style="color:#89DDFF;">\`</span></span>
<span class="line"><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">RSS</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">KB</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre></div><h2 id="_63-\u6587\u4EF6\u7CFB\u7EDF\u4FEE\u590D" tabindex="-1">63. \u6587\u4EF6\u7CFB\u7EDF\u4FEE\u590D <a class="header-anchor" href="#_63-\u6587\u4EF6\u7CFB\u7EDF\u4FEE\u590D" aria-hidden="true">#</a></h2><p>\u9488\u5BF9xfs, \u4F7F\u7528<code>xfs_repair</code>\u547D\u4EE4:<br><code>-n</code> \u8868\u793A\u4E0D\u4FEE\u590D, \u53EA\u626B\u63CF\u5E76\u663E\u793A\u9519\u8BEF</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">xfs_repair -n -v /dev/mapper/vg-home</span></span>
<span class="line"></span></code></pre></div><p>\u4E0D\u5E26<code>-n</code>, \u6267\u884C\u4FEE\u590D. <code>-v</code>\u8868\u793A\u663E\u793A\u8BE6\u60C5</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">xfs_repair -v /dev/mapper/vg-home</span></span>
<span class="line"></span></code></pre></div><p>\u6700\u540E\u65B9\u6CD5\uFF1A\u635F\u5931\u90E8\u5206\u6570\u636E\u7684\u4FEE\u590D\u65B9\u6CD5<br> \u6839\u636E\u6253\u5370\u6D88\u606F\uFF0C\u4FEE\u590D\u5931\u8D25\u65F6\uFF1A<br> \u5148\u6267\u884Cxfs_repair -L /dev/sdd(\u6E05\u7A7A\u65E5\u5FD7\uFF0C\u4F1A\u4E22\u5931\u6587\u4EF6)\uFF0C\u518D\u6267\u884Cxfs_repair /dev/sdd\uFF0C\u518D\u6267\u884Cxfs_check /dev/sdd \u68C0\u67E5\u6587\u4EF6\u7CFB\u7EDF\u662F\u5426\u4FEE\u590D\u6210\u529F\u3002</p><blockquote><p>-L\u662F\u4FEE\u590Dxfs\u6587\u4EF6\u7CFB\u7EDF\u7684\u6700\u540E\u624B\u6BB5\uFF0C\u614E\u91CD\u9009\u62E9\uFF0C\u5B83\u4F1A\u6E05\u7A7A\u65E5\u5FD7\uFF0C\u4F1A\u4E22\u5931\u7528\u6237\u6570\u636E\u548C\u6587\u4EF6\u3002</p></blockquote><h2 id="_64-\u975E\u4EA4\u4E92\u5F0F\u4FEE\u6539\u5BC6\u7801" tabindex="-1">64. \u975E\u4EA4\u4E92\u5F0F\u4FEE\u6539\u5BC6\u7801 <a class="header-anchor" href="#_64-\u975E\u4EA4\u4E92\u5F0F\u4FEE\u6539\u5BC6\u7801" aria-hidden="true">#</a></h2><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Linux@123</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">passwd --stdin root</span></span>
<span class="line"></span></code></pre></div><h2 id="_66-udev\u7BA1\u7406" tabindex="-1">66. udev\u7BA1\u7406 <a class="header-anchor" href="#_66-udev\u7BA1\u7406" aria-hidden="true">#</a></h2><p>\u67E5\u8BE2\u8BBE\u5907\u7684\u4FE1\u606F, \u4E3B\u8981\u662F\u73AF\u5883\u53D8\u91CF</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">udevadm info /dev/sda1</span></span>
<span class="line"><span style="color:#A6ACCD;">P: /devices/pci0000:00/0000:00:1f.2/ata1/host0/target0:0:0/0:0:0:0/block/sda/sda1</span></span>
<span class="line"><span style="color:#A6ACCD;">N: sda1</span></span>
<span class="line"><span style="color:#A6ACCD;">S: disk/by-id/ata-CentOS_Linux-0_SSD_FFACPKN8NC9MK3EX3N4R-part1</span></span>
<span class="line"><span style="color:#A6ACCD;">S: disk/by-uuid/5de1c8df-9b03-4830-9b56-b96a2290b78f</span></span>
<span class="line"><span style="color:#A6ACCD;">E: DEVLINKS=/dev/disk/by-id/ata-CentOS_Linux-0_SSD_FFACPKN8NC9MK3EX3N4R-part1 /dev/disk/by-uuid/5de1c8df-9b03-4830-9b56-b96a2290b78f</span></span>
<span class="line"><span style="color:#A6ACCD;">E: DEVNAME=/dev/sda1</span></span>
<span class="line"><span style="color:#A6ACCD;">E: DEVPATH=/devices/pci0000:00/0000:00:1f.2/ata1/host0/target0:0:0/0:0:0:0/block/sda/sda1</span></span>
<span class="line"><span style="color:#A6ACCD;">E: DEVTYPE=partition</span></span>
<span class="line"><span style="color:#A6ACCD;">E: ID_ATA=1</span></span>
<span class="line"><span style="color:#A6ACCD;">E: ID_ATA_ROTATION_RATE_RPM=0</span></span>
<span class="line"><span style="color:#A6ACCD;">E: ID_ATA_SATA=1</span></span>
<span class="line"><span style="color:#A6ACCD;">E: ID_ATA_SATA_SIGNAL_RATE_GEN1=1</span></span>
<span class="line"></span></code></pre></div><p>\u52A0\u53C2\u6570<code>-a</code>, \u4E3B\u8981\u662F\u8BBE\u5907\u7684\u5C5E\u6027.</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">udevadm info -a /dev/sda1</span></span>
<span class="line"><span style="color:#A6ACCD;">P: /devices/pci0000:00/0000:00:1f.2/ata1/host0/target0:0:0/0:0:0:0/block/sda/sda1</span></span>
<span class="line"><span style="color:#A6ACCD;">N: sda1</span></span>
<span class="line"><span style="color:#A6ACCD;">S: disk/by-id/ata-CentOS_Linux-0_SSD_FFACPKN8NC9MK3EX3N4R-part1</span></span>
<span class="line"><span style="color:#A6ACCD;">S: disk/by-uuid/5de1c8df-9b03-4830-9b56-b96a2290b78f</span></span>
<span class="line"><span style="color:#A6ACCD;">E: DEVLINKS=/dev/disk/by-id/ata-CentOS_Linux-0_SSD_FFACPKN8NC9MK3EX3N4R-part1 /dev/disk/by-uuid/5de1c8df-9b03-4830-9b56-b96a2290b78f</span></span>
<span class="line"><span style="color:#A6ACCD;">E: DEVNAME=/dev/sda1</span></span>
<span class="line"><span style="color:#A6ACCD;">E: DEVPATH=/devices/pci0000:00/0000:00:1f.2/ata1/host0/target0:0:0/0:0:0:0/block/sda/sda1</span></span>
<span class="line"><span style="color:#A6ACCD;">E: DEVTYPE=partition</span></span>
<span class="line"><span style="color:#A6ACCD;">E: ID_ATA=1</span></span>
<span class="line"><span style="color:#A6ACCD;">E: ID_ATA_ROTATION_RATE_RPM=0</span></span>
<span class="line"><span style="color:#A6ACCD;">E: ID_ATA_SATA=1</span></span>
<span class="line"><span style="color:#A6ACCD;">E: ID_ATA_SATA_SIGNAL_RATE_GEN1=1</span></span>
<span class="line"></span></code></pre></div><p><code>udevadmin monitor</code>\u7528\u4E8E\u5B9E\u65F6\u76D1\u63A7udev\u5B9E\u8DF5,\u5B9A\u4F4D\u70ED\u63D2\u62D4\u8BBE\u5907\u65F6\u7279\u522B\u6709\u7528.<br><code>udevadmin test xxxx</code>\u7528\u4E8E\u6D4B\u8BD5\u5339\u914D\u8BBE\u5907\u7684\u89C4\u5219\u6267\u884C\u52A8\u4F5C.<br> xxx\u53EF\u4EE5\u662F<code>/sys/class/block/sda</code>,<code>/sys/class/net/eth0</code>, \u4E5F\u53EF\u4EE5\u662F<code>/sys/devices</code>\u4E0B\u9762\u7684\u8BBE\u5907</p><p>\u4FEE\u6539<code>/etc/udev/udev.conf</code>\u91CC\u7684<code>udev_log=&quot;debug&quot;</code>\u53EF\u4EE5\u6253\u5F00\u66F4\u8BE6\u7EC6\u7684\u65E5\u5FD7<br> \u4F7F\u7528<code>journalctl -u systemd-udevd</code>\u67E5\u770B</p><h2 id="_67-\u4E00\u6761\u547D\u4EE4\u542F\u52A8web\u670D\u52A1\u5668" tabindex="-1">67. \u4E00\u6761\u547D\u4EE4\u542F\u52A8web\u670D\u52A1\u5668 <a class="header-anchor" href="#_67-\u4E00\u6761\u547D\u4EE4\u542F\u52A8web\u670D\u52A1\u5668" aria-hidden="true">#</a></h2><p>\u67E5\u8BE2\u8BBE\u5907\u7684\u4FE1\u606F, \u4E3B\u8981\u662F\u73AF\u5883\u53D8\u91CF</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">python -m SimpleHTTPServer 8000</span></span>
<span class="line"></span></code></pre></div><h2 id="_68-dpkg-apt-get\u5305\u7BA1\u7406\u547D\u4EE4" tabindex="-1">68. dpkg,apt-get\u5305\u7BA1\u7406\u547D\u4EE4 <a class="header-anchor" href="#_68-dpkg-apt-get\u5305\u7BA1\u7406\u547D\u4EE4" aria-hidden="true">#</a></h2><p>\u67E5\u8BE2\u6240\u6709\u5305</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">dpkg -l</span></span>
<span class="line"></span></code></pre></div><p>\u67E5\u8BE2\u67D0\u4E2A\u6587\u4EF6\u5C5E\u4E8E\u54EA\u4E2A\u5305</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ dpkg -S /usr/bin/growpart</span></span>
<span class="line"><span style="color:#A6ACCD;">cloud-guest-utils: /usr/bin/growpart</span></span>
<span class="line"></span></code></pre></div><p>\u67E5\u8BE2\u4F7F\u7528apt-get\u5B89\u88C5\u7684\u5386\u53F2\u8BB0\u5F55</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ cat /var/log/apt/history.log</span></span>
<span class="line"></span></code></pre></div><h2 id="_69-\u4E3B\u673A\u5B89\u5168\u5165\u4FB5\u76D8\u67E5" tabindex="-1">69. \u4E3B\u673A\u5B89\u5168\u5165\u4FB5\u76D8\u67E5 <a class="header-anchor" href="#_69-\u4E3B\u673A\u5B89\u5168\u5165\u4FB5\u76D8\u67E5" aria-hidden="true">#</a></h2><p>\u68C0\u67E5<code>LD_PRELOAD</code>\u73AF\u5883\u53D8\u91CF<br> \u4F7F\u7528<code>vi</code>\u6253\u5F00<code>/etc/ld.so.preload</code>\u8FD9\u4E2A\u6587\u4EF6\u662F\u5426\u6709\u5185\u5BB9<br> \u4F7F\u7528<code>cat /proc/$$/mountinfo</code> \u6216\u8005<code>cat /proc/mounts </code> \u770B<code>proc</code> \u662F\u5426\u88AB\u6302\u8F7D\u5230\u5176\u4ED6\u76EE\u5F55<br> \u4F7F\u7528<code>strace</code>\u68C0\u67E5\u666E\u901A\u547D\u4EE4\u7684\u7CFB\u7EDF\u8C03\u7528<br> \u5982\u4E0B\u4E2A\u4E09\u4E2A\u5B89\u5168\u76F8\u5173\u7684\u5206\u6790\u6848\u4F8B:<br><a href="https://www.anquanke.com/post/id/160843" target="_blank" rel="noopener noreferrer">https://www.anquanke.com/post/id/160843</a><br><a href="https://superuser.com/questions/1183037/what-is-does-ld-so-preload-do" target="_blank" rel="noopener noreferrer">https://superuser.com/questions/1183037/what-is-does-ld-so-preload-do</a><br><a href="https://www.jianshu.com/p/31e487daa79d" target="_blank" rel="noopener noreferrer">https://www.jianshu.com/p/31e487daa79d</a></p><h2 id="_70-top\u547D\u4EE4" tabindex="-1">70. top\u547D\u4EE4 <a class="header-anchor" href="#_70-top\u547D\u4EE4" aria-hidden="true">#</a></h2><p>top\u9ED8\u8BA43\u79D2\u5237\u65B0\u4E00\u6B21\u4FE1\u606F, \u5BFC\u81F4\u4E00\u4E9B\u5373\u65F6\u542F\u52A8\u5E76\u7ED3\u675F\u7684\u8FDB\u7A0B\u65E0\u6CD5\u89C2\u5BDF\u5230, \u53EF\u4EE5\u7528\u5982\u4E0B\u53C2\u6570\u6307\u5B9A\u95F4\u9694:</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">top -d 0.1</span></span>
<span class="line"></span></code></pre></div><p>\u4E0A\u9762\u662F\u4EE5100ms\u4E3A\u95F4\u9694, \u4E5F\u53EF\u8FDB\u5165\u4EA4\u4E92\u6A21\u5F0F\u540E\u6309<code>d</code>\u8FDB\u884C\u52A8\u6001\u8C03\u6574<br> \u4EA4\u4E92\u6A21\u5F0F\u4E0B\u6309<code>1</code>\u663E\u793A\u6BCF\u4E2Acpu\u7684\u4F7F\u7528\u7387\u4FE1\u606F, \u6309<code>M</code> \u8FDB\u7A0B\u6309\u5185\u5B58\u6392\u5E8F, \u6309<code>H</code>\u663E\u793A\u7EBF\u7A0B\u4FE1\u606F</p><p>top\u8FDB\u7A0B\u7EA7\u7684\u9ED8\u8BA4\u5B57\u6BB5\u5982\u679C\u4E0D\u591F, \u53EF\u4EE5\u6309<code>f</code>\u9009\u62E9\u8981\u663E\u793A\u7684\u5B57\u6BB5,\u6BD4\u5982<code>last cpu used</code>, \u7136\u540E\u6309<code>q</code>\u8FD4\u56DE\u663E\u793A<br><code>f</code>\u540E\u4E0D\u4EC5\u53EF\u4EE5\u589E\u52A0,\u5220\u9664,\u8C03\u6574\u5B57\u6BB5\u987A\u5E8F, \u8FD8\u53EF\u4EE5\u6309<code>s</code>\u5C06\u5F53\u524D\u9009\u4E2D\u7684\u5B57\u6BB5\u4F5C\u4E3A\u6392\u5E8F\u7684\u5B57\u6BB5. \u6BD4\u5982\u6309\u5185\u5B58\u6392\u5E8F<br> \u5982\u679C\u8981\u8FC7\u6EE4\u8FDB\u7A0B, \u6BD4\u5982\u53EA\u663E\u793Acmdline \u5305\u542B\u5B57\u7B26abc\u7684\u8FDB\u7A0B, \u6309<code>o</code>\u540E\u8F93\u5165<code>COMMAND=abc</code>, \u78B0\u5230java\u8FD9\u79CD\u8FDB\u7A0B, \u53EF\u4EE5\u6309<code>c</code>\u663E\u793A\u5B8C\u6574\u7684\u547D\u4EE4\u884C</p><p>\u67E5\u770B\u5355\u4E2A\u8FDB\u7A0B\u7684\u6240\u6709\u7EBF\u7A0B\u4FE1\u606F, \u5BF9java\u7A0B\u5E8F\u7279\u522B\u6709\u7528</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ top -Hp 4592</span></span>
<span class="line"><span style="color:#A6ACCD;">Threads:  11 total,   0 running,  11 sleeping,   0 stopped,   0 zombie</span></span>
<span class="line"><span style="color:#A6ACCD;">%Cpu</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">s</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">:  0.0 us,  0.0 sy,  0.0 ni, 98.4 id,  0.0 wa,  1.6 hi,  0.0 si,  0.0 st</span></span>
<span class="line"><span style="color:#A6ACCD;">MiB Mem </span><span style="color:#82AAFF;">:</span><span style="color:#A6ACCD;">   7809.8 total,   5711.5 free,    910.8 used,   1187.6 buff/cache</span></span>
<span class="line"><span style="color:#A6ACCD;">MiB Swap:      0.0 total,      0.0 free,      0.0 used.   6748.4 avail Mem</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    PID USER      PR  NI    VIRT    RES    SHR S  %CPU  %MEM     TIME+ COMMAND</span></span>
<span class="line"><span style="color:#A6ACCD;">   4592 root      20   0 1810424 372332  14820 S   0.0   4.7   0:06.87 gopls</span></span>
<span class="line"><span style="color:#A6ACCD;">   4593 root      20   0 1810424 372332  14820 S   0.0   4.7   0:06.01 gopls</span></span>
<span class="line"><span style="color:#A6ACCD;">   4594 root      20   0 1810424 372332  14820 S   0.0   4.7   0:00.68 gopls</span></span>
<span class="line"><span style="color:#A6ACCD;">   4595 root      20   0 1810424 372332  14820 S   0.0   4.7   0:07.53 gopls</span></span>
<span class="line"><span style="color:#A6ACCD;">   4596 root      20   0 1810424 372332  14820 S   0.0   4.7   0:00.58 gopls</span></span>
<span class="line"><span style="color:#A6ACCD;">   4597 root      20   0 1810424 372332  14820 S   0.0   4.7   0:00.00 gopls</span></span>
<span class="line"><span style="color:#A6ACCD;">   4598 root      20   0 1810424 372332  14820 S   0.0   4.7   0:06.96 gopls</span></span>
<span class="line"><span style="color:#A6ACCD;">   4605 root      20   0 1810424 372332  14820 S   0.0   4.7   0:06.64 gopls</span></span>
<span class="line"><span style="color:#A6ACCD;">   4644 root      20   0 1810424 372332  14820 S   0.0   4.7   0:06.70 gopls</span></span>
<span class="line"><span style="color:#A6ACCD;">   4647 root      20   0 1810424 372332  14820 S   0.0   4.7   0:00.01 gopls</span></span>
<span class="line"><span style="color:#A6ACCD;">   4818 root      20   0 1810424 372332  14820 S   0.0   4.7   0:00.27 gopls</span></span>
<span class="line"></span></code></pre></div><h2 id="_71-ping\u547D\u4EE4" tabindex="-1">71. ping\u547D\u4EE4 <a class="header-anchor" href="#_71-ping\u547D\u4EE4" aria-hidden="true">#</a></h2><p><code>-i</code>\u6307\u5B9A\u4E24\u6B21ping\u4E4B\u524D\u7684\u95F4\u9694, \u9ED8\u8BA4\u662F1s</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">ping -i 0.1 www.163.com</span></span>
<span class="line"></span></code></pre></div><p><code>-s</code>\u6307\u5B9Aping\u5305\u7684\u5927\u5C0F, \u9ED8\u8BA4\u662F64bytes</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ ping -s 1024 www.163.com</span></span>
<span class="line"><span style="color:#A6ACCD;">PING z163ipv6.v.bsgslb.cn </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">117.23.1.15</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> 1024</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">1052</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> bytes of data.</span></span>
<span class="line"><span style="color:#A6ACCD;">1032 bytes from 117.23.1.15: icmp_seq=1 ttl=128 time=7.03 ms</span></span>
<span class="line"><span style="color:#A6ACCD;">1032 bytes from 117.23.1.15: icmp_seq=2 ttl=128 time=7.77 ms</span></span>
<span class="line"></span></code></pre></div><h2 id="_72-ping\u548Ccurl\u5E38\u89C1\u7684\u7F51\u7EDC\u62A5\u9519" tabindex="-1">72. ping\u548Ccurl\u5E38\u89C1\u7684\u7F51\u7EDC\u62A5\u9519 <a class="header-anchor" href="#_72-ping\u548Ccurl\u5E38\u89C1\u7684\u7F51\u7EDC\u62A5\u9519" aria-hidden="true">#</a></h2><p>ping ip \u62A5\u9519\uFF1A<br><code>connect: Network is unreachable</code> \u539F\u56E0\u662FOS\u91CC\u6CA1\u6709\u76F8\u5173\u8DEF\u7531\u5BFC\u81F4<br><code>From 192.168.100.1 icmp_seq=1 Destination Port Unreachable</code> \u539F\u56E0\u662F\u6536\u5230icmp reponse, \u7AEF\u53E3\u4E0D\u53EF\u8FBE\uFF0C \u4E2D\u95F4\u8BBE\u5907\u6216\u8005iptable reject</p><p>cur ip \u4E00\u4E9B\u62A5\u9519:<br><code>curl: (7) Failed to connect to 114.114.114.114: Network is unreachable</code> \u539F\u56E0\u662FOS\u91CC\u6CA1\u6709\u76F8\u5173\u8DEF\u7531\u5BFC\u81F4 \u5F88\u5FEB\u8FD4\u56DE<code>curl: (7) Failed connect to 114.114.114.114:80; Connection refused</code> \u56E0\u4E3ACurl\u6536\u5230icmp \u5E94\u7B54\u6D88\u606F 80\u7AEF\u53E3\u4E0D\u53EF\u8FBE\uFF0C \u53EF\u80FD\u662F\u4E2D\u95F4\u8BBE\u5907iptable\u53D1\u9001\u6216\u8005\u6536\u5230\u670D\u52A1\u7AEFrst\u6D88\u606F\uFF0C 80\u7AEF\u53E3\u6CA1\u6709\u5904\u4E8E\u76D1\u542C\u72B6\u6001</p><h2 id="_73-\u4E00\u4E9B\u5E38\u7528\u7684\u5185\u5B58\u7EDF\u8BA1\u547D\u4EE4" tabindex="-1">73. \u4E00\u4E9B\u5E38\u7528\u7684\u5185\u5B58\u7EDF\u8BA1\u547D\u4EE4 <a class="header-anchor" href="#_73-\u4E00\u4E9B\u5E38\u7528\u7684\u5185\u5B58\u7EDF\u8BA1\u547D\u4EE4" aria-hidden="true">#</a></h2><p>\u7EDF\u8BA1\u6240\u6709\u8FDB\u7A0B\u5360\u7528\u7684\u7269\u7406\u5185\u5B58</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;"># \u4F7F\u7528 grep \u67E5\u627E Pss \u6307\u6807\u540E\uFF0C\u518D\u7528 awk \u8BA1\u7B97\u7D2F\u52A0\u503C</span></span>
<span class="line"><span style="color:#A6ACCD;">$ grep Pss /proc/</span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">1-9</span><span style="color:#89DDFF;">]*</span><span style="color:#A6ACCD;">/smaps </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> awk </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">{total+=$2}; END {printf &quot;%d kB\\n&quot;, total }</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">391266 kB</span></span>
<span class="line"></span></code></pre></div><p>\u6709\u65F6smaps\u6587\u4EF6\u4F1A\u770B\u5230\u6CA1\u6709\u8BFB\u5199\u6743\u9650\u7684\u5185\u5B58\u6BB5,\u4F46\u6709p\u8FD9\u4E2A\u6743\u9650,\u5373\u662F\u5185\u5B58,\u5F80\u5F80\u53D1\u751F\u5728libc\u8FD9\u6837\u7684\u5171\u4EAB\u5E93\u548Cjava\u7A0B\u5E8F.<br> \u5982\u4E0B\u6587\u7AE0\u89E3\u91CA\u4E86\u5177\u4F53\u7684\u76EE\u7684, java\u7A0B\u5E8F\u7684\u60C5\u51B5\u4E0B\u7ECF\u5E38\u5360\u7528\u4E86\u5F88\u5927\u7684\u5185\u5B58, \u53EA\u8981\u662F\u4E3A\u4E86\u9884\u7559\u4E00\u6BB5\u8FDE\u7EED\u7684\u5185\u5B58\u5FEB<br> \u8FD9\u4E9B\u5185\u5B58\u662F\u4E0D\u4F1A\u8BA1\u7B97\u5230<code>Rss</code>\u6216\u8005<code>Pss</code>\u91CC\u9762, \u4F46\u5374\u5B9E\u5B9E\u5728\u5728\u5360\u7528\u4E86\u5185\u5B58.<br><a href="https://unix.stackexchange.com/questions/226283/shared-library-mappings-in-proc-pid-maps" target="_blank" rel="noopener noreferrer">https://unix.stackexchange.com/questions/226283/shared-library-mappings-in-proc-pid-maps</a><br><a href="https://unix.stackexchange.com/questions/353676/what-is-the-purpose-of-seemingly-unusable-memory-mappings-in-linux/353685#353685" target="_blank" rel="noopener noreferrer">https://unix.stackexchange.com/questions/353676/what-is-the-purpose-of-seemingly-unusable-memory-mappings-in-linux/353685#353685</a></p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">7fae7db9f000-7fae7dc8f000 r-xp 00000000 08:05 536861                     /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.20</span></span>
<span class="line"><span style="color:#A6ACCD;">7fae7dc8f000-7fae7de8f000 ---p 000f0000 08:05 536861                     /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.20</span></span>
<span class="line"><span style="color:#A6ACCD;">7fae7de8f000-7fae7de97000 r--p 000f0000 08:05 536861                     /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.20</span></span>
<span class="line"><span style="color:#A6ACCD;">7fae7de97000-7fae7de99000 rw-p 000f8000 08:05 536861                     /usr/lib/x86_64-linux-gnu/libstdc++.so.6.0.20</span></span>
<span class="line"></span></code></pre></div><p>\u8FD9\u7BC7\u6587\u7AE0\u8BE6\u7EC6\u5730\u4ECB\u7ECD\u4E86<code>/proc/meminfo</code>\u91CC\u7684\u6BCF\u4E00\u4E2A\u5B57\u6BB5\u7684\u542B\u4E49\u548C\u4E00\u4E9B\u6709\u7528\u7684\u516C\u5F0F.<br><a href="http://linuxperf.com/?p=142" target="_blank" rel="noopener noreferrer">http://linuxperf.com/?p=142</a></p><h2 id="_74-\u4E0D\u540Cos\u7684\u6587\u4EF6\u7F16\u7801" tabindex="-1">74. \u4E0D\u540COS\u7684\u6587\u4EF6\u7F16\u7801 <a class="header-anchor" href="#_74-\u4E0D\u540Cos\u7684\u6587\u4EF6\u7F16\u7801" aria-hidden="true">#</a></h2><p>linux\u663E\u793A\u6587\u4EF6\u5185\u5BB9\u7684\u7F16\u7801\u65B9\u5F0F</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ file -i old.txt</span></span>
<span class="line"><span style="color:#A6ACCD;">old.txt: text/plain</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> charset=us-ascii</span></span>
<span class="line"></span></code></pre></div><p>\u5C06\u6587\u4EF6abc.txt \u7F16\uFFFD\uFFFD\uFFFD\uFFFD\u65B9\u5F0F\u4ECEiso8859-1\u6539\u4E3Autf-8</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">iconv -f iso8859-1 -t utf-8 abc.txt </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> abc.txt.utf8</span></span>
<span class="line"></span></code></pre></div><p>\u8BB2\u5F53\u524D\u6587\u4EF6\u5939\u6240\u6709\u6587\u4EF6\u7684\u6587\u4EF6\u540D\u7F16\u7801\u4ECEGBK\u6539\u4E3AUTF-8, <code>-r</code>\u8868\u793A\u9012\u5F52\u6240\u6709\u5B50\u6587\u4EF6\u5939</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">convmv -f GBk -t UTF-8 --notest -r </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">\uFF0C\u8FD9</span></span>
<span class="line"></span></code></pre></div><p>\u53C2\u8003: <a href="http://kuring.me/post/windows_linux_code/" target="_blank" rel="noopener noreferrer">http://kuring.me/post/windows_linux_code/</a></p><h2 id="_75-\u4E00\u4E9Bshell\u5FAA\u73AF\u547D\u4EE4" tabindex="-1">75. \u4E00\u4E9Bshell\u5FAA\u73AF\u547D\u4EE4 <a class="header-anchor" href="#_75-\u4E00\u4E9Bshell\u5FAA\u73AF\u547D\u4EE4" aria-hidden="true">#</a></h2><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;font-style:italic;">while</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">true</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">do</span><span style="color:#A6ACCD;"> cat /proc/stat  </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> grep </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">cpu </span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> sleep 30</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">done</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#A6ACCD;"> n </span><span style="color:#89DDFF;font-style:italic;">in</span><span style="color:#A6ACCD;"> {1..1000}</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">do</span><span style="color:#A6ACCD;"> touch a</span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">n</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> rm -rf a</span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">n</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">done</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#A6ACCD;"> file </span><span style="color:#89DDFF;font-style:italic;">in</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$(</span><span style="color:#C3E88D;">ls -1 /proc/</span><span style="color:#89DDFF;">[</span><span style="color:#C3E88D;">1-9</span><span style="color:#89DDFF;">]*</span><span style="color:#C3E88D;">/status</span><span style="color:#89DDFF;">)</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">do</span><span style="color:#A6ACCD;"> grep Name </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">file</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">done</span></span>
<span class="line"></span></code></pre></div><h2 id="_76-dhcp\u6301\u7EED\u8BF7\u6C42\u914D\u7F6E" tabindex="-1">76. dhcp\u6301\u7EED\u8BF7\u6C42\u914D\u7F6E <a class="header-anchor" href="#_76-dhcp\u6301\u7EED\u8BF7\u6C42\u914D\u7F6E" aria-hidden="true">#</a></h2><p>Network\u7BA1\u7406\u65F6, \u5982\u679C\u8981\u5728dhcp\u83B7\u53D6ip\u5931\u8D25\u540E\u4E0D\u65AD\u91CD\u8BD5,\u5219\u5728<code>ifcfg-ethX</code>\u6587\u4EF6\u91CC\u589E\u52A0<code>PERSISTENT_DHCLIENT=yes</code><br> \u9ED8\u8BA4\u662F1\u5206\u949F\u540E\u8D85\u65F6, \u4E0D\u91CD\u8BD5,\u65E5\u5FD7\u6253\u5370<code>no dhcpoffers received</code><br> \u5982\u679C\u52A0\u53C2\u6570, 1\u5206\u949F\u8D85\u65F6, \u7136\u540E\u4E00\u4E2A\u968F\u673A\u7684\u65F6\u95F4\u95F4\u9694\u540E\u518D\u6B21\u91CD\u8BD5. \u4E00\u76F4\u91CD\u8BD5\u5230\u6210\u529F\u83B7\u53D6ip,\u65E5\u5FD7\u6253\u5370\u5982\u4E0B:</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">no dhcpoffers received</span></span>
<span class="line"><span style="color:#A6ACCD;">no working leases </span><span style="color:#89DDFF;font-style:italic;">in</span><span style="color:#A6ACCD;"> persistent database - sleeping</span></span>
<span class="line"></span></code></pre></div><p>\u5982\u679C\u5E95\u5C42\u7F51\u5361\u6709down, up\u52A8\u4F5C, dhcp\u8FDB\u7A0B\u8FD8\u5728, \u53EA\u663E\u793A\u4E00\u6761\u62A5\u9519\u4FE1\u606F<code>receive_packet failed on eth0: Network is down</code><br> \u5F53\u901A\u8FC7dhcp\u83B7\u53D6ip\u5931\u8D25\u540E, \u5982\u679C\u914D\u7F6E\u4E86\u6301\u7EED\u83B7\u53D6, \u90A3\u4E48\u4E0B\u6B21\u53D1\u8D77\u8BF7\u6C42\u7684\u65F6\u95F4\u95F4\u9694\u662F\u4E2A\u968F\u673A\u503C,\u5927\u81F4\u4E3A150s~450s\u4E4B\u95F4.<br> \u5177\u4F53\u7684\u4EE3\u7801\u5982\u4E0B, <code>retry_interval</code>\u9ED8\u8BA4\u662F300s,\u4E14\u4E0D\u53EF\u8C03\u6574<br><a href="https://github.com/42wim/isc-dhcp/blob/f54a146c7fe88889d60f0c1aa8e6f04707f95223/client/dhclient.c" target="_blank" rel="noopener noreferrer">https://github.com/42wim/isc-dhcp/blob/f54a146c7fe88889d60f0c1aa8e6f04707f95223/client/dhclient.c</a></p><div class="language-c"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#82AAFF;">log_info</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">No working leases in persistent database - sleeping.</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#82AAFF;">script_init</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">client</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">FAIL</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">struct</span><span style="color:#A6ACCD;"> string_list </span><span style="color:#89DDFF;">*)</span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">client </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> alias</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">		</span><span style="color:#82AAFF;">script_write_params</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">client</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">alias_</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> client </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> alias</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#82AAFF;">script_go</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">client</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">	client </span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;"> state </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> S_INIT</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">	tv.tv_sec </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> cur_tv.tv_sec </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">((</span><span style="color:#A6ACCD;">client</span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;">config</span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;">retry_interval </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span></span>
<span class="line"><span style="color:#A6ACCD;">		    </span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">random</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">%</span><span style="color:#A6ACCD;"> client</span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;">config</span><span style="color:#89DDFF;">-&gt;</span><span style="color:#A6ACCD;">retry_interval</span><span style="color:#89DDFF;">));</span></span>
<span class="line"><span style="color:#A6ACCD;">	tv.tv_usec </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">((</span><span style="color:#A6ACCD;">tv.tv_sec </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> cur_tv.tv_sec</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">?</span></span>
<span class="line"><span style="color:#A6ACCD;">			</span><span style="color:#82AAFF;">random</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">%</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1000000</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> cur_tv.tv_usec</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#82AAFF;">add_timeout</span><span style="color:#89DDFF;">(&amp;</span><span style="color:#A6ACCD;">tv</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> state_init</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> client</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#82AAFF;">detach</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">();</span></span>
<span class="line"></span></code></pre></div><p>NetworkManager\u7BA1\u7406\u65F6, \u4E24\u4E2A\u65B9\u6CD5\u914D\u7F6E\u6301\u4E45\u5316:<br> \u4F7F\u7528\u7C7B\u4F3C\u547D\u4EE4\u4FEE\u6539<code>nmcli connection modify enps1s0 ipv4.dhcp-timeout infinity</code><br> \u5728<code>ifcfg-ethX</code>\u91CC\u589E\u52A0<code>IPV4_DHCP_TIMEOUT=2147483647</code><br> \u53C2\u8003 <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/networking_guide/configuring_the_dhcp_client_behavior" target="_blank" rel="noopener noreferrer">https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/networking_guide/configuring_the_dhcp_client_behavior</a></p><h2 id="_77-\u89E3\u6790-proc-pid-status\u91CC\u5173\u4E8E\u4FE1\u53F7\u7684\u5B57\u6BB5" tabindex="-1">77. \u89E3\u6790/proc/[pid]/status\u91CC\u5173\u4E8E\u4FE1\u53F7\u7684\u5B57\u6BB5 <a class="header-anchor" href="#_77-\u89E3\u6790-proc-pid-status\u91CC\u5173\u4E8E\u4FE1\u53F7\u7684\u5B57\u6BB5" aria-hidden="true">#</a></h2><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;">#read -p &quot;PID=&quot; pid</span></span>
<span class="line"><span style="color:#A6ACCD;">pid=</span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">1</span></span>
<span class="line"><span style="color:#A6ACCD;">cat /proc/</span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">pid/status</span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">egrep </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">(Sig|Shd)(Pnd|Blk|Ign|Cgt)</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">while </span><span style="color:#82AAFF;">read</span><span style="color:#A6ACCD;"> name mask</span><span style="color:#89DDFF;">;</span><span style="color:#89DDFF;font-style:italic;">do</span></span>
<span class="line"><span style="color:#A6ACCD;">    bin=</span><span style="color:#89DDFF;">$(</span><span style="color:#C3E88D;">echo </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ibase=16; obase=2; </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">mask^^</span><span style="color:#89DDFF;">*}&quot;|</span><span style="color:#C3E88D;">bc</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> -n </span><span style="color:#89DDFF;">&quot;$</span><span style="color:#A6ACCD;">name</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">mask</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">bin</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">    i=1</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">while</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[[</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">bin </span><span style="color:#89DDFF;">-ne</span><span style="color:#A6ACCD;"> 0 </span><span style="color:#89DDFF;">]];</span><span style="color:#89DDFF;font-style:italic;">do</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">[[</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">bin</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;">(-1)</span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-eq</span><span style="color:#A6ACCD;"> 1 </span><span style="color:#89DDFF;">]];</span><span style="color:#89DDFF;font-style:italic;">then</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#82AAFF;">kill</span><span style="color:#A6ACCD;"> -l </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">i </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> tr </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">\\n</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;"> </span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;font-style:italic;">fi</span></span>
<span class="line"><span style="color:#A6ACCD;">        bin=</span><span style="color:#89DDFF;">\${</span><span style="color:#A6ACCD;">bin</span><span style="color:#89DDFF;">::-</span><span style="color:#A6ACCD;">1</span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#82AAFF;">set</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$((</span><span style="color:#C3E88D;">i</span><span style="color:#89DDFF;">++))</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">done</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#82AAFF;">echo</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">done</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"># vim:et:sw=4:ts=4:sts=4:</span></span>
<span class="line"></span></code></pre></div><p>\u53C2\u8003\u94FE\u63A5: <a href="https://stackoverflow.com/questions/4155483/proc-pidstatus-sigign-field" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/questions/4155483/proc-pidstatus-sigign-field</a></p><h2 id="_78-\u5BA1\u8BA1\u8C01\u6740\u4E86\u8FDB\u7A0B" tabindex="-1">78. \u5BA1\u8BA1\u8C01\u6740\u4E86\u8FDB\u7A0B <a class="header-anchor" href="#_78-\u5BA1\u8BA1\u8C01\u6740\u4E86\u8FDB\u7A0B" aria-hidden="true">#</a></h2><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">auditctl -a always,exit -F arch=b64 -F a1=15 -S </span><span style="color:#82AAFF;">kill</span><span style="color:#A6ACCD;"> -k log_kill</span></span>
<span class="line"><span style="color:#A6ACCD;">auditctl -a always,exit -F arch=b64 -F a1=9 -S </span><span style="color:#82AAFF;">kill</span><span style="color:#A6ACCD;"> -k log_kill</span></span>
<span class="line"></span></code></pre></div><p>\u53C2\u8003: <a href="https://jotdownux.wordpress.com/2016/01/23/whos-killing-that-process-whos-dumping-prelink-files-in-tmp-linux-auditd-to-the-rescue/" target="_blank" rel="noopener noreferrer">https://jotdownux.wordpress.com/2016/01/23/whos-killing-that-process-whos-dumping-prelink-files-in-tmp-linux-auditd-to-the-rescue/</a></p><h2 id="_79-\u4FEE\u6539\u5B57\u7B26\u96C6\u7684\u547D\u4EE4" tabindex="-1">79. \u4FEE\u6539\u5B57\u7B26\u96C6\u7684\u547D\u4EE4 <a class="header-anchor" href="#_79-\u4FEE\u6539\u5B57\u7B26\u96C6\u7684\u547D\u4EE4" aria-hidden="true">#</a></h2><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">localectl set-locale LANG=en_US.UTF-8</span></span>
<span class="line"><span style="color:#A6ACCD;">localectl set-locale LANG=zh_CN.UTF-8</span></span>
<span class="line"><span style="color:#A6ACCD;">localectl list-locales</span></span>
<span class="line"></span></code></pre></div><h2 id="_80-bash\u811A\u672C\u7684\u9000\u51FA\u7801" tabindex="-1">80. bash\u811A\u672C\u7684\u9000\u51FA\u7801 <a class="header-anchor" href="#_80-bash\u811A\u672C\u7684\u9000\u51FA\u7801" aria-hidden="true">#</a></h2><p>\u811A\u672C\u9000\u51FA\u7801\u662F\u6709\u7279\u6B8A\u542B\u4E49\u7684,\u6BD4\u5982\u5E38\u89C1\u7684<code>127</code>\u4EE3\u8868\u811A\u672C\u91CC\u7684\u547D\u4EE4\u6CA1\u627E\u5230,<code>130</code>\u4EE3\u8868\u7528\u6237\u6309\u4E86<code>ctrl+c</code>\u5BFC\u81F4\u811A\u672C\u505C\u6B62</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ abc</span></span>
<span class="line"><span style="color:#A6ACCD;">-bash: abc: </span><span style="color:#82AAFF;">command</span><span style="color:#A6ACCD;"> not found</span></span>
<span class="line"><span style="color:#A6ACCD;">$ </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">?</span></span>
<span class="line"><span style="color:#A6ACCD;">127</span></span>
<span class="line"><span style="color:#A6ACCD;">$ sleep 1000</span></span>
<span class="line"><span style="color:#A6ACCD;">^C</span></span>
<span class="line"><span style="color:#A6ACCD;">$ </span><span style="color:#82AAFF;">echo</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">$</span><span style="color:#A6ACCD;">?</span></span>
<span class="line"><span style="color:#A6ACCD;">130</span></span>
<span class="line"></span></code></pre></div><p>\u66F4\u8BE6\u7EC6\u7684\u9000\u51FA\u7801\u542B\u4E49\u8BF7\u53C2\u89C1 <a href="https://tldp.org/LDP/abs/html/exitcodes.html" target="_blank" rel="noopener noreferrer">https://tldp.org/LDP/abs/html/exitcodes.html</a></p><h2 id="_81-\u6A21\u62DF\u4E0D\u65AD\u589E\u52A0\u5185\u5B58\u81F4\u4F7F\u89E6\u53D1oom\u7684\u7A0B\u5E8F" tabindex="-1">81. \u6A21\u62DF\u4E0D\u65AD\u589E\u52A0\u5185\u5B58\u81F4\u4F7F\u89E6\u53D1oom\u7684\u7A0B\u5E8F <a class="header-anchor" href="#_81-\u6A21\u62DF\u4E0D\u65AD\u589E\u52A0\u5185\u5B58\u81F4\u4F7F\u89E6\u53D1oom\u7684\u7A0B\u5E8F" aria-hidden="true">#</a></h2><div class="language-c"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">#include</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">stdio.h</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">#include</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#C3E88D;">stdlib.h</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">int</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">main</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">void</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">  </span></span>
<span class="line"><span style="color:#F07178;">         </span><span style="color:#C792EA;">int</span><span style="color:#F07178;"> n </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">;</span><span style="color:#F07178;">  </span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">         </span><span style="color:#89DDFF;font-style:italic;">while</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">  </span></span>
<span class="line"><span style="color:#F07178;">                 </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#82AAFF;">malloc</span><span style="color:#89DDFF;">(</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">&lt;&lt;</span><span style="color:#F78C6C;">20</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">==</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">NULL)</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;">  </span></span>
<span class="line"><span style="color:#F07178;">                         </span><span style="color:#82AAFF;">printf</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">malloc failure after %d MiB</span><span style="color:#A6ACCD;">\\n</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> n</span><span style="color:#89DDFF;">);</span><span style="color:#F07178;">  </span></span>
<span class="line"><span style="color:#F07178;">                         </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">;</span><span style="color:#F07178;">  </span></span>
<span class="line"><span style="color:#F07178;">                 </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">  </span></span>
<span class="line"><span style="color:#F07178;">                 </span><span style="color:#82AAFF;">printf</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">got %d MiB</span><span style="color:#A6ACCD;">\\n</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">++</span><span style="color:#F07178;">n</span><span style="color:#89DDFF;">);</span><span style="color:#F07178;">  </span></span>
<span class="line"><span style="color:#F07178;">         </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">  </span></span>
<span class="line"><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">  </span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;"> $ gcc memtest1.c  </span></span>
<span class="line"><span style="color:#A6ACCD;"> $ .</span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;">a.out  </span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;"> got </span><span style="color:#F78C6C;">570528</span><span style="color:#A6ACCD;"> MiB  </span></span>
<span class="line"><span style="color:#A6ACCD;"> got </span><span style="color:#F78C6C;">570529</span><span style="color:#A6ACCD;"> MiB  </span></span>
<span class="line"><span style="color:#A6ACCD;"> got </span><span style="color:#F78C6C;">570530</span><span style="color:#A6ACCD;"> MiB  </span></span>
<span class="line"><span style="color:#A6ACCD;"> got </span><span style="color:#F78C6C;">570531</span><span style="color:#A6ACCD;"> MiBKilled</span></span>
<span class="line"></span></code></pre></div><p>\u5177\u4F53\u7684\u8BE6\u7EC6\u6D4B\u8BD5\u6B65\u9AA4: <a href="https://access.redhat.com/solutions/47692" target="_blank" rel="noopener noreferrer">https://access.redhat.com/solutions/47692</a></p><h2 id="_82-vi\u5B9E\u73B0\u5341\u516D\u8FDB\u5236\u7F16\u8F91\u529F\u80FD" tabindex="-1">82. vi\u5B9E\u73B0\u5341\u516D\u8FDB\u5236\u7F16\u8F91\u529F\u80FD <a class="header-anchor" href="#_82-vi\u5B9E\u73B0\u5341\u516D\u8FDB\u5236\u7F16\u8F91\u529F\u80FD" aria-hidden="true">#</a></h2><p>vim\u914D\u5408xxd\u5BF9\u6587\u4EF6\u8FDB\u884C\u5341\u516D\u8FDB\u5236\u7684\u7F16\u8F91,\u8FBE\u5230\u7C7B\u4F3CUltraEdit\u7684\u6548\u679C</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">vi abc.txt</span></span>
<span class="line"><span style="color:#A6ACCD;">:%</span><span style="color:#89DDFF;">!</span><span style="color:#A6ACCD;">xxd</span></span>
<span class="line"><span style="color:#A6ACCD;">\u4FEE\u6539\u5B8C\u540E,\u8FD0\u884C\u4E0B\u9762\u7684\u547D\u4EE4. \u6CE8\u610F\u5DE6\u8FB9\u6539\u52A8\u4F1A\u751F\u6548,\u53F3\u8FB9\u7684\u6587\u672C\u6539\u52A8\u4E0D\u751F\u6548</span></span>
<span class="line"><span style="color:#A6ACCD;">:%</span><span style="color:#89DDFF;">!</span><span style="color:#A6ACCD;">xxd -r</span></span>
<span class="line"></span></code></pre></div><p>\u66F4\u8BE6\u7EC6\u7684\u8BF7\u770B <a href="https://www.cnblogs.com/meibenjin/archive/2012/12/06/2806396.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/meibenjin/archive/2012/12/06/2806396.html</a></p><h2 id="_83-iproute\u8F6F\u4EF6\u5305\u91CC\u7684\u4E00\u4E9B\u5E38\u7528\u547D\u4EE4" tabindex="-1">83. iproute\u8F6F\u4EF6\u5305\u91CC\u7684\u4E00\u4E9B\u5E38\u7528\u547D\u4EE4 <a class="header-anchor" href="#_83-iproute\u8F6F\u4EF6\u5305\u91CC\u7684\u4E00\u4E9B\u5E38\u7528\u547D\u4EE4" aria-hidden="true">#</a></h2><p><code>ifstat</code>\u6253\u5370\u7F51\u5361\u7684\u4E00\u4E9B\u7EDF\u8BA1\u4FE1\u606F,\u7C7B\u4F3C<code>ifconfig</code>\u91CC\u7684\u8F93\u51FA,\u4F46\u6BCF\u6B21\u8FD0\u884C\u65F6\u8F93\u51FA\u4ECE\u4E0A\u6B21\u8FD0\u884C\u4E4B\u540E\u8FD9\u6BB5\u65F6\u95F4\u7684\u7EDF\u8BA1,\u800C<code>ifconfig</code>\u662F\u6253\u5370\u7684\u4ECE\u7F51\u5361up\u4EE5\u6765\u7684\u7D2F\u79EF\u503C<br><code>-a</code>\u5219\u5FFD\u7565\u5386\u53F2\u6587\u4EF6,\u6253\u5370\u4ECE\u7F51\u5361up\u540E\u7684\u7D2F\u79EF\u503C,<code>-j</code>\u8868\u793A\u8F93\u51FA\u683C\u5F0F\u662Fjson.\u65B9\u4FBF\u4E8C\u6B21\u5904\u7406</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ ifstat</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#kernel</span></span>
<span class="line"><span style="color:#A6ACCD;">Interface        RX Pkts/Rate    TX Pkts/Rate    RX Data/Rate    TX Data/Rate</span></span>
<span class="line"><span style="color:#A6ACCD;">                 RX Errs/Drop    TX Errs/Drop    RX Over/Rate    TX Coll/Rate</span></span>
<span class="line"><span style="color:#A6ACCD;">lo                    14 0            14 0           819 0           819 0</span></span>
<span class="line"><span style="color:#A6ACCD;">                       0 0             0 0             0 0             0 0</span></span>
<span class="line"><span style="color:#A6ACCD;">eth0                  25 0            18 0          2058 0          2784 0</span></span>
<span class="line"><span style="color:#A6ACCD;">                       0 0             0 0             0 0             0 0</span></span>
<span class="line"><span style="color:#A6ACCD;">virbr0                 0 0             0 0             0 0             0 0</span></span>
<span class="line"><span style="color:#A6ACCD;">                       0 0             0 0             0 0             0 0</span></span>
<span class="line"><span style="color:#A6ACCD;">docker0                0 0             0 0             0 0             0 0</span></span>
<span class="line"><span style="color:#A6ACCD;">                       0 0             0 0             0 0             0 0</span></span>
<span class="line"></span></code></pre></div><p><code>nstat</code>\u6253\u5370\u534F\u8BAE\u6808\u91CC\u7684\u4E00\u4E9B\u7EDF\u8BA1\u8BA1\u6570,\u7C7B\u4F3C<code>netstat -s</code>\u7684\u8F93\u51FA,\u4E0E\u5185\u6838\u4EE3\u7801\u91CC\u7684\u76F8\u5173\u53D8\u91CF\u540D\u66F4\u8D34\u8FD1,\u5BB9\u6613\u5206\u6790\u6BD4\u8F83<br><code>-r</code>\u5219\u5FFD\u7565\u5386\u53F2\u6587\u4EF6,\u6253\u5370\u4ECE\u7F51\u5361up\u540E\u7684\u7D2F\u79EF\u503C,<code>-z</code>\u8868\u793A\u975E0\u503C\u7684\u5B57\u6BB5\u4E5F\u8F93\u51FA</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ nstat</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">#kernel</span></span>
<span class="line"><span style="color:#A6ACCD;">IpInReceives                    8297               0.0</span></span>
<span class="line"><span style="color:#A6ACCD;">IpInDelivers                    8297               0.0</span></span>
<span class="line"><span style="color:#A6ACCD;">IpOutRequests                   7789               0.0</span></span>
<span class="line"><span style="color:#A6ACCD;">IcmpInMsgs                      6                  0.0</span></span>
<span class="line"><span style="color:#A6ACCD;">IcmpInErrors                    3                  0.0</span></span>
<span class="line"><span style="color:#A6ACCD;">IcmpInDestUnreachs              6                  0.0</span></span>
<span class="line"><span style="color:#A6ACCD;">IcmpOutMsgs                     6                  0.0</span></span>
<span class="line"><span style="color:#A6ACCD;">IcmpOutDestUnreachs             6                  0.0</span></span>
<span class="line"></span></code></pre></div><p><code>TcpExtListenOverflows</code>\u548C<code>TcpExtListenDrops</code> \u4EE3\u8868\u5168\u961F\u5217\u6216\u8005\u534A\u961F\u5217\u6EE1\u4E86<br><code>TcpInCsumErrors</code>\u4EE3\u8868\u63A5\u53D7\u7684\u5305\u5728tcp\u5C42\u7684checksum\u6821\u9A8C\u4E0D\u901A\u8FC7,\u88AB\u4E22\u5F03</p><p>\u6240\u6709\u7684\u8BA1\u6570\u9879\u89E3\u91CA <a href="https://www.kernel.org/doc/html/latest/networking/snmp_counter.html" target="_blank" rel="noopener noreferrer">https://www.kernel.org/doc/html/latest/networking/snmp_counter.html</a></p><p><code>lnstat</code>\u5468\u671F\u6027\u8F93\u5165\u4E00\u4E9B\u5185\u6838\u7EDF\u8BA1\u6570\u636E, <code>-d</code>\u663E\u793A\u652F\u6301\u7684\u5177\u4F53\u6587\u4EF6\u548C\u9879</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ lnstat -d</span></span>
<span class="line"><span style="color:#A6ACCD;">/proc/net/stat/nf_conntrack:</span></span>
<span class="line"><span style="color:#A6ACCD;">	 1: entries</span></span>
<span class="line"><span style="color:#A6ACCD;">	 2: searched</span></span>
<span class="line"><span style="color:#A6ACCD;">	 3: found</span></span>
<span class="line"><span style="color:#A6ACCD;">	 4: new</span></span>
<span class="line"><span style="color:#A6ACCD;">	 5: invalid</span></span>
<span class="line"><span style="color:#A6ACCD;">	 6: ignore</span></span>
<span class="line"><span style="color:#A6ACCD;">	 7: delete</span></span>
<span class="line"><span style="color:#A6ACCD;">	 8: delete_list</span></span>
<span class="line"><span style="color:#A6ACCD;">	 9: insert</span></span>
<span class="line"><span style="color:#A6ACCD;">	10: insert_failed</span></span>
<span class="line"><span style="color:#A6ACCD;">	11: drop</span></span>
<span class="line"><span style="color:#A6ACCD;">	12: early_drop</span></span>
<span class="line"><span style="color:#A6ACCD;">	13: icmp_error</span></span>
<span class="line"><span style="color:#A6ACCD;">	14: expect_new</span></span>
<span class="line"><span style="color:#A6ACCD;">	15: expect_create</span></span>
<span class="line"><span style="color:#A6ACCD;">	16: expect_delete</span></span>
<span class="line"><span style="color:#A6ACCD;">	17: search_restart</span></span>
<span class="line"><span style="color:#A6ACCD;">/proc/net/stat/ndisc_cache:</span></span>
<span class="line"><span style="color:#A6ACCD;">	 1: entries</span></span>
<span class="line"><span style="color:#A6ACCD;">	 2: allocs</span></span>
<span class="line"><span style="color:#A6ACCD;">	 3: destroys</span></span>
<span class="line"><span style="color:#A6ACCD;">	 4: hash_grows</span></span>
<span class="line"><span style="color:#A6ACCD;">	 5: lookups</span></span>
<span class="line"><span style="color:#A6ACCD;">	 6: hits</span></span>
<span class="line"><span style="color:#A6ACCD;">	 7: res_failed</span></span>
<span class="line"><span style="color:#A6ACCD;">	 8: rcv_probes_mcast</span></span>
<span class="line"><span style="color:#A6ACCD;">	 9: rcv_probes_ucast</span></span>
<span class="line"><span style="color:#A6ACCD;">	10: periodic_gc_runs</span></span>
<span class="line"><span style="color:#A6ACCD;">	11: forced_gc_runs</span></span>
<span class="line"><span style="color:#A6ACCD;">	12: unresolved_discards</span></span>
<span class="line"></span></code></pre></div><p><code>-k</code>\u53EF\u8F93\u51FA\u7279\u5B9A\u9879\u7684\u4FE1\u606F</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ lnstat -k </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">entries,insert_failed</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">nf_connt</span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">nf_connt</span><span style="color:#89DDFF;">|</span></span>
<span class="line"><span style="color:#A6ACCD;"> entries</span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">insert_f</span><span style="color:#89DDFF;">|</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">   ailed</span><span style="color:#89DDFF;">|</span></span>
<span class="line"><span style="color:#A6ACCD;">       7</span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">       0</span><span style="color:#89DDFF;">|</span></span>
<span class="line"><span style="color:#A6ACCD;">       7</span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">       0</span><span style="color:#89DDFF;">|</span></span>
<span class="line"><span style="color:#A6ACCD;">       7</span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;">       0</span><span style="color:#89DDFF;">|</span></span>
<span class="line"></span></code></pre></div><p>\u8FD9\u91CC\u7684entris\u548C<code>conntrack -L</code>\u7684\u4FE1\u606F\u662F\u4E00\u6837\u7684</p><p><code>tc</code>\u53EF\u4EE5\u6A21\u62DF\u7F51\u7EDC\u5EF6\u8FDF,\u9650\u901F\u7B49\u529F\u80FD, \u4E0B\u9762\u662F\u67E5\u770B\u5F53\u524D\u7B56\u7565\u7684\u547D\u4EE4</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ tc -s qdisc</span></span>
<span class="line"><span style="color:#A6ACCD;">$ tc -s qdisc ls dev eth0</span></span>
<span class="line"></span></code></pre></div><h2 id="_84-\u94FE\u63A5\u8DDF\u8E2A" tabindex="-1">84. \u94FE\u63A5\u8DDF\u8E2A <a class="header-anchor" href="#_84-\u94FE\u63A5\u8DDF\u8E2A" aria-hidden="true">#</a></h2><p><code>conntrack -L</code>\u53EF\u663E\u793A\u5F53\u524D\u7684\u6240\u6709\u94FE\u63A5\u4FE1\u606F, \u9700\u8981\u5B89\u88C5<code>conntrack-tools</code>\u540E\u624D\u53EF\u4EE5\u4F7F\u7528</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ conntrack -L</span></span>
<span class="line"><span style="color:#A6ACCD;">tcp      6 430950 ESTABLISHED src=10.211.55.22 dst=10.211.55.2 sport=22 dport=51568 src=10.211.55.2 dst=10.211.55.22 sport=51568 dport=22 </span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">ASSURED</span><span style="color:#89DDFF;">]</span><span style="color:#A6ACCD;"> mark=0 use=1</span></span>
<span class="line"><span style="color:#A6ACCD;">tcp      6 5 TIME_WAIT src=10.211.55.22 dst=113.142.161.250 sport=48530 dport=80 src=113.142.161.250 dst=10.211.55.22</span></span>
<span class="line"></span></code></pre></div><p>\u67E5\u770B\u5F53\u524D\u94FE\u63A5\u8DDF\u8E2A\u8868\u91CC\u7684\u6570\u76EE</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ cat /proc/sys/net/netfilter/nf_conntrack_count</span></span>
<span class="line"><span style="color:#A6ACCD;">4</span></span>
<span class="line"></span></code></pre></div><p>\u67E5\u770B\u5F53\u524D\u751F\u6548\u7684\u6700\u5927\u503C</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ cat /proc/sys/net/netfilter/nf_conntrack_max</span></span>
<span class="line"><span style="color:#A6ACCD;">65536</span></span>
<span class="line"></span></code></pre></div><p>\u5982\u679C\u5185\u6838\u51FA\u73B0<code>nf_conntrack: table full, dropping packet.</code>, \u5219\u9700\u8981\u589E\u52A0\u94FE\u63A5\u8DDF\u8E2A\u8868\u7684\u6700\u5927\u8FDE\u63A5\u6570</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">sysctl -w net.nf_conntrack_max=xxxxx</span></span>
<span class="line"></span></code></pre></div><p>\u8FD8\u53EF\u4EE5\u901A\u8FC7\u5728\u52A0\u8F7D\u6A21\u5757\u65F6\u6307\u5B9Ahashsize\u89E3\u51B3</p><p><a href="https://access.redhat.com/solutions/972673" target="_blank" rel="noopener noreferrer">https://access.redhat.com/solutions/972673</a> \u4ECB\u7ECD\u4E86\u9488\u5BF9\u5339\u914D\u7684\u5305\u4E0D\u8FDB\u884C\u8FDE\u63A5\u8DDF\u8E2A\u7684\u65B9\u6CD5<br> \u66F4\u8BE6\u7EC6\u7684\u4E00\u4E9B\u6587\u7AE0:<br><a href="https://blog.csdn.net/u010472499/article/details/78292811" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/u010472499/article/details/78292811</a><br><a href="https://access.redhat.com/solutions/8721" target="_blank" rel="noopener noreferrer">https://access.redhat.com/solutions/8721</a><br><a href="https://access.redhat.com/solutions/974723" target="_blank" rel="noopener noreferrer">https://access.redhat.com/solutions/974723</a><br><a href="https://access.redhat.com/solutions/8721" target="_blank" rel="noopener noreferrer">https://access.redhat.com/solutions/8721</a></p><p><code>sysctl -a | grep nf_</code> \u67E5\u770B\u548C\u94FE\u63A5\u8DDF\u8E2A\u6240\u6709\u7684\u5185\u6838\u53C2\u6570<br> \u5177\u4F53\u89E3\u91CA: <a href="https://www.kernel.org/doc/Documentation/networking/nf_conntrack-sysctl.txt" target="_blank" rel="noopener noreferrer">https://www.kernel.org/doc/Documentation/networking/nf_conntrack-sysctl.txt</a></p><p>\u4E0B\u9762\u7684\u89C4\u5219\u662F\u7528\u4E8E\u8DDF\u8E2A\u5BF9\u5E94\u8FDE\u63A5\u7684TCP\u72B6\u6001, \u6BCF\u6B21\u8FDE\u63A5\u90FD\u6709\u81EA\u5DF1\u7684\u8D85\u65F6\u65F6\u95F4, \u5982\u679C\u914D\u7F6E\u4E0D\u5F53\u4F1A\u5BFC\u81F4\u4E22\u5305.<br> \u6BD4\u5982<code>ESTABLISHED</code>\u7684\u8D85\u65F6\u65F6\u95F4\u65F65\u5929, \u5982\u679C\u6539\u4E3A5\u5206\u949F, \u4E14\u8FD95\u5206\u949F\u8BE5TCP\u6CA1\u6709\u4EFB\u4F55\u62A5\u6587\u4EA4\u4E92, \u5219 iptables\u4F1A\u5C06\u8BE5\u8FDE\u63A5\u7F6E\u4E3Ainvalid.<br> \u8FD9\u6837\u5373\u4F7F\u7528<code>ss</code>\u6216\u8005<code>netstat</code>\u67E5\u770B\u8BE5\u8FDE\u63A5\u4ECD\u662F<code>ESTABLISHED</code>, \u4EFB\u4F55\u53D1\u5230\u8BE5\u8FDE\u63A5\u7684\u62A5\u6587\u5168\u90E8\u4F1A\u88AB\u4E22\u5F03.</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">    0     0 ACCEPT     all  --  </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">      virbr0  0.0.0.0/0            192.168.122.0/24     ctstate RELATED,ESTABLISHED</span></span>
<span class="line"></span></code></pre></div><p>\u5177\u4F53\u7684\u4FE1\u606F\u89C1\`man iptables-extensions</p><p>\u4E00\u4E9B\u4ECB\u7ECD\u94FE\u63A5\u8DDF\u8E2A,iptables\u7684\u6587\u7AE0<br><a href="https://www.cnblogs.com/liushaodong/archive/2013/02/26/2933593.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/liushaodong/archive/2013/02/26/2933593.html</a><br><a href="http://arthurchiao.art/blog/conntrack-design-and-implementation/" target="_blank" rel="noopener noreferrer">http://arthurchiao.art/blog/conntrack-design-and-implementation/</a></p><h2 id="_85-\u4E00\u4E9B\u6C47\u7F16\u8BED\u6CD5" tabindex="-1">85. \u4E00\u4E9B\u6C47\u7F16\u8BED\u6CD5 <a class="header-anchor" href="#_85-\u4E00\u4E9B\u6C47\u7F16\u8BED\u6CD5" aria-hidden="true">#</a></h2><p>\u5982\u4E0B\u6587\u7AE0\u4ECB\u7ECD\u4E86x86_64\u4E0B\u8BB8\u591A\u5BC4\u5B58\u5668\u7684\u7528\u9014<br><a href="http://abcdxyzk.github.io/blog/2012/11/23/assembly-args/" target="_blank" rel="noopener noreferrer">http://abcdxyzk.github.io/blog/2012/11/23/assembly-args/</a></p><h2 id="_86-\u4F7F\u7528crash\u5206\u6790\u5185\u6838coredump\u7684\u4E00\u4E9B\u6587\u7AE0" tabindex="-1">86. \u4F7F\u7528crash\u5206\u6790\u5185\u6838coredump\u7684\u4E00\u4E9B\u6587\u7AE0 <a class="header-anchor" href="#_86-\u4F7F\u7528crash\u5206\u6790\u5185\u6838coredump\u7684\u4E00\u4E9B\u6587\u7AE0" aria-hidden="true">#</a></h2><p><a href="https://irmbor.co.rs/~dspalovic/assets/docsOracle/E41138/html/ch10s02.html" target="_blank" rel="noopener noreferrer">https://irmbor.co.rs/~dspalovic/assets/docsOracle/E41138/html/ch10s02.html</a><br><a href="https://www.slideshare.net/PaulVNovarese/linux-crash-dump-capture-and-analysis" target="_blank" rel="noopener noreferrer">https://www.slideshare.net/PaulVNovarese/linux-crash-dump-capture-and-analysis</a><br><a href="https://serverfault.com/questions/475721/how-to-use-kdump-crash-to-investigate-an-oom-issue" target="_blank" rel="noopener noreferrer">https://serverfault.com/questions/475721/how-to-use-kdump-crash-to-investigate-an-oom-issue</a><br><a href="https://www.redhat.com/archives/crash-utility/2012-December/msg00029.html" target="_blank" rel="noopener noreferrer">https://www.redhat.com/archives/crash-utility/2012-December/msg00029.html</a></p><p>\u6700\u4E3B\u8981\u8FD8\u662F\u770Bcrash\u7684\u5B98\u65B9\u4E3B\u9875: <a href="https://crash-utility.github.io/" target="_blank" rel="noopener noreferrer">https://crash-utility.github.io/</a></p><h2 id="_87-linux\u5185\u6838\u6A21\u5757\u76F8\u5173" tabindex="-1">87. Linux\u5185\u6838\u6A21\u5757\u76F8\u5173 <a class="header-anchor" href="#_87-linux\u5185\u6838\u6A21\u5757\u76F8\u5173" aria-hidden="true">#</a></h2><p>\u4F7F\u7528weak-modules\u5B9E\u73B0\u5916\u90E8\u5F00\u53D1\u7684\u5185\u6838\u6A21\u5757\u5728\u591A\u4E2A\u5185\u6838(KABI\u517C\u5BB9\u7684\u60C5\u51B5\u4E0B)\u90FD\u53EF\u4EE5\u4F7F\u7528, \u8FD9\u7BC7\u6587\u7AE0\u4ECB\u7ECD\u4E86\u5177\u4F53\u7684\u65B9\u6CD5<br><a href="https://www.cnblogs.com/xingmuxin/p/9092344.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/xingmuxin/p/9092344.html</a></p><h2 id="_88-ssh\u8FDE\u63A5\u4FDD\u6D3B\u914D\u7F6E" tabindex="-1">88. ssh\u8FDE\u63A5\u4FDD\u6D3B\u914D\u7F6E <a class="header-anchor" href="#_88-ssh\u8FDE\u63A5\u4FDD\u6D3B\u914D\u7F6E" aria-hidden="true">#</a></h2><p>\u7F16\u8F91 /etc/ssh/sshd_config, \u6DFB\u52A0\u5982\u4E0B\u4E24\u884C, \u91CD\u542Fsshd\u670D\u52A1\u751F\u6548</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">ClientAliveInterval 60 </span></span>
<span class="line"><span style="color:#A6ACCD;">ClientAliveCountMax 3 </span></span>
<span class="line"></span></code></pre></div><h2 id="_89-\u4F7F\u7528auditd\u5BA1\u8BA1\u529F\u80FD" tabindex="-1">89. \u4F7F\u7528auditd\u5BA1\u8BA1\u529F\u80FD <a class="header-anchor" href="#_89-\u4F7F\u7528auditd\u5BA1\u8BA1\u529F\u80FD" aria-hidden="true">#</a></h2><p>\u76F4\u63A5\u4F7F\u7528<code>systemctl restart auditd</code>\u91CD\u542Fauditd\u662F\u5931\u8D25.</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ systemctl restart auditd</span></span>
<span class="line"><span style="color:#A6ACCD;">Failed to restart auditd.service: Operation refused, unit auditd.service may be requested by dependency only </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">it is configured to refuse manual start/stop</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">.</span></span>
<span class="line"><span style="color:#A6ACCD;">See system logs and </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">systemctl status auditd.service</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#A6ACCD;"> details.</span></span>
<span class="line"></span></code></pre></div><p>\u53EF\u4EE5\u4F7F\u7528<code>service auditd status/start/stop/restart</code><br> \u53C2\u89C1: <a href="https://access.redhat.com/solutions/2664811" target="_blank" rel="noopener noreferrer">https://access.redhat.com/solutions/2664811</a></p><p>\u542F\u52A8/\u91CD\u542Fauditd \u62A5\u9519&quot;Not able to start Auditd service with pid file exists error&quot;<br> \u539F\u56E0\u662F\u6709\u5176\u4ED6\u7A0B\u5E8F\u5360\u7528\u4E86kernel\u7684audit\u529F\u80FD, \u53EF\u4EE5\u4F7F\u7528<code>auditctl -s</code>\u67E5\u770B\u5176\u4ED6\u7A0B\u5E8F\u7684pid<br><a href="https://access.redhat.com/solutions/5431221" target="_blank" rel="noopener noreferrer">https://access.redhat.com/solutions/5431221</a></p><p><code>/var/log/audit/audit.log</code>\u91CC\u7684\u65E5\u5FD7\u683C\u5F0F, \u9ED8\u8BA4\u4E0D\u591F\u4EBA\u6027\u5316, \u5177\u4F53\u5B57\u6BB5\u542B\u4E49\u53C2\u89C1:<br><a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/security_guide/sec-understanding_audit_log_files" target="_blank" rel="noopener noreferrer">https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/security_guide/sec-understanding_audit_log_files</a></p><p>\u6253\u5370\u4ECA\u5929\u7684\u5BA1\u8BA1\u6458\u8981</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ aureport --start 01/10/2020 07:00:00 --end 01/10/2020 19:00:00</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">Summary Report</span></span>
<span class="line"><span style="color:#A6ACCD;">======================</span></span>
<span class="line"><span style="color:#A6ACCD;">Range of </span><span style="color:#F78C6C;">time</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">in</span><span style="color:#A6ACCD;"> logs: 04/27/2019 20:30:36.683 - 01/01/1970 08:00:00.000</span></span>
<span class="line"><span style="color:#A6ACCD;">Selected </span><span style="color:#F78C6C;">time</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#A6ACCD;"> report: 01/10/2020 07:00:00 - 01/10/2020 19:00:00</span></span>
<span class="line"><span style="color:#A6ACCD;">Number of changes </span><span style="color:#89DDFF;font-style:italic;">in</span><span style="color:#A6ACCD;"> configuration: 0</span></span>
<span class="line"><span style="color:#A6ACCD;">Number of changes to accounts, groups, or roles: 0</span></span>
<span class="line"><span style="color:#A6ACCD;">Number of logins: 0</span></span>
<span class="line"><span style="color:#A6ACCD;">Number of failed logins: 0</span></span>
<span class="line"><span style="color:#A6ACCD;">Number of authentications: 0</span></span>
<span class="line"><span style="color:#A6ACCD;">Number of failed authentications: 0</span></span>
<span class="line"><span style="color:#A6ACCD;">Number of users: 0</span></span>
<span class="line"><span style="color:#A6ACCD;">Number of terminals: 0</span></span>
<span class="line"><span style="color:#A6ACCD;">Number of host names: 0</span></span>
<span class="line"><span style="color:#A6ACCD;">Number of executables: 0</span></span>
<span class="line"><span style="color:#A6ACCD;">Number of commands: 0</span></span>
<span class="line"><span style="color:#A6ACCD;">Number of files: 0</span></span>
<span class="line"></span></code></pre></div><p>\u6628\u5929\u5230\u4ECA\u5929\u8FD9\u4E2A\u65F6\u95F4\u6BB5\u91CC\u7684\u5BA1\u8BA1\u6458\u8981</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ aureport --start yesterday --end today</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">Summary Report</span></span>
<span class="line"><span style="color:#A6ACCD;">======================</span></span>
<span class="line"><span style="color:#A6ACCD;">Range of </span><span style="color:#F78C6C;">time</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">in</span><span style="color:#A6ACCD;"> logs: 04/27/2019 20:30:36.683 - 10/01/2020 13:10:43.415</span></span>
<span class="line"><span style="color:#A6ACCD;">Selected </span><span style="color:#F78C6C;">time</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#A6ACCD;"> report: 09/30/2020 00:00:00 - 10/01/2020 13:12:35</span></span>
<span class="line"><span style="color:#A6ACCD;">Number of changes </span><span style="color:#89DDFF;font-style:italic;">in</span><span style="color:#A6ACCD;"> configuration: 46</span></span>
<span class="line"><span style="color:#A6ACCD;">Number of changes to accounts, groups, or roles: 0</span></span>
<span class="line"><span style="color:#A6ACCD;">Number of logins: 25</span></span>
<span class="line"><span style="color:#A6ACCD;">Number of failed logins: 2</span></span>
<span class="line"><span style="color:#A6ACCD;">Number of authentications: 80</span></span>
<span class="line"><span style="color:#A6ACCD;">Number of failed authentications: 1</span></span>
<span class="line"><span style="color:#A6ACCD;">Number of users: 2</span></span>
<span class="line"><span style="color:#A6ACCD;">Number of terminals: 16</span></span>
<span class="line"><span style="color:#A6ACCD;">Number of host names: 3</span></span>
<span class="line"><span style="color:#A6ACCD;">Number of executables: 14</span></span>
<span class="line"><span style="color:#A6ACCD;">Number of commands: 11</span></span>
<span class="line"><span style="color:#A6ACCD;">Number of files: 2</span></span>
<span class="line"></span></code></pre></div><p>\u4ECE\u6628\u5929\u5F00\u59CB\u4E8B\u4EF6\u7EDF\u8BA1\u6458\u8981, <code>-i</code>\u8BA9\u8F93\u51FA\u66F4\u4EBA\u6027\u5316.</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ aureport --start yesterday -e -i --summary</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">Event Summary Report</span></span>
<span class="line"><span style="color:#A6ACCD;">======================</span></span>
<span class="line"><span style="color:#A6ACCD;">total  </span><span style="color:#82AAFF;">type</span></span>
<span class="line"><span style="color:#A6ACCD;">======================</span></span>
<span class="line"><span style="color:#A6ACCD;">14485  CRYPTO_KEY_USER</span></span>
<span class="line"><span style="color:#A6ACCD;">8076  USER_START</span></span>
<span class="line"><span style="color:#A6ACCD;">7639  USER_END</span></span>
<span class="line"><span style="color:#A6ACCD;">6762  CRED_ACQ</span></span>
<span class="line"><span style="color:#A6ACCD;">6761  USER_ACCT</span></span>
<span class="line"><span style="color:#A6ACCD;">6753  LOGIN</span></span>
<span class="line"><span style="color:#A6ACCD;">6704  CRED_REFR</span></span>
<span class="line"><span style="color:#A6ACCD;">6527  CRED_DISP</span></span>
<span class="line"><span style="color:#A6ACCD;">4966  NETFILTER_CFG</span></span>
<span class="line"></span></code></pre></div><p>\u7EDF\u8BA1\u53EF\u6267\u884C\u6587\u4EF6\u7684\u6458\u8981</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ aureport -x -i --summary</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">Executable Summary Report</span></span>
<span class="line"><span style="color:#A6ACCD;">=================================</span></span>
<span class="line"><span style="color:#A6ACCD;">total  file</span></span>
<span class="line"><span style="color:#A6ACCD;">=================================</span></span>
<span class="line"><span style="color:#A6ACCD;">33791  /usr/sbin/sshd</span></span>
<span class="line"><span style="color:#A6ACCD;">31880  /usr/sbin/crond</span></span>
<span class="line"><span style="color:#A6ACCD;">7432  /usr/lib/systemd/systemd</span></span>
<span class="line"><span style="color:#A6ACCD;">4370  /usr/sbin/xtables-multi</span></span>
<span class="line"><span style="color:#A6ACCD;">651  </span><span style="color:#89DDFF;">?</span></span>
<span class="line"><span style="color:#A6ACCD;">627  /usr/bin/python2.7</span></span>
<span class="line"><span style="color:#A6ACCD;">608  /usr/bin/login</span></span>
<span class="line"><span style="color:#A6ACCD;">309  /usr/bin/kmod</span></span>
<span class="line"><span style="color:#A6ACCD;">232  /usr/lib/systemd/systemd-update-utmp</span></span>
<span class="line"><span style="color:#A6ACCD;">204  /</span></span>
<span class="line"><span style="color:#A6ACCD;">102  /usr/sbin/libvirtd</span></span>
<span class="line"><span style="color:#A6ACCD;">94  /usr/sbin/tcpdump</span></span>
<span class="line"><span style="color:#A6ACCD;">60  /usr/bin/su</span></span>
<span class="line"><span style="color:#A6ACCD;">50  /usr/bin/dockerd-current</span></span>
<span class="line"><span style="color:#A6ACCD;">42  /usr/sbin/groupadd</span></span>
<span class="line"></span></code></pre></div><p>\u663E\u793A\u6BCF\u4E2Aaudit\u65E5\u5FD7\u8BB0\u5F55\u7684\u5BF9\u5E94\u65F6\u95F4\u6BB5</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ aureport -t</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">Log Time Range Report</span></span>
<span class="line"><span style="color:#A6ACCD;">=====================</span></span>
<span class="line"><span style="color:#A6ACCD;">/var/log/audit/audit.log.2: 04/27/2019 20:30:36.683 - 12/01/2019 10:40:01.857</span></span>
<span class="line"><span style="color:#A6ACCD;">/var/log/audit/audit.log.1: 12/01/2019 10:40:01.858 - 06/08/2020 12:20:01.343</span></span>
<span class="line"><span style="color:#A6ACCD;">/var/log/audit/audit.log: 06/08/2020 12:20:01.358 - 10/01/2020 13:42:52.455</span></span>
<span class="line"></span></code></pre></div><p>\u641C\u7D22\u4ECA\u5929\u6240\u6709\u7684\u65E5\u5FD7</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">$ ausearch --start today -i</span></span>
<span class="line"></span></code></pre></div><p>\u641C\u7D22\u4ECA\u5929\u6240\u6709\u7684\u4E8B\u4EF6\u4E3A\u7CFB\u7EDF\u8C03\u7528\u7684\u65E5\u5FD7<br> \u6240\u6709\u7684\u4E8B\u4EF6\u5217\u8868\u53C2\u89C1: <a href="https://access.redhat.com/articles/4409591" target="_blank" rel="noopener noreferrer">https://access.redhat.com/articles/4409591</a></p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">ausearch --start today -i  -m syscall</span></span>
<span class="line"></span></code></pre></div><p>\u641C\u7D22\u4ECA\u5929\u6240\u6709\u7684\u5173\u952E\u5B57\u4E3Axxxx\u7684\u65E5\u5FD7</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">ausearch --start today -i  -k xxxx</span></span>
<span class="line"></span></code></pre></div><p>\u641C\u7D22\u4ECA\u5929\u6240\u6709\u7684\u6D89\u53CA\u6587\u4EF6/etc/passwd\u7684\u65E5\u5FD7</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">ausearch --start today -i  -f /etc/passwd</span></span>
<span class="line"></span></code></pre></div><p>\u5176\u4ED6\u4E00\u4E9B\u53C2\u8003\u8D44\u6599:<br><a href="https://cloud.tencent.com/developer/article/1359606" target="_blank" rel="noopener noreferrer">https://cloud.tencent.com/developer/article/1359606</a></p><h2 id="_90-\u5206\u6790\u78C1\u76D8\u6027\u80FD" tabindex="-1">90. \u5206\u6790\u78C1\u76D8\u6027\u80FD <a class="header-anchor" href="#_90-\u5206\u6790\u78C1\u76D8\u6027\u80FD" aria-hidden="true">#</a></h2><p>blktrace -d /dev/vda blkparse -i vda -d vda.blktrace.bin btt -i vda.blktrace.bin -l vda.d2c_latency</p><p>\u53C2\u8003:<br><a href="https://developer.aliyun.com/article/698568" target="_blank" rel="noopener noreferrer">https://developer.aliyun.com/article/698568</a><br><a href="https://tunnelix.com/debugging-disk-issues-with-blktrace-blkparse-btrace-and-btt-in-linux-environment/" target="_blank" rel="noopener noreferrer">https://tunnelix.com/debugging-disk-issues-with-blktrace-blkparse-btrace-and-btt-in-linux-environment/</a></p><p><code>iostat</code>\u91CC<code>await</code>\u548C<code>svctm</code>\u76F8\u5173\u89E3\u91CA<br><a href="https://access.redhat.com/solutions/2039133" target="_blank" rel="noopener noreferrer">https://access.redhat.com/solutions/2039133</a><br><a href="https://access.redhat.com/articles/524353" target="_blank" rel="noopener noreferrer">https://access.redhat.com/articles/524353</a><br><a href="https://access.redhat.com/solutions/112613" target="_blank" rel="noopener noreferrer">https://access.redhat.com/solutions/112613</a></p><h2 id="_91-grub\u76F8\u5173\u95EE\u9898" tabindex="-1">91. Grub\u76F8\u5173\u95EE\u9898 <a class="header-anchor" href="#_91-grub\u76F8\u5173\u95EE\u9898" aria-hidden="true">#</a></h2><p>CentOS 6 \u548C7 \u5982\u4F55\u91CD\u88C5grub<br><a href="https://access.redhat.com/solutions/1521" target="_blank" rel="noopener noreferrer">https://access.redhat.com/solutions/1521</a></p><h2 id="_92-slab\u76F8\u5173\u7684\u77E5\u8BC6" tabindex="-1">92. SLAB\u76F8\u5173\u7684\u77E5\u8BC6 <a class="header-anchor" href="#_92-slab\u76F8\u5173\u7684\u77E5\u8BC6" aria-hidden="true">#</a></h2><p>\u7EDF\u8BA1slab\u5185\u5404\u9879\u7684\u5185\u5B58\u5360\u7528\u5E76\u964D\u5E8F\u6392\u5217TOP 10</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">awk </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">{printf &quot;  %6i MB %s \\n&quot;,$6*$15/256,$1}</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> /proc/slabinfo </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> sort -nrk1 </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> head -10</span></span>
<span class="line"></span></code></pre></div><h2 id="_93-nfs\u76F8\u5173\u7684\u77E5\u8BC6" tabindex="-1">93. nfs\u76F8\u5173\u7684\u77E5\u8BC6 <a class="header-anchor" href="#_93-nfs\u76F8\u5173\u7684\u77E5\u8BC6" aria-hidden="true">#</a></h2><p>nfs Debug<br><a href="https://access.redhat.com/solutions/262213" target="_blank" rel="noopener noreferrer">https://access.redhat.com/solutions/262213</a><br><a href="https://access.redhat.com/solutions/1460313" target="_blank" rel="noopener noreferrer">https://access.redhat.com/solutions/1460313</a><br><a href="https://access.redhat.com/solutions/4253191" target="_blank" rel="noopener noreferrer">https://access.redhat.com/solutions/4253191</a><br><a href="https://access.redhat.com/solutions/2948091" target="_blank" rel="noopener noreferrer">https://access.redhat.com/solutions/2948091</a><br><a href="https://access.redhat.com/solutions/3765711" target="_blank" rel="noopener noreferrer">https://access.redhat.com/solutions/3765711</a><br><a href="https://access.redhat.com/solutions/28211" target="_blank" rel="noopener noreferrer">https://access.redhat.com/solutions/28211</a></p><p>nfs, rpc\u76F8\u5173\u7684Debug\u5F00\u5173<br><a href="https://wiki.archlinux.org/index.php/NFS/Troubleshooting#RPC_debug_flags" target="_blank" rel="noopener noreferrer">https://wiki.archlinux.org/index.php/NFS/Troubleshooting#RPC_debug_flags</a></p><h2 id="_94-fork\u521B\u5EFA\u8FDB\u7A0B\u65F6\u7684\u51E0\u4E2A\u62A5\u9519\u8BF4\u660E" tabindex="-1">94. fork\u521B\u5EFA\u8FDB\u7A0B\u65F6\u7684\u51E0\u4E2A\u62A5\u9519\u8BF4\u660E <a class="header-anchor" href="#_94-fork\u521B\u5EFA\u8FDB\u7A0B\u65F6\u7684\u51E0\u4E2A\u62A5\u9519\u8BF4\u660E" aria-hidden="true">#</a></h2><p>\u6709\u4E24\u4E2A\u5E38\u89C1\u7684\u62A5\u9519:</p><div class="language-bash"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">11: Resource temporarily unavailable</span></span>
<span class="line"><span style="color:#A6ACCD;">12: Cannot allocate memory</span></span>
<span class="line"></span></code></pre></div><p>\u5728fork\u7B49\u521B\u5EFA\u8FDB\u7A0B\u7684\u64CD\u4F5C\u91CC, \u5F53\u8FBE\u5230<code>nproc</code>\u7684\u9650\u5236\uFF0C \u5373\u7528\u6237\u7684\u6700\u5927\u8FDB\u7A0B\u6570\uFF0C \u62A5\u9519<code>Resource temporarily unavailable</code> \uFF08\u8FD9\u6761\u89C4\u5219\u5BF9root\u7528\u6237\u65E0\u6548\uFF09 \u5982\u679C\u5728\u6587\u4EF6\u91CC\u5BF9<code>nproc</code>\u914D\u7F6E\u4E3A<code>ulimited</code> \u8FD9\u4E2A\u503C\u662F\u6839\u636E\u5185\u5B58\u7B97\u51FA\u6765\u7684\uFF0C \u516C\u5F0F\u53EF\u53C2\u8003<br><a href="https://thelinuxcluster.com/2020/05/14/how-is-the-nproc-hard-limit-calculated-and-how-do-we-change-the-value-on-centos-7/" target="_blank" rel="noopener noreferrer">https://thelinuxcluster.com/2020/05/14/how-is-the-nproc-hard-limit-calculated-and-how-do-we-change-the-value-on-centos-7/</a></p><p>\u5F53\u8FBE\u5230\u7CFB\u7EDF\u7EA7\u53C2\u6570pid_max\u9650\u5236\uFF0C\u65E0\u6CD5\u5206\u914D\u51FApid\u65F6\uFF0C \u62A5\u9519\u4E3A<code>Cannot allocate memory</code></p><p><code>sysctl kernel.pid_max</code>\u67E5\u8BE2\u5F53\u524D\u7684\u6700\u5927\u503C, pid_max\u9ED8\u8BA4\u662F32768\uFF0C 64\u4F4D\u7CFB\u7EDF\uFF0C \u6700\u5927\u53EF\u914D\u7F6E\u4E3A4\u767E\u4E07\u5DE6\u53F3<br><code>kernel.threads-max</code> \u4E5F\u63A7\u5236\u7CFB\u7EDF\u80FD\u521B\u5EFA\u7684\u6700\u5927\u8FDB\u7A0B/\u7EBF\u7A0B\u6570, \u56E0\u4E3A\u5B83\u7684\u9ED8\u8BA4\u503C\u975E\u5E38\u5927. \u4E00\u822C\u90FD\u6CA1\u5173\u6CE8\u8FC7. \u603B\u662F<code>kernel.pid_max</code>\u5148\u8D85\u51FA\u9650\u5236.<br> \u5982\u4E0B\u662F\u76F8\u5173\u4EE3\u7801: linux-3.10.0-957.21.3.el7\\include\\linux\\threads.h</p><div class="language-c"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;">/*</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * This controls the default maximum pid allocated to a process</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">#define</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">PID_MAX_DEFAULT</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">CONFIG_BASE_SMALL </span><span style="color:#89DDFF;">?</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0x1000</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0x8000</span><span style="color:#89DDFF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">/*</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * A maximum of 4 million PIDs should be enough for a while.</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> * [NOTE: PID/TIDs are limited to 2^29 ~= 500+ million, see futex.h.]</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;"> */</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">#define</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">PID_MAX_LIMIT</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">CONFIG_BASE_SMALL </span><span style="color:#89DDFF;">?</span><span style="color:#A6ACCD;"> PAGE_SIZE </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">8</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">	</span><span style="color:#89DDFF;">(sizeof(</span><span style="color:#C792EA;">long</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">4</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">?</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">4</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1024</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1024</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> PID_MAX_DEFAULT</span><span style="color:#89DDFF;">))</span></span>
<span class="line"></span></code></pre></div>`,591),t=[c];function r(i,y,D,C,A,d){return n(),a("div",null,t)}var h=s(o,[["render",r]]);export{u as __pageData,h as default};
