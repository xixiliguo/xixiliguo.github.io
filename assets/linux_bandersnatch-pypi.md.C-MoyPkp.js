import{_ as s,c as i,o as a,a2 as n}from"./chunks/framework.KQnwS2KS.js";const c=JSON.parse('{"title":"使用Bandersnatch搭建私有Pypi源","description":"","frontmatter":{"title":"使用Bandersnatch搭建私有Pypi源"},"headers":[],"relativePath":"linux/bandersnatch-pypi.md","filePath":"linux/bandersnatch-pypi.md","lastUpdated":1754323216000}'),h={name:"linux/bandersnatch-pypi.md"},t=n(`<h1 id="使用bandersnatch搭建私有pypi源" tabindex="-1">使用Bandersnatch搭建私有Pypi源 <a class="header-anchor" href="#使用bandersnatch搭建私有pypi源" aria-label="Permalink to &quot;使用Bandersnatch搭建私有Pypi源&quot;">​</a></h1><p>经常使用python的公司,考虑到pypi.python.org不稳定,都会自己搭建私有的Pypi源.这里简单介绍下方法.</p><p>现在流行使用Bandersnatch作为同步工具, 如下演示在centos7.4环境下通过</p><h2 id="安装virtualenv" tabindex="-1">安装virtualenv <a class="header-anchor" href="#安装virtualenv" aria-label="Permalink to &quot;安装virtualenv&quot;">​</a></h2><p>virtualenv 可以为一个应用创建一套“隔离”的Python运行环境。所有依赖包在自己独立的环境,不会影响其他python程序,更不会放到系统默认的site-packages里</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> python-virtualenv</span></span></code></pre></div><h3 id="创建独立python环境" tabindex="-1">创建独立Python环境 <a class="header-anchor" href="#创建独立python环境" aria-label="Permalink to &quot;创建独立Python环境&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> virtualenv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Bandersnatch</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">New</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> python</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> executable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Bandersnatch/bin/python</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Please</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sure</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> you</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> remove</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> any</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> previous</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> custom</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> paths</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> your</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /root/.pydistutils.cfg</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> file.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Installing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Setuptools...........................................................done.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Installing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Pip..................................................................done.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span></span></code></pre></div><h3 id="激活独立python环境" tabindex="-1">激活独立Python环境 <a class="header-anchor" href="#激活独立python环境" aria-label="Permalink to &quot;激活独立Python环境&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[root@abc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]$ source Bandersnatch/bin/activate</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Bandersnatch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)[root@abc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]#</span></span></code></pre></div><p>当指示符前显示 <code>(Bandersnatch)</code> 字样, 意味着所有python的操作,都只限于独立环境, 系统Python环境不受任何影响</p><h3 id="安装bandersnatch" tabindex="-1">安装Bandersnatch <a class="header-anchor" href="#安装bandersnatch" aria-label="Permalink to &quot;安装Bandersnatch&quot;">​</a></h3><p>最新版的<code>Bandersnatch 2.0</code>支持python3, 但目前的环境是python2.7.5, 所以需要下载其他版本. 这里取<code>1.11</code>版</p><h3 id="获取安装包" tabindex="-1">获取安装包 <a class="header-anchor" href="#获取安装包" aria-label="Permalink to &quot;获取安装包&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Bandersnatch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)[root@abc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> wget</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://bitbucket.org/pypa/bandersnatch/get/1.11.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--2018-01-02</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 22:39:22--</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  https://bitbucket.org/pypa/bandersnatch/get/1.11.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Resolving</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bitbucket.org</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (bitbucket.org)... 104.192.143.3, 104.192.143.2, 104.192.143.1, ...</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Connecting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bitbucket.org</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (bitbucket.org)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">104.192.143.3</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">:443...</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> connected.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">HTTP</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> request</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sent,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> awaiting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> response...</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 200</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> OK</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Length:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 25988</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (25K) [application/x-tar-gz]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Saving</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ‘1.11.tar.gz.1’</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">100%[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">=============================================</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">]</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 25,988</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">      72.9KB/s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 0.3s</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2018-01-02</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 22:39:24</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (72.9 </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">KB/s</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) - ‘1.11.tar.gz.1’ saved [25988/25988]</span></span></code></pre></div><h3 id="解压缩tar包" tabindex="-1">解压缩tar包 <a class="header-anchor" href="#解压缩tar包" aria-label="Permalink to &quot;解压缩tar包&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Bandersnatch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)[root@abc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> tar</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -xzvf</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1.11.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pypa-bandersnatch-76b72f3ebd6c/.hg_archival.txt</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pypa-bandersnatch-76b72f3ebd6c/.coveragerc</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pypa-bandersnatch-76b72f3ebd6c/.hgignore</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pypa-bandersnatch-76b72f3ebd6c/.hgtags</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pypa-bandersnatch-76b72f3ebd6c/CHANGES.txt</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pypa-bandersnatch-76b72f3ebd6c/DEVELOPMENT</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pypa-bandersnatch-76b72f3ebd6c/LICENSE</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pypa-bandersnatch-76b72f3ebd6c/MANIFEST.in</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pypa-bandersnatch-76b72f3ebd6c/README</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pypa-bandersnatch-76b72f3ebd6c/buildout.cfg</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pypa-bandersnatch-76b72f3ebd6c/pytest.ini</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pypa-bandersnatch-76b72f3ebd6c/requirements.txt</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pypa-bandersnatch-76b72f3ebd6c/setup.py</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pypa-bandersnatch-76b72f3ebd6c/src/bandersnatch/__init__.py</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">\`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\`\`(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">此处省略若干字</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">)</span></span></code></pre></div><h3 id="使用pip安装" tabindex="-1">使用pip安装 <a class="header-anchor" href="#使用pip安装" aria-label="Permalink to &quot;使用pip安装&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Bandersnatch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)[root@abc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pypa-bandersnatch-76b72f3ebd6c/requirements.txt</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Downloading/unpacking</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> coverage==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3.7.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (from </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">-r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pypa-bandersnatch-76b72f3ebd6c/requirements.txt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (line </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  Downloading</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> coverage-3.7.1.tar.gz</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (284kB): 284kB downloaded</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  Running</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> setup.py</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> egg_info</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> package</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> coverage</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    warning:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> no</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> previously-included</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> files</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> matching</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;*.pyc&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> found</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> anywhere</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> distribution</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Downloading/unpacking</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pyparsing==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2.1.3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (from </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">-r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pypa-bandersnatch-76b72f3ebd6c/requirements.txt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (line </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  Downloading</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pyparsing-2.1.3.tar.gz</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (1.1MB): 1.1MB downloaded</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  Running</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> setup.py</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> egg_info</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> package</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pyparsing</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Downloading/unpacking</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> py==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.4.26</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (from </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">-r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pypa-bandersnatch-76b72f3ebd6c/requirements.txt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (line </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  Downloading</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> py-1.4.26.tar.gz</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (190kB): 190kB downloaded</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  Running</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> setup.py</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> egg_info</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> package</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> py</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">此处省略若干字</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      Installing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bandersnatch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> script</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> to</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /root/Bandersnatch/bin</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  Could</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> not</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> find</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> .egg-info</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> directory</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> in</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> record</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> for</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bandersnatch==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.11</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (from </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">-r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pypa-bandersnatch-76b72f3ebd6c/requirements.txt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (line </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">22</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Successfully</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> installed</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> coverage</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pyparsing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> py</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pyflakes</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pep8</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pytest</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cov-core</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> execnet</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> python-dateutil</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> six</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> setuptools</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mock</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> packaging</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pytest-capturelog</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pytest-codecheckers</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pytest-cov</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pytest-timeout</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pytest-cache</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> requests</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> xmlrpc2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bandersnatch</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Cleaning</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Bandersnatch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)[root@abc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span></span></code></pre></div><h2 id="配置bandersnatch并运行" tabindex="-1">配置Bandersnatch并运行 <a class="header-anchor" href="#配置bandersnatch并运行" aria-label="Permalink to &quot;配置Bandersnatch并运行&quot;">​</a></h2><h3 id="首次运行创建配置文件" tabindex="-1">首次运行创建配置文件 <a class="header-anchor" href="#首次运行创建配置文件" aria-label="Permalink to &quot;首次运行创建配置文件&quot;">​</a></h3><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>(Bandersnatch)[root@abc ~]$ bandersnatch mirror</span></span>
<span class="line"><span>2018-01-02 22:43:37,985 WARNING: Config file &#39;/etc/bandersnatch.conf&#39; missing, creating default config.</span></span>
<span class="line"><span>2018-01-02 22:43:37,985 WARNING: Please review the config file, then run &#39;bandersnatch&#39; again.</span></span>
<span class="line"><span>(Bandersnatch)[root@abc ~]$</span></span></code></pre></div><p>这一步,会创建默认的配置文件/etc/bandersnatch.conf.</p><h3 id="修改配置文件" tabindex="-1">修改配置文件 <a class="header-anchor" href="#修改配置文件" aria-label="Permalink to &quot;修改配置文件&quot;">​</a></h3><p><code>vi /etc/bandersnatch.conf</code><br> 修改directory为存放文件的目标文件夹. 其他选项通常不需要修改.</p><div class="language-ini vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ini</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">[mirror]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">; The directory where the mirror data will be stored.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">directory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> = /srv/pypi</span></span></code></pre></div><h2 id="启动同步" tabindex="-1">启动同步 <a class="header-anchor" href="#启动同步" aria-label="Permalink to &quot;启动同步&quot;">​</a></h2><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Bandersnatch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)[root@abc </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">~</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bandersnatch</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  mirror</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2018-01-02</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 22:45:44,376</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> INFO:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bandersnatch/1.11</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (CPython </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">2.7.5-final0,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Linux</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 3.10.0-693.2.2.el7.x86_64</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> x86_64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2018-01-02</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 22:45:44,376</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> INFO:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> file</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> missing.</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Starting</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> over.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2018-01-02</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 22:45:44,376</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> INFO:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Syncing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> with</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://pypi.python.org.</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2018-01-02</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 22:45:44,376</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> INFO:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Current</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> mirror</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> serial:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">2018-01-02</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 22:45:44,376</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> INFO:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Syncing</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> all</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> packages.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">此处省略若干字</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h1 id="其他说明" tabindex="-1">其他说明 <a class="header-anchor" href="#其他说明" aria-label="Permalink to &quot;其他说明&quot;">​</a></h1><p>因为使用了<code>virtualenv</code>, 将程序移植也很方便, 使用<code>tar -czvf Bandersnatch.tar.gz Bandersnatch </code>将文件夹打包,在其他主机(需要有python2)的相同目录下解包即可直接运行</p><p>如果要系统定期自动同步, 则创建<code>/etc/cron.d/bandersnatch</code>文件, 将下面内容写入</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> root bandersnatch mirror </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">|</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&amp; </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">logger</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bandersnatch[mirror]</span></span></code></pre></div><p>该定时任务会将运行日志写入到系统日志里. <code>|&amp;</code> 代表 前者的标准输出和标准错误都作为后者的标准输入</p><p>本文主要参考了 <a href="https://pypi.python.org/pypi/bandersnatch" target="_blank" rel="noreferrer">https://pypi.python.org/pypi/bandersnatch</a></p>`,34),p=[t];function k(l,e,F,r,d,g){return a(),i("div",null,p)}const E=s(h,[["render",k]]);export{c as __pageData,E as default};
